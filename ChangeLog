2001-03-04  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el: Patch from Keisuke Nishida <kxn30@po.cwru.edu>.
	(w3m-print-this-url): Do not save URL, print only.
	(w3m-save-this-url): New function. Print and save URL under cursor.
	(w3m-goto-next-anchor): New function.
	(w3m-next-anchor): Move to top anchor from bottom.
	Print URL after move.
	(w3m-goto-previous-anchor): New function.
	(w3m-previous-anchor): Move to bottom anchor from top.
	Print URL after move.

2001-03-04  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el: Patch from Keisuke Nishida <kxn30@po.cwru.edu>.
	(TOP): Require ffap.el.
	(w3m-input-url): Prompt with default URL, and use URL under cursor
	as default if not specified.
	(w3m): Do not specify default url for w3m-input-url.

2001-03-02  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (w3m-backlog-enter): Overwrite backlog data when
	specified URL is duplicated.
	(w3m-home-page): Changed official emacs-w3m page's address to
	namazu.org.

2001-03-02  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Renamed w3m-http-* to w3m-w3m-* in order to prepare name
	space of symbols processing HTTP protocol directly, and fix for
	cookie.
	(w3m-w3m-check-header): Renamed from `w3m-http-check-header'.
	(w3m-w3m-retrieve): Renamed from `w3m-http-retrieve' and added
	code to remove cookies.
	(w3m-retrieve): Follow changes of fuction name.
	(w3m-download): Likewise and changed argument spec.
	(w3m-exec): Changed argument spec.
	(w3m-goto-url): Changed reload scheme,
	(w3m-fontify): Move point to the top of the buffer before delete
	<?xml ... ?> tag.

2001-03-02  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (TOP): Changed code to detect XEmacs and add to define
	`find-coding-system'.
	(w3m-backlog-setup): Changed caching data format.
	(w3m-backlog-enter): Ditto and changed argument spec.
	(w3m-backlog-request): Ditto and changed spec of return value.
	(w3m-http-retrieve): Access backlog in this function and changed
	argument spec.
	(w3m-retrieve): Changed argument spec.
	(w3m-exec): Clean up and chaned spec of return value.
	(w3m-goto-url): Follow changes in `w3m-exec'.
	(w3m-decode-buffer): Clean up.
	(w3m-process-temp-file): New variable to suppress byte-compile warning.
	(w3m-external-view): Use w3m-process-temp-file to suppress
	byte-compile warning.
	(w3m): Change `mode-line-buffer-identification'.

2001-03-02  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-home-page): Initialize as URL.

2001-03-02  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el: Correcting wrong use of cygwin type filename usage,
	using dolist macro, adding handling codes html character entities,
	correct bug of w3m-view-bookmark on win32 environment, 
	fixing some small bugs, etc.
	(w3m-url-to-file-name): New function.
	(w3m-expand-file-name-as-url): Renamed from w3m-expand-file-name.
	(w3m-bookmark-file): Initialize as native filename format.
	(w3m-arrived-urls-file): Likewise.
	(w3m-charset-coding-system-alist): Use dolist macro.
	(w3m-entity-alist): New constant.
	(w3m-entity-db): New variable.
	(w3m-entity-db-size): New variable.
	(w3m-entity-db-setup): New function.
	(w3m-entity-value): New function
	(w3m-fontify): Refine html character entity decoding.
	Use dolist macro. Some bug fix.
	(w3m-exec-get-user): Simplify using dolist macro.
	(w3m-bookmark-save): Likewise.
	(w3m-local-content-type): Likewise.
	(w3m-local-retrieve): Fix filename handling considering cygwin
	convention by using w3m-local-file-name function.
	(w3m-http-retrieve): Buf fix.
	(w3m-rendering-region): Bug fix, use w3m-current-url.
	(w3m-view-bookmark): Use w3m to do initialize on interactive call.
	(w3m-find-file): Fix for renamed function.

2001-03-01  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* Merge changes on `url' branch to main trunk.

2001-03-01  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (w3m-home-page): Changed to official w3m.el page.
	(w3m-anchor-face): Changed default face in dark backgraound.
	(w3m-arrived-anchor-face): Ditto.
	(w3m-download): Fix typo.
	(w3m-content-type-alist): Accept .png file.
	(w3m-external-view): Fix typo.
	(w3m-view-image): Fix.

2001-03-01  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* mew-w3m.el: New file to use w3m with Mew.

2001-03-01  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* mime-w3m.el: New file to use w3m with SEMI.

	* w3m.el (w3m-message): New function.
	(w3m-verbose): New variable.
	(w3m-process-message): Ditto.
	(w3m-process-url): Removed.
	(w3m-exec-process): Add code to show progress status.
	(w3m-exec-filter): Fix prompt bug and clean up codes.
	(w3m-retrieve): Changed arguments spec.
	(w3m-local-retrieve): Ditto.
	(w3m-http-retrieve): Ditto.
	(w3m-pretty-length): New function.
	(w3m-rendering-region): Add code to show progress status.

2001-03-01  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (w3m-http-retrieve): Add adhoc fragment to avoid new-line
	replacement.
	(w3m-decode-buffer): Renamed from w3m-html-decode-buffer.

2001-02-28  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (w3m-content-type-alist): Accept .htm as text/html.
	(w3m-backlog-enter): Add code to memory w3m-current-title.
	(w3m-backlog-request): Resume w3m-current-title from backlog data.
	(w3m-html-decode-buffer): Change arguments spec.
	(w3m-rendering-region): Removed code to set w3m-current-url.
	(w3m-exec): Fix bug of proecessing text/plain files and changed
	data format to preserve in backlog.

2001-02-28  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el: Support XEmacs using APEL.
	(w3m-fontify): Delete <?XML ... ?> tag for XHTML page.
	(w3m-input-url): Do not use 7th arg of completing-read
	for XEmacs support.
	(w3m-bookmark-save): Check bookmark file is writable.

2001-02-28  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-bookmark-add): Fix problem of adding bookmark first
	time.

2001-02-28  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Reconstructed drastically and removed w3 depended codes.

2001-02-28  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-executable-type): New variable.
	(w3m-cygwin-path): New function.
	(w3m-region): New function.

2001-02-26  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (w3m-fontify): Add code to decode w3m-specific extended
	charcters.
	(w3m-extended-charcters-table): New constant.

2001-02-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-async-exec): New customizable variable.
	(w3m-exec-process): Use 'w3m-async-exec' instead of 'w3m-process-type'.

2001-02-07  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el: Fixed small and thoughtless bugs...
	(w3m-bookmark-file-modified-p): Bug fix.
	(w3m-bookmark-save): Bug fix. Don't forget time stamp updating.
	(w3m-bookmark-add): Bug fix. Function name miss-typing.

2001-02-07  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el: Add bookmark operations. This feature is very ad-hoc.
	Support loading w3m's bookmark file into internal bookmark data,
	adding new entry interactively, and saving data as w3m's bookmark
	file format. 
	(w3m-bookmark-file-coding-system): New user varible.
	(w3m-bookmark-data): New internal variable.
	(w3m-bookmark-file-time-stamp): ditto.
	(w3m-bookmark-section-history): ditto.
	(w3m-bookmark-title-history): ditto.
	(w3m-mode-map): Add bookmark operation functions to mode map.
	(w3m-bookmark-file-modified-p): New function.
	(w3m-bookmark-parse): ditto.
	(w3m-bookmark-load): ditto.
	(w3m-bookmark-save): ditto.
	(w3m-bookmark-data-prepare): ditto.
	(w3m-bookmark-add): ditto.
	(w3m-bookmark-add-this-url): ditto.
	(w3m-bookmark-add-current-url): ditto.

2000-12-12  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-sub-list, w3m-load-list, w3m-save-list): New utility
	function.
	(w3m-arrived-list-load): Refine and move out common code into
	w3m-load-list.
	(w3m-arrived-list-save): Refine and move out common code into
	w3m-save-list and w3m-sub-list. (Previous code had side effect
	of nreverse).

2000-12-10  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* makepatch.pl, Makefile, .cvsignore: New files.

2000-10-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-this-url): Chang optinal argument 'arg'.
	(w3m-next-anchor, w3m-previous-anchor): Bind 'pos'.
	(w3m-fontify): Put mouse-face at anchor and image property.
	(w3m-mouse-view-this-url): Handling 'w3m-image property.

2000-10-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-process-type): Change default valule to 'start-process.
	(w3m-process-user-counter): New buffer local variable.
	(w3m-exec-get-user): New funciton, get user and passwd from
	w3m-arrived-user-list.
	(w3m-exec-filter): Use w3m-exec-get-user().

2000-10-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-previous-point): New function.
	(w3m-expand-url): If BASE is nil, it set "".
	(w3m-download-this-url): w3m-refontify-anchor() exec when finished
	download.

2000-10-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-arrived-ct-file, w3m-arrived-file-cs,
	w3m-always-html-url-regex): New variables.
	(w3m-process-type): Change name from w3m-exec-process-type.
	(w3m-refontify-anchor): New funcition.
	(w3m-exec): Pre-check content-type.
	(w3m-exec-w3m-ctcheck): New funcition, check context-type for URL.
	(w3m-exec-w3m): New funcion, execute w3m.
	(w3m-exec-ftp): New function, execute dired-other-window() or
	copy-file(), if URL is 'ftp://'.
	(w3m-convert-ftp-to-emacsen): Change 'ftp://' to '/user@host:/' from
	elisp ML.
	(w3m-download-this-url, w3m-save-image, w3-view-image): Use w3
	features.
	
2000-10-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (top-level): Add authors.
	(w3m-expand-url): Check relative URL first.
	(w3m-fontify): Add original text properties when replace 'escaped
	character'.

2000-10-11  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-mailto-url-function, w3m-use-cygdrive,
	w3m-default-save-dir, w3m-arrived-list-file, w3m-arrived-list-keep,
	w3m-arrived-anchor-face, w3m-exec-process-type,
	w3m-process-connection-type, w3m-arrived-anchor-list):
	New user custumize variables.
	(w3m-mode): Change doc-string for key binding.
	(w3m-arrived-list-add, w3m-arrived-list-load, w3m-arrived-list-save):
	New functions for handling arrived anchor.
	(w3m-fontify): Add arrived anchor face.
	(w3m-exec-process, w3m-exec-filter, w3m-exec-sentinel): New functions
	for asynchronous w3m execution.
	(w3m-find-file, w3m-read-file-name, w3m-read-passwd):
	New miscellaneous functions.
	(w3m-expand-file-name): Support old cygwin.
	(w3m-view-current-url-with-external-browser): If w3m-browser-command
	is function, funcall it.
	(w3m-mailto-url): If w3m-mailto-url-function is function, funcall it.
	(w3m-mode-map): If running xemacs, use (button2) instead of (mouse-2).

2000-09-21  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m): Cancel last change, use switch-to-buffer again.

2000-09-20  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m): Do not switch buffer if w3m window already exists.

2000-09-20  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Add declaration of dependency on APEL.
	(w3m-quit): When other w3m buffers exist, don't destruct cache.
	(w3m-browse-url): New function.

2000-09-20  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-command-arguments): Remove option -m, that's not good
	for bookmark / local file handling.

2000-09-19  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-command-arguments): Add -m option explicitly.
	(w3m-exec): Ad-hoc change to view .txt object. It's temporary
	fix. Should we consider type? w3m option -dump_head may help us.
	(w3m-exec): Get title and remove both format <title_alt> and
	<title>.
	(w3m-view-this-url): Force reloading by prefix.
	(w3m-view-current-url-with-external-browser): Works correctly.
	(w3m-print-current-url): Push url to kill king to paste later.
	(w3m-print-this-url): ditto.
	(w3m-mailto-url): Use rfc2368.el instead of mailto.el.
	(w3m-goto-url): Add 2nd argument RELOAD to withdraw data cached on
	emacs.
	(w3m-reload-this-page): Simplified by using new w3m-goto-url.
	(w3m): Set mode-line-buffer-identification after changing major
	mode because it overwrite that variable.

2000-09-19  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (w3m-fontify): Add code to handle irregular ordered
	elements of anchor tags.
	(w3m-mailto-url): Adopt for Emacs-19.
	(w3m-input-url): Call `w3m-backlog-setup' to initialize
	`w3m-backlog-hashtb'.

2000-09-19  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m): Sorry, over paren.

2000-09-18  Shun-ichi GOTO  <gotoh@taiyo.co.jp>
	
	* w3m.el (w3m-exec): Get title correctly within -halfdump format
	of w3m.
	(w3m-mouse-view-this-url): New function to view page by clicking
	mouse middle button.
	(w3m-mode-map): Assign mouse middle button to view page.
	(w3m): Change mode-line spec to show title of current page.

2000-09-18  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Add authors.

2000-09-18  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-input-url): Enter url with completion. Candidates
	are visited url kept in w3m-backlog-hashtb.
	(w3m-backlog-setup): Change hash size as prime number and
	initialized with value 0 for obarray.
	(w3m-backlog-remove): Remove unused 2nd arg NUMBER and remove when
	block to check NUMBER.
	(w3m-exec): Show message "Loading..." while loading.
	(w3m-save-position): New function to keep display position in
	Emacs window into hash symbol, but I think this is not best way.
	(w3m-restore-position): New function to restore display position.
	(w3m-view-previous-page): Restore display position.
	(w3m-expand-url): Canonicalize url, ex. "http://www.host.org" to
	"http://www.host.org/".  Change regexp to allow "mailto:"
	protocol.  Remove drive letter as side-effect using
	expand-file-name to expand url for Win32 emacen.
	(w3m-expand-file-name): New function to alternates
	expand-file-name function with convert drive letter prefixed path
	to cygwin path.  i.e. c:/users/home to /cygdrive/c/users/home
	(w3m-view-bookmark): Expand bookmark filename as cygwin path
	format to pass to w3m.
	(w3m-mode-map): Add new key binding 'B' to back to previous page.
	Add new key binding 'R' to force reloading current page.
	(w3m-mailto-url): New function to support mailto: protocol.  It
	use rfc2368.el if available.
	(w3m-goto-url): Ad-hoc support mailto: protocol. We should
	consider more...
	(w3m-reload-this-page): New function to reload current page.

2000-09-18  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m): Add 2nd arguemnt to use with browse url.  This is
	patch from Satoru Takabayashi <satoru-t@is.aist-nara.ac.jp> in
	ELF-ML, Seq# 875.
	(w3m-fontify): Change regexp for <a ...> tag to allow newline in
	between attributes.  This is patch from Satoru Takabayashi
	<satoru-t@is.aist-nara.ac.jp> in ELF-ML, Seq# 876.
	(w3m-fontify): Allow un-ended tag for name attribute, is it w3m
	bug?).  This is Patch from Satoru Takabayashi
	<satoru-t@is.aist-nara.ac.jp> in ELF-ML, Seq# 876.

2000-07-13  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Added handling of name anchors. Add comments.

2000-07-12  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Improved to handle multi buffer. Fix broken cache and
	order of fontify.

2000-07-01  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: Handle &-sequence. Add history and cache.

2000-06-25  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el: New file.
