2019-02-26  Boruch Baum  <boruch_baum@gmx.com>

	* w3mhack.el (w3mhack-insert-git-revision): bugfix: Only define the
	constant emacs-w3m-git-revision when a git revision is found.

2019-02-25  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-favicon.el (w3m-favicon-convert): bugfix: check string bounds
	before use (Andres Ramirez <rrandresf@gmail.com> [emacs-w3m:13266])

2019-02-25  Boruch Baum  <boruch_baum@gmx.com>, TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* octet.el: Documentation update

2019-02-25  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-decode-entities-string): Simplify function.

2019-02-25  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-form.el (w3m-form-make-form-data, w3m-form-resume)
	(w3m-form-parse-and-fontify), w3m-hist.el
	(w3m-history-slimmed-history-flat), w3m-mail.el
	(w3m-mail-compose-with-semi), w3m-proc.el (w3m-process-new),
	w3m-session.el (w3m-session-save), w3m-util.el
	(w3m-make-menu-commands), w3m.el (w3m-toggle-inline-image): Simplify
	forms '(setq x (cons (cons ...  ) x))'

2019-02-25  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-encode-specials-string): Simplify, remove need for
	nreverse, remove need for constant w3m-entity-reverse-table.

2019-02-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-db-history): Remove GUI stuff; prompt a user for `start'
	and `size' only when it is called interactively.

2019-02-21  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-insert-git-revision): Check the existence of
	'.git' instead of '.git/config'.  This change is proposed by
	<clemens@endorphin.org>.

2019-02-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_EMACS_LISP): Use a file to pass ELisp program to Emacs.

2019-02-19  Boruch Baum  <boruch_baum@gmx.com>

	* .travis.yaml: Add support for multiple emacs versions and
	multiple operating systems.

	* READMME.md: Add the file as a stub, with example "badge"
	picture for travis building and GPL licensing.

2019-02-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	Add some tweaks to Boruch Baum's changes

	* w3m.el (w3m-db-history-fix-indentation): New function.
	(w3m-create-text-page): Use it to fix indentation in db history.
	(w3m-about-db-history): Don't fold Time/Date string.
	(w3m-db-history): Raise GUI dialog box if called from GUI.

2019-02-19  Boruch Baum  <boruch_baum@gmx.com>

	Improve history display

	Fix the handling of the START and SIZE args for the global history
	display, applies cosmetic changes to that display, and adds an option
	for all forms of history display to be done in a new buffer.

	* w3m.el (w3m-history-in-new-buffer): New option.
	(w3m-db-history): Apply the new option.  Add details to docstring.
	Allow interactive user to set function options START and SIZE.
	(w3m-history): Apply the new option.  Improve docstring.
	(w3m-about-history): Add programmer's note.  Modify Docstring.
	(w3m-about-db-history): Add programmer's note.  Modify Docstring.
	Properly handle START and SIZE arguments.
	Modify html output for: clarity, date display format, use of ellipsis,
	maximum use of page width, center heading, align page navigation links
	to page edges, remove extraneous ';' after url's, add ellipsis when
	truncating url's.

2019-02-14  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-resize-image-interactive): Refactor function to remove
	code duplications.

2019-02-12  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-dtree.el (w3m-dtree-create-sub): BUGFIX: don't abort if a subdir
	denies permission to read.

2019-02-03  Boruch Baum  <boruch_baum@gmx.com>

	* Refactor entire codebase for utf-8. There were a zillion changes in
	this commit, spread over very many files. See the git commit extended
	message for details.

2019-02-03  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-cookie.el (w3m-cookie-shutdown): avoid duplicate get-buffer call.

	* w3m-form.el (w3m-form-textarea-file-cleanup)
	(w3m-form-textarea-files-remove): use pop instead of (cdr
	(car x))

	* w3m-session.el (w3m-session-select-sessions): Add docstring

	* w3m.el (w3m-cleanup-temp-files): Add cache and tmp files to list.

2019-02-03  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-xkcd, w3m-filter-github-repo-main-page):
	New filters.
	(w3m-filter-configuration): Add the new filters.

2019-01-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug-system-informations):
	Add emacs-w3m-git-revision.

2019-01-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (emacs-w3m-git-revision): Moved to w3m-load.el.

	* w3mhack.el (w3mhack-insert-git-revision): New function to set the
	value of `emacs-w3m-git-revision'.
	(w3mhack-generate-load-file): Call the above and check the timestamp of
	w3mhack.el to decide necessity of updating w3m-load.el.

2018-12-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (emacs-w3m-git-revision): New constant.
	(emacs-w3m-version): Separated from revision string.

2018-10-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-encoded-contents): Use the conventional way if
	zlib-decompress-region returns nil ([emacs-w3m:13038]).

2018-06-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-user-agent-default-alist): Fix default value;
	move "Don't send..." item to `w3m-user-agent-change'.
	(w3m-user-agent-change): Don't sort collection.

2018-06-08  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-content-type-alist): Remove extraneous fields from two
	elements (bzip2, gzip) in the alist ([emacs-w3m:13081]).

2018-06-08  Boruch Baum  <boruch_baum@gmx.com>

	Refactor w3m-process-queue memory and redability ([emacs-w3m:13013]).

	* w3m.el (w3m--dump-extra--handler-function)
	(w3m--retrieve--handler-function, w3m--retrieve-1--handler-function)
	(defun w3m--retrieve-and-render--handler-function)
	(w3m--goto-url--handler-function, w3m--goto-url--valid-url):
	New functions to reduce memory footprint of `w3m-process-queue',
	aid readability debugging.

	* w3m.el (w3m-w3m-dump-extra, w3m-w3m-retrieve, w3m-w3m-retrieve-1)
	(w3m-retrieve-and-render, w3m-goto-url):
	Use the new functions listed above.

2018-06-07  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-stackexchange): Rewrite ([emacs-w3m:13010]).

2018-06-01  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-stackexchange, w3m-filter-youtube):
	New filters ([emacs-w3m:12999]).
	(w3m-filter-configuration): Add those filters.

2018-05-30  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-generic-page-header):
	New filter ([emacs-w3m:12996]).
	(w3m-filter-configuration): Add it but not activated by default.

2018-05-23  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-delete-buffer): Perform some operations from a temporary
	buffer in order not to lose information such as `w3m-current-url'
	([emacs-w3m:12989]).

2018-05-23  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-select-buffer): Pass correct current buffer value to
	`w3m-select-buffer-generate-contents' ([emacs-w3m:12988]).
	(w3m-select-buffer-generate-contents): Variable rename.

2018-05-19  Kevin Ryde  <user42_kevin@yahoo.com.au>

	* w3m-favicon.el (w3m-favicon-setup): Enable favicons be taken from
	file://, too ([emacs-w3m:12983]).

2018-05-18  Boruch Baum  <boruch_baum@gmx.com>

	Make progress messages more uniform and more useful
	([emacs-w3m:12980] [emacs-w3m:12986]).

	* w3m.el (w3m-display-progress-message): Combine code from
	`w3m-retrieve-and-render', separate url from "...", and add
	user-friendly advice message.
	(w3m-retrieve-and-render): Replace snippet with call to
	`w3m-display-progress-message'.

	* w3m-proc.el (w3m-process-stop): Document in the buffer when an
	operation has been aborted by the user, what that operation was, and
	remove progress message.

2018-05-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-stop): Don't move point ([emacs-w3m:12976]).

2018-05-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	Work for mailto urls.

	* w3m.el (w3m-url-readable-string): Make w3m-url-decode-string detect
	coding system for mailto url instead of using w3m-url-coding-system.
	(w3m-fontify-anchors, w3m-goto-url): Don't encode mailto url.
	(w3m-goto-mailto-url): Remove CR from, but preserve LF in mailto url;
	don't decode mailto url containing non-ASCII letters.

2018-05-09  Boruch Baum  <boruch_baum@gmx.com>

	Update faces for all navigation cases ([emacs-w3m:12969]).

	* w3m-session.el (w3m--session-update-faces): New function for
	`pre-command-hook' and `post-command-hook' in w3m-session buffers.
	(w3m-session-select-mode): Apply it.
	(w3m-session-select-list-all-sessions, w3m-session-select-next):
	Don't set the "selected" face, because it is now done by the new hook
	function.

2018-05-09  Boruch Baum  <boruch_baum@gmx.com>

	Fix two bugs in navigating the w3m-session-select popup window
	([emacs-w3m:12968]).

	* w3m-session.el (w3m-session-select-list-all-sessions): Fix navigation
	errors that happen when using functions beginning-of-buffer,
	end-of-buffer.
	(w3m-session-select-next): Fix navigation so previous line of first
	rotates back to last line. Remove unnecessary loop.

2018-05-09  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-mode): Don't visually indicate non-breaking spaces
	([emacs-w3m:12967]).

2018-05-09  Boruch Baum  <boruch_baum@gmx.com>

	Bugfix for the creation of session pop-up window ([emacs-w3m:12966]).

	* w3m.el (w3m--setup-popup-window): New function.
	(w3m-select-buffer): Use it.
	(w3m-select-buffer-horizontal-window): Update documentation.

	* w3m-session.el (w3m-session-select): Use the new function, thus
	fixing a display bug, and making popup windows consistent.

2018-05-09  Boruch Baum  <boruch_baum@gmx.com>

	Uniform error handling and message presentation ([emacs-w3m:12964]).

	* w3m.el (w3m--buffer-busy-error): New function for uniform error
	handling and message presentation.
	(w3m-goto-url): Use it.

	* w3m-search.el (w3m-search-read-variables): Use it.

2018-05-09  Boruch Baum  <boruch_baum@gmx.com>

	Introduce w3m-display-mode ([emacs-w3m:12963]).

	* w3m.el (w3m-display-mode): New user option.
	(w3m-display-mode): New function.
	(w3m-use-tab, w3m-use-tab-menubar, w3m-pop-up-windows)
	(w3m-pop-up-frames, w3m-copy-buffer, w3m-delete-buffer, w3m-doc-view)
	(w3m, w3m-browse-url, w3m-select-buffer, w3m-use-header-line-title)
	(w3m-safe-view-this-url): Doc fix.

	* w3m-fb.el (Commentary): Doc fix.
	(w3m-fb-mode): Fix warning message.

	* w3m-util.el (w3m-popup-buffer): Doc fix.
	(w3m-add-w3m-initial-frames): Comment fix.
	(w3m-device-on-window-system-p): Typo fix.

2018-05-08  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-session.el (w3m-session-select-list-all-sessions): Don't display
	urls in the session select window ([emacs-w3m:12960]).

2018-05-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-image.el (w3m-favicon-usable-p): Relax the criterion.

	* aclocal.m4 (AC_PATH_EMACS): Work for Emacs >= 26 in which
	the emacs-version variable no longer includes the build number.

	* w3m-favicon.el (w3m-favicon-retrieve): Gunzip data if necessary.

2018-04-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-cache-available-p, w3m-w3m-retrieve-1): Revert.
	See [emacs-w3m:12951].

2018-04-03  Boruch Baum  <boruch_baum@gmx.com>

	Send a cached ETag to the remote server so as to check whether
	the server responds with 304 meaning the cache is still up-to-date.
	[emacs-w3m:12947]

	* w3m.el (w3m-cache-available-p): Fetch Etag.
	(w3m-w3m-retrieve-1): Send it to the server.

2018-03-05  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-perldoc.el (w3m-about-perldoc): Expand "~" before setting
	`default-directory' to avoid an error calling a process.

2018-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	[emacs-w3m:12929]
	* w3m.el (w3m-previous-session-buffer):
	New variable, a successor to w3m-parent-session-buffer.
	(w3m-next-buffer): Set it.
	(w3m-delete-buffer): Return to it after deletion.

	* w3m-util.el (w3m-generate-new-buffer): Set it.

	* w3m-ems.el (w3m-tab-drag-mouse-function)
	(w3m-tab-click-mouse-function): Set it.

2018-02-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	[emacs-w3m:12928]
	* w3m.el (w3m-parent-session-buffer): Remove it (temporarily).

	* w3m-util.el (w3m-generate-new-buffer): Run w3m-mode here.

2018-02-26  Vladimir Sedach  <vas@oneofus.la>

	[emacs-w3m:12892]
	* w3m.el (w3m-view-this-url-1): Fix LAST parameter to w3m-copy-buffer
	to make new buffer go after the current buffer, as intended in revision
	1.1691 on 2017-10-13.

	* w3m-util.el (w3m-generate-new-buffer): Fix bug introduced in revision
	1.3628 on 2017-10-13 where new buffers were always assigned number 1.

2018-02-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-toolbar-define-keys): Don't show button names in
	tool-bar in order to prevent the rightmost buttons from being pushed
	out.  Instead, hover the mouse on a button and see the help-echo.

2018-02-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-generate-new-buffer): Work for w3m-fb-mode correctly
	([emacs-w3m:12904]).

2018-02-20  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-relationship-estimate-rules): Remove rule for
	discontinued freshmeat.net website.  Improve docstring
	([emacs-w3m:12924]).

2018-02-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	Delete about://cookie/ buffer when w3m-view-previous-page is performed.
	Suggested by Dan Jacobson.

	* w3m-cookie.el (w3m-cookie): Clear history.

	* w3m.el (w3m-view-previous-page): Delete about://cookie/ buffer
	if there is no other w3m-mode buffer.

2018-02-18  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-session.el (w3m-session-select-quit): Remove cruft:
	w3m-session-select-wincfg is used, but never set.  This caused a bad
	(nil) window configuration to be used when exiting a session-select
	window in w3m-fb mode ([emacs-w3m:12918]).

2018-02-18  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-session.el (w3m-session-rename): BUGFIX: had been failing to find
	buffers with identical names to rename candidate ([emacs-w3m:12917]).

2018-02-18  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-quit): Maintain frame isolation when in fb-mode.
	Update docstring.
	(w3m-close-window): Update doscstring.

	* w3m-fb.el (w3m-fb-delete-frame-buffers): Kill all buffers directly
	instead of incrementally moving to next one.  This also is part of the
	fix so that frame isolation is maintained in fb-mode after quitting.
	[emacs-w3m:12916].

2018-02-18  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-search.el (w3m-search-default-engine): Restrict options to valid
	current choices and present them as radio buttons ([emacs-w3m:12915]).

2018-02-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-session.el: Tidy up source code so as to be within 80-column.

2018-02-16  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-session.el: Reformat docstrings for proper opening summary
	sentence ([emacs-w3m:12912]).

2018-02-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-fb.el (w3m-fb-mode, w3m-fb-delete-frame-kill-buffers):
	Use delete-frame-functions.
	(w3m-fb-delete-frame-functions): Remove.

	* w3m-util.el (w3m-delete-frames-and-windows): Bind
	delete-frame-functions so as not to run w3m-fb-delete-frame-buffers.
	(w3m-delete-w3m-initial-frames): Remove obsolete delete-frame-hook.

2018-02-15  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-session.el: Add commentary, correct grammar of prompts..
	(w3m-session-group-open): New variable
	(w3m-session-select-quit): Quitting a session-group display returns to
	its parent session list display.
	(w3m-session-select-open-session-group, w3m-session-select-rename)
	(w3m-session-select-delete): Stay on proper line when within
	session-group display, after renaming or deleting an entry.
	This required adding an optional arg to the function.
	(w3m-session-rename): Allow renaming individual tabs of a session.
	(w3m-session-delete): Allow deleting individual tabs of a session.
	[emacs-w3m:12907]

2018-02-14  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-external-view): Fix regex for url's that contain uri
	'query' and or 'fragment' components ([emacs-w3m:12901]).

2018-02-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-string-match-url-components)
	(w3m-string-match-url-components-1, w3m-url-strip-fragment):
	Don't recognize a url fragment "#/foo" as a name attribution.

2018-02-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-gnome-bugzilla):
	Limit to <pre class="bz_comment_text">.  Thanks to Kevin Ryde
	([emacs-w3m:12890]).

2018-01-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-gnome-bugzilla): New ([emacs-w3m:12885]).

2018-01-19  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-user-agent-site-specific): Remove debug message.
	[emacs-w3m:12883]

2018-01-18  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-add-referer): Update for https support.
	(w3m-user-agent-site-specific-alist, w3m-user-agent-site-specific):
	New feature.
	(w3m-header-arguments, w3m-request-arguments): Integrate new feature.
	[emacs-w3m:12881]

2018-01-17  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-user-agent-change): New feature.
	(w3m-reload-this-page): Integrate new feature.
	(w3m-request-arguments, w3m-header-arguments): Ensure w3m and
	w3mmee honor `w3m-add-user-agent'.  [emacs-w3m:12876]

2018-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make `cd doc; make pdf' work again  [emacs-w3m:12875]

	This requires Texinfo the version >=6.3, and either (or both) of LuaTeX
	>=0.95 (i.e., TeXLive >=2016) or XeTeX >=0.9998 (i.e., TeXLive >=2012).

	* Makefile.in (clean): Use doc/Makefile's clean.

	* aclocal.m4 (AC_CHECK_TEXINFO): New function.

	* configure.in (MAKEINFO, TEXI2PDF): Check version.
	(TEXI2DVI, PTEX, PBIBTEX, DVIPDFMX, TEXI2PDF): Remove.

	* doc/Makefile.in (TEXI2DVI, PTEX, PBIBTEX, DVIPDFMX, TEXI2PDF): Remove.
	(PDFTEX): New internal variable.
	(dvi, dvi-en, dvi-ja, emacs-w3m.dvi, emacs-w3m-ja.dvi, .texi.dvi):
	Remove targets.
	(.texi.pdf): Use texi2pdf instead of dvipdfmx.
	(clean): Renew.

	* doc/emacs-w3m-ja.texi (texinfo-ja.tex): Use it instead of texinfo.tex.
	(@documentencoding): New.
	(@usedvipdfmx): Remove.

	* doc/texinfo-ja.tex: New file.
	* doc/texinfo.tex, doc/txi-en.tex, doc/txi-ja.tex: Renew.

2017-12-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	Update selection buffer properly after deletion or renaming.
	Suggested by Boruch Baum ([emacs-w3m:12847]).

	* w3m-session.el (w3m-session-save): Update selection buffer.
	(w3m-session-select-rename, w3m-session-select-delete):
	Make the selected session highlighted after renaming or deletion.
	(w3m-session-select): Allow specifying the session number;
	close selection window when no session remains after deletion.
	(w3m-session-save, w3m-session-rename): Emulate INITIAL-INPUT.

2017-12-12  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-lynx-like-map): Remap "s" to `w3m-search', "S" to
	`w3m-search-new-session'. [emacs-w3m:12838]
	(w3m-ctl-c-map): Remap "C-c M-h" to `w3m-history' [emacs-w3m:12842]

2017-12-08  Boruch Baum  <boruch_baum@gmx.com>

	[emacs-w3m:12840]
	* w3m.el (w3m-edit-url, w3m-edit-current-url, w3m-edit-this-url):
	Enable editing non-local files. In such cases, the user is prompted to
	save the emacs-w3m buffer locally, prior to beginning the editing
	session. Edit docstring.
	(w3m-goto-url, w3m-goto-url-new-session): Clarify in docstring
	and in input prompt whether the action is to happen in the current or
	in a new buffer.
	* w3m-save.el (w3m-save-buffer): function returns the saved file name.
	* w3m-bookmark.el (w3m-bookmark-view-new-session): Add to docstring
	whether the bookmark list will be presented in the current or in a new
	buffer.
	* w3m-search.el (w3m-search-read-variables): Add to docstring
	information on new arg, rename arg to `where', change terminology from
	`session' to `buffer'.
	(w3m-search, w3m-search-new-session): Add to docstring whether results
	will be repesented in the current or in a new buffer.

2017-12-07  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-search.el (w3m-search, w3m-search-new-session)
	(w3m-search-read-variables): Provide visual feedback for whether search
	will be in new or current session ([emacs-w3m:12837]).

2017-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Require seq.

	* w3m-session.el (w3m-session-save, w3m-session-crash-recovery-save)
	(w3m-session-crash-recovery-remove, w3m-session-rename)
	(w3m-session-delete): Use delq rather than delete.

2017-12-07  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-session.el (w3m-session-select-delete)
	(w3m-session-select-rename): Retain cursor position after completion;
	simplify code ([emacs-w3m:12832]).

2017-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-add-name-anchors): Relax regexp
	([emacs-w3m:12824]).  Thanks to Musha-san and Shirai-san.

2017-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-detect-meta-charset): Ignore comment ([emacs-w3m:12828]).
	Thanks to Renato Ferreira.

2017-11-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-add-name-anchors):
	Work for id="name" where name begins with "." ([emacs-w3m:12812]).

2017-10-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-copy-buffer): Make the copied buffer the next of the
	current buffer by default (like Firefox does); use the new argument
	LAST to make it the last in order of buffers.
	(w3m-view-this-url-1, w3m-goto-url, w3m-goto-url-new-session): Set LAST.

	* w3m-util.el (w3m-generate-new-buffer): Make the new buffer the next
	of the current buffer if the new argument NEXT is set.

	* w3m-util.el (w3m-about-cookie): Use input instead of textarea.

2017-10-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make `w3m-retrieve' do onload redirection.

	* w3m.el (w3m-retrieve-and-render): Move onload redirection stuff to
	(w3m-w3m-onload-redirection): New function.
	(w3m-w3m-retrieve-1): Use it.
	(w3m-decode-encoded-contents): Use zlib-decompress-region for gzip.

2017-09-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-cookie.el (w3m-about-cookie): Work for old Emacsen.
	* aclocal.m4 (AC_PATH_EMACS): Work for Emacs 27 and greater.

2017-09-25  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-confirm-leaving-secure-page):
	Move forward ([emacs-w3m:12807]).

2017-09-25  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-goto-url-new-session): Fix the problem ([emacs-w3m:12584])
	that a w3m buffer is mis-named "*server*-nnnnnn";
	Use (if (not CONDITION) FOO BAR) instead of (if CONDITION BAR FOO) style
	in order to improve the visibility of the code.

2017-09-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Workaround: don't do redirection if
	the onload function name doesn't end with ".submit" ([emacs-w3m:12795]).

	* w3m.el (w3m-content-type-alist): Run mailcap-parse-mailcaps and
	mailcap-parse-mimetypes before setting it.
	(w3m-create-page): Run w3m-external-view in tty for images, etc.
	(w3m-external-view-file): Make deleting of temp file delayed.
	[emacs-w3m:12793]

2017-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-verbose, w3m-message-silent, w3m-message): Doc fix.

	* w3m-cookie.el (w3m-about-cookie):
	Add GUIs that support limiting and deleting ([emacs-w3m:12790]).
	* w3m-form.el (w3m-form-make-form-data):
	Don't encode SPC in a search word used for w3m-cookie.

2017-08-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Parse a form in its page buffer.

2017-08-11  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-italic):
	* w3m-lnum.el (w3m-lnum-minibuffer-prompt, w3m-lnum-match):
	* w3m-session.el (w3m-session-select, w3m-session-selected):
	Update "face spec" DISPLAY form "type" to be `nil' for character-only
	terminals.  [emacs-w3m:12788]

2017-08-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Do onload redirection.
	[emacs-w3m:12787]

2017-08-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-arrived-shutdown):
	* w3m-cookie.el (w3m-cookie-shutdown): Don't error out.

2017-08-08  Akinori MUSHA  <knu@iDaemons.org>

	* w3m.el: Don't add autoload functions to hooks (see below).
	[emacs-w3m:12784]

	* w3m-cookie.el: Add w3m-cookie-shutdown to kill-emacs-hook here.

	* w3m-sesseion.el: Add w3m-session-crash-recovery-remove and
	w3m-session-automatic-save to w3m-arrived-shutdown-functions here.

2017-08-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-scroll-up, w3m-scroll-down): Make argument default to 1
	if and only if called interactively so that w3m-scroll-up-or-next-url
	and w3m-scroll-down-or-previous-url work as before.  [emacs-w3m:12783]

2017-08-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-cookie.el (w3m-cookie-1-acceptable-p):
	Use url-domsuf-cookie-allowed-p if available to check if a domain is
	unique to allow having cookies set.  [emacs-w3m:12782]

2017-08-03  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-scroll-up, w3m-scroll-down): Remove restriction of using
	prefix-argument, remove code that fixes bug in emacs v21.
	(w3m-mwheel-scroll-up, w3m-mwheel-scroll-down): Delete.
	(w3m-mode): Change local bindings of `mwheel-scroll-up-function' and
	`mwheel-scroll-down-function' to `w3m-scroll-up' and `w3m-scroll-down'.
	[emacs-w3m:12779]

2017-08-02  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-search.el (w3m-search-engine-alist): Update URL for debian
	package search, and change its default parameters from i386
	architecture to amd64.  [emacs-w3m:12776]

2017-07-28  defanor  <defanor@uberspace.net>

	"google feeling lucky" to "feeling searchy" ([emacs-w3m:12774])

	* w3m.el (w3m-enable-feeling-searchy):
	Rename from w3m-enable-google-feeling-lucky.
	(w3m-canonicalize-url):
	Doc fix; use w3m-search-do-search to generate url.
	(w3m-canonicalize-url, w3m-input-url, w3m-view-this-url, w3m-goto-url)
	(w3m-goto-url-new-session, w3m): feeling-lucky to feeling-searchy.

2017-07-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	Fix cookies handling ([emacs-w3m:12768], [emacs-w3m:12772])

	Regard a Set-Cookie header as it contains a single cookie, that is,
	the one at the beginning of the field is it and succeeding semi-colon
	separated ones are the attributions of it.  Formerly the Lisp code
	regarded the semi-colon separated ones as all individual cookies, and
	therefore the locally stored cookies would potentially be all bogus.
	So, we highly recommend resetting it once when you start using or if
	you are already using this version of w3m-cookie.el.  To do that,
	shutdown Emacs and delete the "~/.w3m/.cookie" file (or the ".cookie"
	file existing in the `w3m-profile-directory').

	* w3m-cookie.el (w3m-cookie-parse-args): Reverse the order of the value.
	(w3m-cookie-1-set): Regard a Set-Cookie header as it contains a single
	cookie; prefer Max-Age than Expires and convert it to Expires.
	(w3m-cookie-get): Use "NAME", not "NAME=", if the value of NAME is null.

2017-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-content-type-alist): Exclude zero-length extension.
	(w3m-canonicalize-url): Test preferentially if URL is a local file.

2017-07-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-url-invalid-regexp): Remove.
	(w3m-url-valid): Use w3m-url-invalid-base instead.  [emacs-w3m:12767]

2017-07-20  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el, w3m-util.el (w3m-url-fallback-base):
	Rename `w3m-url-fallback-base' to more descriptive
	`w3m-url-invalid-base' ([emacs-w3m:12763]).

2017-07-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-subst-disabled-with-readonly):
	Work for two or more disabled tags.

2017-07-16  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-canonicalize-url): Make scheme default to https, not http.
	[emacs-w3m:12749]

2017-07-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-delete-frames-and-windows): Replace `one-window-p'
	with a custom function that works for unselected windows as well.

2017-07-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-delete-frames-and-windows): Work for Emacs on tty;
	always delete w3m windows if possible ([emacs-w3m:12733]).
	* w3m.el (w3m-select-buffer-delete-buffer):
	No need to wind up selection buffer when quitting.

2017-07-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-form-hint): Clarify echo message.
	* w3m-form.el (w3m-form-expand-form, w3m-form-unexpand-form):
	Work for mouse-clicking ([emacs-w3m:12731]).

2017-07-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-form-hint): Expand form so at to show text fully.
	* w3m-form.el (w3m-form-input): Revert 2017-06-30 change.
	(w3m-form-expand-form, w3m-form-unexpand-form): New functions.
	[emacs-w3m:12728]

2017-07-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-input-textarea-mode-hook): Fix mismatched paren;
	use outline-show-all instead of show-all if available.

2017-07-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-content-type-alist): Use mailcap.
	(w3m-image-viewer): Abolish.
	(w3m-create-page): Allow user to download file of unknown content-type.

2017-06-30  Vladimir Sedach  <vas@oneofus.la>

	* w3m-form.el (w3m-form-input): If input is readonly, put the input
	value on the kill ring in addition to displaying it in the echo area.
	[emacs-w3m:12724]

2017-06-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el, w3m-antenna.el, w3m-bookmark.el, w3m-cookie.el,
	w3m-dtree.el, w3m-ems.el, w3m-favicon.el, w3m-filter.el, w3m-form.el,
	w3m-namazu.el, w3m-perldoc.el, w3m-search.el, w3m-session.el,
	w3m-symbol.el, w3m.el:
	Remove `:size 0' from defcustoms ([emacs-w3m:12709]).

2017-06-26  Vladimir Sedach  <vas@oneofus.la>

	* w3m.el (w3m-url-completion-map): Bind "?" to self-insert-command.
	[emacs-w3m:12721]

2017-06-22  Vladimir Sedach  <vas@oneofus.la>

	* w3m.el (w3m-external-view-temp-directory): New user option.
	(w3m-external-view): Use it control which directory files are saved to
	before being opened with the external viewer.  [emacs-w3m:12708]

2017-06-20  Vladimir Sedach  <vas@oneofus.la>

	* w3m.el (w3m-goto-url-new-session): Handle POST data.
	[emacs-w3m:12704]

2017-06-14  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-cookie.el (w3m-cookie-url, w3m-cookie-domain, w3m-cookie-secure)
	(w3m-cookie-name, w3m-cookie-value, w3m-cookie-path)
	(w3m-cookie-version, w3m-cookie-expires, w3m-cookie-ignore): Add docs.
	(w3m-cookie): Test w3m-use-cookies here insted.
	(w3m-about-cookie): Don't test it.  [emacs-w3m:12699]

2017-06-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Simplify the tweaking of `message'.

2017-06-12  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-cookie.el (w3m-cookie-clear): Make it a user command.
	(w3m-cookie): Open it as a new session ([emacs-w3m:12685]).

	* w3m.el (w3m-select-buffer-delete-buffer): Don't move point forward
	([emacs-w3m:12684]); clarify doc string.

	* w3m-filter.el (w3m-filter-rt): Bind ephemeral var ([emacs-w3m:12682]).

2017-06-12  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-rt, w3m-filter-slashdot):
	Update ([emacs-w3m:12678]).

2017-06-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-compile-file): Silence compile warnings when
	compiling w3m-filter.el ([emacs-w3m:12676]).

2017-06-11  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-delete-regions, w3m-filter-replace-regexp):
	Make a return value always mean deletion or replacement is made
	([emacs-w3m:12674]).

2017-06-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-delete-regions, w3m-filter-replace-regexp):
	Refactor to Lisp macros.
	(w3m-filter-geocities-remove-garbage, w3m-filter-infoseek-remove-ads)
	(w3m-filter-ascii24-remove-ads): New filters that replace the ones
	having existed in w3m-filter-configuration ([emacs-w3m:12669]).

2017-05-30  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-filter-delete-regions, w3m-filter-replace-regexp):
	Allow optional args used to modify search/replace boundaries.
	(w3m-filter-rt, w3m-filter-slashdot): New filters.
	(w3m-filter-configuration): Add new filters ([emacs-w3m:12666]).

	* w3m.el (w3m-uri-replace-alist): Remove Google groups, Altavista, and
	iij-archie ([emacs-w3m:12661]).

	* w3m-search.el (w3m-search-engine-alist): Remove Google groups that
	requires javascript and alltheweb that is forwarded to Yahoo!; use
	https on all urls ([emacs-w3m:12657]).

2017-05-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-toggle-filtering): Use completing-read.

2017-05-28  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-filter.el (w3m-toggle-filtering): New user command.

	* w3m.el (w3m-lynx-like-map, w3m-info-like-map): Bind "f" to it.

	* w3m-lnum.el (w3m-lnum-mode-map): Don't bind f, F, and w keys;
	use `L'-prefixed version defined in `w3m-lnum-map' instead.

2017-05-26  Aubrey Raech  <aubrey@raech.net>

	* w3m-search.el (w3m-search-engine-alist):
	Replace freshmeat with duckduckgo.

2017-05-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-decode-string): Fix previous commit, that breaks url
	of being not encoded.

2017-05-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	Don't use string-(as|make|to)-(multi|uni)byte ([emacs-w3m:12630]).

	* w3m.el (w3m-url-decode-string): Use a unibyte buffer to represent
	encoded byte stream.

	* w3m-util.el (w3m-decode-coding-string-with-priority): Simplify.

2017-05-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el: Bind w3m-clear-display-while-reading, w3m-current-title.

2017-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	Allow local file of which the name is not absolute ([emacs-w3m:12643])

	* w3m.el (w3m-canonicalize-url): Allow local file of relative name.
	* w3m-util.el (w3m-popup-buffer): Preserve the current directory.

2017-03-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-stop): Blank page if
	w3m-clear-display-while-reading is non-nil ([emacs-w3m:12633]).
	(w3m-process-kill-stray-processes): Separate it from
	w3m-process-start-queued-processes.

2017-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	Revert last change in w3m-decode-coding-string-with-priority.

	* w3m-util.el (w3m-decode-coding-string-with-priority): Revert.
	[emacs-w3m:12630]

2017-02-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	Don't use string-make-(multi|uni)byte that got obsolete in Emacs 26.

	* octet.el (w3m-about-octet-attachments, octet-w3m-region):
	Use (decode|encode)-coding-string.
	* w3m-image.el (w3m-imagick-convert-buffer): Bind LC_ALL with C.
	* w3m-proc.el (w3m-process-start-after):
	Bind LC_ALL with C in w3m-command-environment.
	* w3m-util.el (w3m-decode-coding-string-with-priority): Don't use it.
	(w3m-insert-string): Encode a string by utf-8-emacs when inserting it
	into a unibyte buffer.
	* w3m.el (w3m-command-environment): Bind LC_ALL with C.

2017-01-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-external-view-this-url, w3m-external-view-current-url)
	(w3m-view-url-with-external-browser):
	Don't make obsolete.  [emacs-w3m:12627]

2017-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-real-url): Preserve #name portion.  [emacs-w3m:12618]

2017-01-04  Kevin Ryde  <user42_kevin@yahoo.com.au>

	* w3m-save.el (w3m-save-buffer): Use w3m-expand-file-name-as-url for
	w3m-history-push in case filename ~/foo etc.  [emacs-w3m:12617]

2016-10-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_PATH_EMACS): Work for Emacs 26.

2016-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-flet, w3m-labels): Add edebug spec.

2016-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Reset hscroll.

2016-09-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-delete-frames-and-windows): Don't try to delete
	window that this function deleted already in conjunction with its frame.
	It happened when a frame has two or more emacs-w3m windows.

2016-09-08  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-save.el (w3m-save-buffer-html-only): New user option.
	(w3m-save-buffer): Use it; improve docstring.  [emacs-w3m:12595]

2016-08-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-at-point): Refactor.

2016-08-18  Boruch Baum  <boruch_baum@gmx.com>

	* w3m.el (w3m-image-viewer): Make it defcustom.

2016-08-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	Don't use `string-as-multibyte' and `string-as-unibyte' that are
	obsolete in Emacs 25.2.
	Use `string-make-multibyte' and `string-make-unibyte' instead.

	* octet.el (octet-w3m-region):
	* w3m-image.el (w3m-imagick-convert-buffer):
	* w3m-proc.el (w3m-process-start-after):
	* w3m-util.el (w3m-insert-string): Do.

	Remove Gmane mailing list archive stuff.

	* w3m.el (w3m-gmane-url-at-point): Remove.

2016-08-01  Boruch Baum  <boruch_baum@gmx.com>

	* w3m-lnum.el: Do a boundp test for browse-url-generic-program.

2016-07-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make w3m-delete-buffer return to the buffer that launches
	the buffer to be deleted if w3m-use-tab is non-nil.

	* w3m.el (w3m-parent-session-buffer): New internal variable.
	(w3m-view-this-url-1):
	Save the current session in it when launching a new session.
	(w3m-delete-buffer, w3m-next-buffer):
	Return to the buffer that launches the buffer to be deleted.

2016-07-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-lynx-like-map): Bind "K" to w3m-scroll-down.
	[emacs-w3m:12570]

2016-07-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-create-image): Run w3m-image-animate in page buffer.

	* w3m.el (w3m-goto-url): Run w3m-select-buffer-update after evaluating
	w3m-display-hook and w3m-display-functions.  [emacs-w3m:12568]
	It seems to be rational to run w3m-force-window-update, that
	w3m-select-buffer-update runs, after settling down the page display.

2016-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-buffer-name-lessp): Work for Emacs 25.2 that starts
	numbered buffer names with *w3m*<1>, not *w3m*<2>.

2016-03-04  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-markdown-converter): New option to select the command to
	convert markdown formed files into HTML format.
	(w3m-prepare-markdown-content): Use the above.

2016-03-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Add support for markdown formed files.
	(w3m-content-type-alist, w3m-local-find-file-regexps): Add markdown
	entry.
	(w3m-prepare-markdown-content): New function.

2015-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	Prefer Cygwin pathnames when building emacs-w3m on Cygwin for
	Windows-native Emacs.  [emacs-w3m:12540]

	* aclocal.m4 (AC_PATH_CYGWIN): New function.
	(AC_PATH_LISPDIR, AC_PATH_ICONDIR): Use it.
	* configure.in: Check for cygpath program.

2015-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (lisp, what-where, install-package, install-package-ja)
	(dist, .el.elc, slow, very-slow)
	* doc/Makefile.in (EMACSINFO, version.texi): Quote Emacs's path name.

2015-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_SET_VANILLA_FLAG, AC_SET_XEMACSDEBUG, AC_EMACS_LISP)
	(AC_ADD_LOAD_PATH):
	* Makefile.in (FLAGS, lisp, what-where, install-lisp, install-package)
	(install-package-ja, dist, tarball, .el.elc, slow, very-slow):
	* doc/Makefile.in (FLAGS, EMACSINFO, version.texi, install, install-en)
	(install-ja): Work for path names containing whitespace.
	[emacs-w3m:12530]

2015-10-13  Bruno F$(D+1(Blix Rezende Ribeiro  <oitofelix@gnu.org>

	* w3m-form.el (w3m-form-make-form-data): Protect against empty token.
	[emacs-w3m:12517]

2015-10-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-gmane-url-at-point):
	Change query url to <http://news.gmane.org/group/thread=MESSAGE-ID>.

	* doc/txi-ja.tex: Make the pdf document display a bookmark by default.

2015-10-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* configure.in:
	* doc/Makefile.in (.texi.dvi): Use pbibtex rather than jbibtex.
	* doc/emacs-w3m-ja.texi: Add @usedvipdfmx to generate pdf bookmark.
	* doc/txi-ja.tex: Copy from <https://github.com/fukusaka/texinfo-ja/>.

2015-09-29  Kevin Ryde  <user42_kevin@yahoo.com.au>

	* w3m.el (w3m-check-header-tags): w3m-expand-url <base> to tolerate
	a non-absolute there, as for example from archive.org.
	(If w3m-current-base-url is relative then form setups error out.)

2015-06-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render):
	Set w3m-current-url (and w3m-current-title) so as to enable moving back
	to the past page (in the case w3m-clear-display-while-reading is t).
	(w3m-goto-url): Don't move point to the top when it failed to retrieve.
	[emacs-w3m:12471]

2015-06-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render):
	Don't display progress message for `about:' pages.  [emacs-w3m:12465]

2015-05-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-refresh-at-time): Remove workaround.  [emacs-w3m:12459]

2015-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-use-refresh): Mention Google looping problem in docstring.
	(w3m-refresh-minimum-interval): Default to 5; change the meaning.
	(w3m-check-refresh-attribute, w3m-view-previous-page):
	Do nothing for w3m-refresh-minimum-interval.
	(w3m-refresh-at-time):
	Override meta refresh seconds by w3m-refresh-minimum-interval.
	(w3m-goto-url-with-timer): Check for buffer's existence correctly.

2015-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-error): Work for XEmacs.  [emacs-w3m:12444]
	(w3m-retrieve-and-render): Work for XEmacs.
	Note: `get-buffer-window' requires a buffer for the 1st arg in XEmacs.

2015-05-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-refresh-at-time):
	Temporary fix to avoid Google search looping.  [emacs-w3m:12440]

2015-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-error): New face.
	(w3m-retrieve-and-render): Denote `failed' if it did so.

2015-04-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-clear-display-while-reading): New user option.
	(w3m-retrieve-and-render): Clear the current display while reading
	a new page if w3m-clear-display-while-reading is non-nil.
	[emacs-w3m:12428]

2015-04-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-savable-p): New function.
	(w3m-toolbar, w3m-menubar): Use it.

	* w3m-save.el: Provide the feature.

2015-04-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toolbar-buttons, w3m-toolbar): Add `Save' button.

	* icons/save-up.png, icons/save-up.xpm
	* icons30/save-up.png, icons30/save-up.xpm: New files.

2015-04-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-save.el: New file.

	* w3m.el (w3m-menubar, w3m-lynx-like-map, w3m-info-like-map):
	Add w3m-save-buffer and bind `C-x C-s' to it.

2015-03-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-add-name-anchors):
	Don't use ambiguous regexp.  [emacs-w3m:12422]

2015-02-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-search-name-anchor): Search for both "name" and
	(w3m-url-decode-string "name").  [emacs-w3m:12392]

2015-01-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-extra-numeric-character-reference):
	Use #x20 instead of ? .
	(w3m-scroll-up-1): Remove obsolete function alias to w3m-scroll-up.

2015-01-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-compile-file): New function.
	(w3mhack-compile): Use it.

2014-11-24  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el (w3m-lnum-actions-link-alist): Add open in background
	bindings.
	(w3m-lnum-remove-overlays): Enlarge default region to clean.
	(w3m-lnum-set-numbering): Use w3m-lnum-remove-overlays.
	(w3m-lnum-next-filter): New function.
	(w3m-lnum-read-interactive): Use it to search below and above when
	filter has no matches left.
	(w3m-with-lnum): Guarantee cleanup of right buffer.
	(w3m-lnum-get-action): Fix checkdoc warning.
	(w3m-lnum-visit): Make it function.  Enable visiting in background.
	(w3m-lnum-follow): Add prefix combinations to visit links in
	background.

2014-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-extra-numeric-character-reference): Add (?\C-m . ? ).
	[emacs-w3m:12378]

2014-10-01  Herbert J. Skuhra  <h.skuhra@gmail.com>

	* aclocal.m4 (AC_PATH_EMACS): Work for Emacs 25.

2014-08-01  Michael Heerdegen  <michael_heerdegen@web.de>
	Katsumi Yamaoka <yamaoka@jpl.org>

	* w3m.el (w3m-input-url-next-history-element): Abolish.
	(w3m-url-completion-map): Don't bind M-n key.
	(w3m-input-url-default-add-completions): New function.
	(w3m-input-url):
	Bind minibuffer-default-add-function to it locally in minibuffer.

2014-07-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url-provide-initial-content): New user option.
	(w3m-input-url): Use it.
	(w3m-input-url-next-history-element): New function.
	(w3m-url-completion-map): Bind it.
	[emacs-w3m:12345]

2014-07-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-add-name-anchors): Subdivide long regexp.
	[emacs-w3m:12339]

2014-06-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-lisp): Compress .el files.
	* doc/Makefile.in (install): Compress info files.

	* aclocal.m4 (AC_COMPRESS_INSTALL): New function.
	* configure.in: Use it.

2014-06-11  Kevin Ryde  <user42_kevin@yahoo.com.au>

	* w3m.el (w3m-zoom-out-image, w3m-resize-image-interactive): Treat
	zoom-out percentage as inverse of zoom-in, so "in" then "out" returns
	to the original size.
	(w3m-resize-inline-image-internal): Set w3m-image-scale property to
	flonum to avoid integer round-off when resizing in and out.  Use
	`round' rather than `truncate' when calling "convert" so flonum
	round-off 99.999 is original 100%.

2014-06-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-content-type-alist): Don't bug out for the case where
	browse-url-browser-function is set to a function symbol that is not yet
	defined.  [emacs-w3m:12317]

2014-04-21  Michael Ernst  <mernst@cs.washington.edu>

	* w3m-util.el (w3m-beginning-of-tag, w3m-end-of-tag): Work correctly
	for the case there is only whitespace between <tag> and </tag>.

2014-03-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-markup-urls-nobreak): Don't modify textarea.
	[emacs-w3m:12308]

2014-03-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Update regexps for Google.

2014-02-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-encode-string): Encode `:' and `/'.
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

	* w3m-form.el (w3m-form-make-form-data, w3m-form-parse-and-fontify):
	Use car-less-than-car.

2014-02-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-subst-disabled-with-readonly): Relax regexp.

	* w3m-form.el (w3m-form-submit): Work for a url having no query part.

2014-01-08  Mirko M.  <mirko.m@hotmail.com>

	* w3m-util.el (w3m-delete-frames-and-windows): Don't clear the windows
	layout that used to be before visiting an emacs-w3m buffer.
	[emacs-w3m:12273]

2014-01-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-static-if, w3m-static-when, w3m-static-unless)
	(w3m-static-cond): Add edebug spec.

	* octet.el: Fix edebug spec for the static-* macros.

2013-12-03  Tatsuya Kinoshita  <tats@vega.ocn.ne.jp>

	* mew-w3m.el (mew-w3m-region): Set point to the end of <div> tag to
	prevent infinite loop.

2013-12-01  Tatsuya Kinoshita  <tats@vega.ocn.ne.jp>

	* mew-w3m.el (mew-w3m-region): Set point to minimum for
	`mew-w3m-cite-blockquote' to work.

2013-11-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mew-w3m.el (mew-w3m-cite-blockquote): New function.
	(mew-w3m-region): Use it.

2013-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-subst-disabled-with-readonly): Rewrite.

	* w3m-filter.el (w3m-filter-subst-disabled-with-readonly):
	Fix the width of disabled select form.

2013-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-subst-disabled-with-readonly): Replace
	disabled or readonly select forms, that w3m doesn't support, with
	read-only input forms.  [emacs-w3m:12222]

	* w3m-form.el (w3m-form-parse-and-fontify): Make read-only text buttons
	for image, reset, and submit forms if readonly attr is turned on.

	* w3m-ems.el, w3m-form (w3m-form-make-button): Add the optional
	readonly argument; make a read-only text button if it is non-nil.

2013-11-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make non-link urls unbreakable.  [emacs-w3m:12215]

	* w3m.el (w3m-markup-urls-nobreak): New function.
	(w3m-rendering-buffer): Use it.

2013-10-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	Simplify the tab line control so as not to consume CPU.
	Thanks to Michael Heerdegen for good suggestions.

	* w3m-ems.el (w3m-tab-line-format, w3m-tab-timer): Abolish.
	(w3m-tab-mouse-track-selected-tab): Run `w3m-tab-line' instead of using
	its cache; remove unused argument `buffers'.
	(w3m-tab-line): Don't use chache and timer.

2013-10-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	Replace `w3m-external-view-current-url', `w3m-external-view-this-url',
	and `w3m-view-url-with-external-browser' with
	`w3m-view-url-with-browse-url' that runs `browse-url'. [emacs-w3m:12190]

	* w3m.el (w3m-menubar, w3m-tab-button-menu-commands, w3m-link-map): Do.
	(w3m-external-view-current-url, w3m-external-view-this-url)
	(w3m-view-url-with-external-browser): Make obsolete.
	(w3m-view-url-with-browse-url): New function.
	(w3m-mode-map): Bind "M" to it.

	* w3m-lnum.el (w3m-lnum-actions-link-alist): Bind "M" to
	w3m-view-url-with-browse-url instead of w3m-external-view.
	(w3m-lnum-mode-map): Use the key bound to w3m-view-url-with-browse-url
	for w3m-lnum-external-view-this-url.
	(w3m-lnum-external-view-this-url): Use w3m-view-url-with-browse-url
	instead of w3m-external-view.

2013-10-16  Michael Heerdegen  <michael_heerdegen@web.de>

	* w3m-ems.el (w3m-tab-line):
	Run w3m-force-window-update unconditionally.  [emacs-w3m:12175]

2013-10-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-inactive): Add underline property.
	(w3m-form-input-textarea): Don't use it to view read-only textarea.

2013-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make disabled or read-only forms inatcive.

	* w3m-form.el (w3m-form-parse-and-fontify): Make `select', `checkbox',
	`radio', and `file' input forms inactive.
	(w3m-form-input-checkbox, w3m-form-input-radio, w3m-form-input-file)
	(w3m-form-input-select): Don't allow keys if it is inactive.

2013-10-08  Thorsten Jolitz  <tjolitz@gmail.com>

	* w3m-form.el (w3m-form-input-textarea-mode-setup): New option for
	setting up the textarea input buffer in org-mode instead of text-mode.

	(w3m-form-input-textarea-org-mode-map) New minor-mode-map.
	(w3m-form-textarea-use-org-mode-p) New variable.
	(w3m-form-textarea-toggle-major-mode) New function.
	(w3m-form-input-textarea-mode-setup) Setup textarea edit buffer with
	major-mode 'org-mode if `w3m-form-textarea-use-org-mode-p' is non-nil.
	(w3m-form-input-textarea) Split window sensibly if
	`w3m-form-textarea-use-org-mode-p' is non-nil.
	(w3m-form-input-textarea-mode) Override default minor-mode map with
	new minor-mode-map in case major-mode is 'org-mode.

2013-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-input-textarea-mode-setup):
	Fix typo (unquoted `view-mode').

2013-10-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-input-textarea-mode-setup): Use view-mode to
	show disabled or readonly textarea.
	(w3m-form-input-textarea): Revert last change; use w3m-form-inactive
	face to show disabled or readonly textarea.

2013-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make disabled forms not editable.  [emacs-w3m:12146]

	* w3m.el (w3m-use-filter): Default to t.
	(w3m-show-form-hint): Notice form is inactive.

	* w3m-filter.el (w3m-filter-subst-disabled-with-readonly): New function
	that substitutes the `disabled' attribute with the `readonly' attribute
	in an html source so as to enable w3m to handle.
	(w3m-filter-configuration): Add it.

	* w3m-form.el (w3m-form-inactive): New face.
	(w3m-fontify-textareas, w3m-form-parse-and-fontify): Use it if text is
	not editable.
	(w3m-form-input): Use w3m-message rather than message.
	(w3m-form-input-textarea): Don't allow editing text if it is disabled.
	(w3m-form-last-position): New variable.
	(w3m-form-restore-last-position): New function.
	(w3m-form-submit): Add it to w3m-fontify-after-hook.

2013-09-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url): Default to `default' or "".
	(w3m-download): Prompt for url endlessly instead of bugging out.
	(w3m): Doc fix.

2013-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-completion-map): New overriding keymap.
	(w3m-input-url): Use it.
	Suggested by Manuel Giraud <manuel@ledu-giraud.fr>.

2013-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-toolbar-make-buttons): Make tool-bar button use
	a single icon image if Emacs built with Gtk+ is running.
	cf.
	<https://lists.gnu.org/archive/html/bug-gnu-emacs/2013-09/msg00170.html>
	(w3m-toolbar-use-single-image-per-icon): Add a note to docstring.

2013-09-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-decode-coding-string-with-priority):
	Move from w3m-ems.el and w3m-xmas.el.
	* w3m-ems.el, w3m-xmas.el
	(w3m-decode-coding-string-with-priority): Move to w3m-util.el.
	* w3m-proc.el: Don't Fbind it.

	* w3mhack.el (w3mhack-make-package):
	Avoid making a hard link for w3m-load.el twice.

2013-09-03  Manuel Giraud  <manuel@ledu-giraud.fr>

	* w3m.el (w3m-canonicalize-url): Do uri replace before normal parsing.

2013-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	Prefer uris based on w3m-uri-replace-alist to Google's feeling lucky.
	Suggested by Michael Heerdegen <michael_heerdegen@web.de>.

	* w3m.el (w3m-canonicalize-url): Run w3m-uri-replace before falling
	back to Google's feeling lucky.
	(w3m-uri-replace): Simply return nil if there is no replacement.
	(w3m-goto-url): Move forward w3m-uri-replace to w3m-canonicalize-url.

2013-08-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Record failed urls as well to the
	arrived database.  Suggested by Dan Jacobson.
	(w3m-delete-buffer): Kill form buffers before killing a page buffer.
	(w3m-delete-buffer): Work around mysterious bug where window positions
	aren't restored if this command is called by a mouse event.  Reported
	by Dan Jacobson.

2013-08-26  Dan Jacobson  <jidanni@jidanni.org>

	* w3m.el (w3m-toolbar): Simplify the label used for w3m-history.

2013-08-13  Kevin Ryde  <user42@zip.com.au>

	* w3mhack.el (w3mhack-module-list): Remove w3mhack-load-file from the
	modules not to be byte compiled, so that it is byte compiled.
	(w3mhack-generate-load-file): Remove no-byte-compile from w3m-load.el.

2013-08-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-parse-and-fontify): Prefer base url if any
	rather than the current url when constructing urls that form buttons
	specify.  Thanks to Thorsten Jolitz [emacs-w3m: 12107].

2013-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m): Enable it again to fetch Gmane url and others.
	(w3m-gmane-url-at-point): Update url.

2013-06-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-use-cookies): Default to t.

	Make `w3m-input-url' offer no useless initial string.
	* w3m.el (w3m-active-region-or-url-at-point, w3m-input-url)
	(w3m-download, w3m-view-this-url, w3m-view-url-with-external-browser)
	(w3m-goto-url, w3m-goto-url-new-session, w3m): Do.

2013-06-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4: Make configure work for term-mode running in Emacs.

2013-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (ffap-url-regexp): Silence the byte compiler.

	* mime-w3m.el: Require calist when compiling.

2013-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el: Don't use obsolete macro dont-compile.

	* w3m.el (w3m-goto-mailto-url): Bind display-buffer-alist instead of
	special-display-buffer-names and special-display-regexps for Emacs >=
	24.3.

	* w3m-ems.el (w3m-image-multi-frame-p): Exclude images that don't
	specify a delay.

2013-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter): Don't modify w3m-filter-rules.

2013-04-12  REN Lifeng  <renlifeng@wowfly.com>

	* w3m-session.el (w3m-session-rename): Don't infloop.

2013-04-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-configuration):
	Use w3m-language rather than w3m-use-japanese-menu.

2013-04-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-add-name-anchors): Fix regexp matching name
	anchors.  Reported by Dan Jacobson <jidanni@jidanni.org>.

2013-04-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-get-by-name): Distinguish the type of forms of
	the same names.  Reported by Kevin Ryde <user42@zip.com.au>.
	(w3m-form-resume, w3m-form-parse-and-fontify, w3m-form-input-map): Do.

2013-04-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-fix-tfoot-rendering): New filter.
	(w3m-filter-configuration): Add it but not activate.

	* w3m-ems.el (w3m-image-multi-frame-p): New alias.
	(w3m-image-animate): Use it.

2013-02-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Remove workaround.
	* w3m-util.el (w3m-force-window-update-later): Make 1st arg optional.
	* w3m-ems.el (w3m-force-window-update): A window need to be redisplayed
	for `force-window-update' to work (see the docstring).

2013-01-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-lnum-read-interactive): Replace w3m-scroll-up-1 with
	w3m-scroll-up.

	* w3m.el (w3m-scroll-up): Rename from w3m-scroll-up-1.
	(w3m-scroll-up, w3m-scroll-up-or-next-url): Make the bottom of a page
	border on the bottom of a screen when having finished scrolling
	the page up.
	(w3m-scroll-down): New function detached from
	w3m-scroll-down-or-previous-url.
	(w3m-scroll-down-or-previous-url): Move point to the top when having
	finished scrolling a page down.
	(w3m-mwheel-scroll-up, w3m-mwheel-scroll-down): New functions.
	(w3m-mode): Bind mwheel-scroll-(up,down)-function to
	w3m-mwheel-scroll-(up,down).
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

2013-01-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Do (sit-for 0) to update the
	header-line appearance as a workaround; see the 2013-01-11 comment.
	(w3m-view-this-url-1): Revert 2010-01-15 change; don't popup new
	session if w3m-new-session-in-background is non-nil.
	Reported by Michael Heerdegen <michael_heerdegen@web.de>.

2012-12-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-do-search): Save history position.
	Reported by Dan Jacobson <jidanni@jidanni.org>.

2012-12-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-ems-create-image): Abolish.
	(w3m-image-animate-seconds): New user option.
	(w3m-image-animate): New function.
	(w3m-create-image): Use it.

	* w3m.el (w3m-resize-inline-image-internal): Use w3m-image-animate.

	* w3m-xmas.el (w3m-image-animate): Alias to identity.

2012-12-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-anchor-string): Decode url used to next/prev/...
	cf. http://emacs-w3m.namazu.org/ml/msg11824.html

2012-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-flet): Rewrite it using cl-letf.

2012-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-labels): Revert; use cl-labels if available.

2012-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-labels): Rewrite.

2012-11-19  Uday S Reddy  <u.s.reddy@cs.bham.ac.uk>

	* w3m.el (w3m-command-environment): Make the "CYGWIN" environment
	variable default to "binmode" for NTEmacs.

2012-10-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-configuration): Work around a widget bug.

2012-10-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el: Change file coding system to utf-8.
	(w3m-filter-configuration):
	New user option, a successor to w3m-filter-rules.
	(w3m-filter-rules):
	Make it semi-obsolete (but still usable) and default to nil.
	(w3m-filter):
	Use w3m-filter-configuration in addition to w3m-filter-rules.
	(w3m-filter-google-click-tracking)
	(w3m-filter-google-shrink-table-width, w3m-filter-add-name-anchors):
	New filters.

	* w3m.el (w3m-rendering-half-dump):
	Move function, that adds name anchors, to w3m-filter.el.
	(w3m-create-page): Move Google click-tracking filter to w3m-filter.el.

	* w3m-util.el (w3m-widget-type-convert-widget):
	Don't modify default sexp values.

2012-10-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-bookmark-buffer): Use (0 0) as the Unix epoch.

	* w3m.el (w3m-create-page): Fix regexp matching Google's click-
	tracking urls.

2012-07-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-rendering-half-dump): Add name anchors for only existing
	internal links.

2012-07-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-flet): New macro.

2012-07-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url): Decode url string by the coding system that
	url itself specifies if any.

	* w3m.el (w3m-goto-url): Allow optional save-pos argument, that leads
	it to run w3m-history-store-position.
	(w3m-view-parent-page, w3m-scroll-up-or-next-url)
	(w3m-scroll-down-or-previous-url): Run w3m-history-store-position.
	(w3m-gohome, w3m-browse-url, w3m-find-file, w3m-db-history)
	(w3m-history): Run w3m-history-store-position by way of w3m-goto-url.

	* w3m-util.el (w3m-labels): New macro that runs cl-labels in Emacs 24.2
	and later, otherwise runs labels.

	* mime-w3m.el (mime-w3m-insinuate):
	* w3m-bookmark.el (w3m-bookmark-safe-string):
	* w3m-proc.el (w3m-process-do-with-temp-buffer):
	* w3m-rss.el (w3m-rss-parse-date-string):
	* w3m-weather.el (w3m-weather-completion-table):
	Replace labels with w3m-labels.

	* w3mhack.el (w3mhack-nonunix-install): Don't use labels.

2012-07-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url, w3m-header-line-insert):
	Don't decode only control characters.

2012-07-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url): Don't decode %00~%1F and %7F~%9F in url.

2012-07-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-decode-string): Allow optional regexp matching %**.
	(w3m-header-line-insert): Don't decode %00~%1F and %7F~%9F in url.

	* w3m.el (w3m-create-page): Show raw contents briefly, not fully, when
	prompting a user for the content type.

2012-07-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-rendering-half-dump): Add name anchors fast.

2012-07-10  Naohiro Aota  <naota@elisp.net>

	* w3m.el: (w3m-data-retrieve): URL-decode data-string. It can have
	"%2b%2d%3d" representing "/+=".

2012-07-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-rendering-half-dump): Add name anchors that w3m can
	handle in nested tags.

2012-07-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-url-with-external-browser): Improve prompt string.
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

2012-06-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-active-region-or-url-at-point, w3m-print-this-url):
	Try to pick #name anchor out.

	* w3m-search.el (w3m-search-read-variables): Make commands that use it
	error out when other processes run in the current w3m buffer.

	* w3m.el (w3m-mode): Add description of some missing commands to doc.

2012-06-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-create-page): Safely quit session when a user hits C-g;
	make sure to set w3m-current-url.

2012-06-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-cache-header, w3m-cache-request-header)
	(w3m-cache-contents, w3m-cache-request-contents)
	(w3m-cache-available-p): Canonicalize given url.
	(w3m-show-error-information): Show as many info as possible.

2012-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-popup-buffer): Do nothing for the current buffer.

	* w3m.el (w3m-history-highlight-current-url): Extend href anchor to bol.

	* w3m.el (w3m-http-status-alist): New variable.
	(w3m-http-status): New variable.
	(w3m-w3m-retrieve): Set it.
	(w3m-retrieve): Clear it.
	(w3m-download, w3m-retrieve-and-render, w3m-show-error-information):
	Show http status if download or retrieving fails.

2012-06-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-encode-string-2): Encode only `(' and `)'.

2012-06-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-do-with-temp-buffer): Use labels macro again.
	Functions that the labels form generates to be used in the outside of
	the labels form should be prefixed with #' from now on.
	Thanks to Michael Heerdegen and Andreas Schwab.

	* w3m-proc.el (w3m-process-do-with-temp-buffer): Don't use labels macro
	of which the spec has been changed in the most recent Emacs.

2012-06-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-expand-url): Work for scheme name containing upcase
	letters.  Reported by Dan Jacobson <jidanni@jidanni.org>.

	* w3m-util.el (w3m-force-mode-line-update): New alias.

	* w3m-lnum.el (w3m-with-lnum, w3m-lnum-universal-dispatch): Use it.

2012-06-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-create-page): Improve regexp matching Google's click-
	tracking urls.

2012-05-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-encode-string-2): New function.
	(w3m-print-current-url, w3m-print-this-url, w3m-print-this-image-url):
	Use it to encode url characters that are apt to be misidentified as
	word boundaries.

2012-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-create-page): Decode url in Google's click-tracking
	filter.

2012-04-18  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el (w3m-with-lnum, w3m-lnum-universal-dispatch):
	Explicitly redraw mode line.
	(w3m-lnum-visit): Fix prompt; add --insecure option to Curl.

2012-04-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-create-page): Add a filter for Google's click-tracking
	temporarily --- maybe this should be incorporated in w3m-filter.el.

2012-04-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-mailto-url): Protect against nil value of body=;
	decode url string; don't change mail buffer's modification status;
	make sure body text is inserted to the message body.

2012-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-shr-url-at-point): New function.
	(w3m-url-at-point): Use it.

	* doc/ptexinfmt.el (texinfo-format-syntax-table): Modify character
	syntax of " and \ to w, as a workaround.
	(texinfo-format-comma): Support @comma.
	(texinfo-format-parse-args): Tweak it so as to work for @comma.

2012-03-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-scroll-left, w3m-scroll-right): Use image-mode function
	for an image page.
	(w3m-shift-left, w3m-shift-right): Pass prefix argument to image-mode
	function.

2012-03-12  Dan Jacobson  <jidanni@jidanni.org>

	* w3m.el (w3m-ctl-c-map): Bind `C-c C-e' to w3m-goto-new-session-url.

2012-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules)
	(w3m-open-all-links-in-new-session): Work for https Google pages.

2012-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-mailto-url): Work for mail body.

2012-02-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-switch-to-buffer): Abolish.

	* w3m-bookmark.el (w3m-bookmark-add-all-urls):
	* w3m-ems.el (w3m-tab-drag-mouse-function)
	(w3m-tab-click-mouse-function, w3m-tab-next-buffer)
	(w3m-tab-make-keymap):
	* w3m-form.el (w3m-form-input-textarea, w3m-form-input-select)
	(w3m-form-input-map):
	* w3m-session.el (w3m-session-select):
	* w3m-tabmenu.el (w3m-switch-buffer, w3m-tab-menubar-open-item):
	* w3m-util.el (w3m-popup-buffer, w3m-make-menu-commands):
	* w3m.el (w3m-next-buffer, w3m-move-unseen-buffer)
	(w3m-goto-url-new-session, w3m-reload-all-pages): Revert to using
	switch-to-buffer.

2012-02-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-store-position): Don't trust column position
	that Emacs tells if there's an image.
	(w3m-history-restore-position): Revert 2011-10-21 change.

2012-02-10  Kevin Ryde  <user42@zip.com.au>

	* w3m.el (w3m-about-header): Show info of image where point stays.

2012-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mode): Don't make bidi-paragraph-direction bound globally
	in old Emacsen and XEmacsen.
	(w3m-goto-url): Work for name anchors.

2012-01-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-form-make-button): Use "submit" instead for an empty
	text, that won't be buttonized.
	Reported by Roland Winkler <winkler@gnu.org>.

2012-01-13  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors, w3m-goto-url): Not encode and decode
	the anchor values to use Punycode.

2012-01-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-image-type-alist): Add image/tiff.
	(w3m-view-previous-page): Protect against empty history.

2012-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-icons, install-icons30, install-info)
	(install-info-en, install-info-ja, install-package)
	(install-package-ja):
	* doc/Makefile.in (install): Add DESTDIR variable to installation
	directory.

	* w3mhack.el (w3mhack-expand-file-name): New function.
	(w3mhack-what-where): Use it.

	* aclocal.m4 (AC_SET_VANILLA_FLAG): Remove --no-unibyte option.

2012-01-02  Elias Pipping  <pipping@lavabit.com>

	* Makefile.in (install-lisp): Add DESTDIR variable to installation
	directory.

2011-12-26  Dan Jacobson  <jidanni@jidanni.org>

	* w3m.el (w3m-gohome): Always reload the home page.

2011-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mode): Force paragraph direction to be left-to-right.
	Suggested by Naohiro Aota <naota@elisp.net>.

2011-12-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (.el.elc): Shut up.

	* w3m-lnum.el (w3m-lnum-read-interactive): Use (sit-for 0) instead of
	redisplay for Emacs 21.1, too.

2011-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_EMACS_LISP): Simplify.
	(AC_PATH_EMACS): Simplify Lisp code so as to make it work for recent
	XEmacsen.

	* w3m-favicon.el (w3m-favicon-type): Silence SXEmacs 22.1.14's byte
	compiler.

	* w3m-lnum.el (w3m-lnum-read-interactive): Use (sit-for 0) instead of
	redisplay for XEmacs.

	* w3m.el (w3m-resize-image-interactive): Use read-char-exclusive with
	no arg for XEmacs.

2011-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-read-file-name): Don't strip query part from given url.
	(w3m-download): Always prompt for file name; don't strip query part.
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

2011-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-lnum-universal-dispatch): Add argument passed to
	kill-buffer, Emacs 22 requires it; use beginning-of-line rather than
	move-beginning-of-line that XEmacs doesn't provide.

2011-12-02  Dan Jacobson  <jidanni@jidanni.org>

	* w3m-search.el (w3m-search-engine-alist): Put search string first in
	query form.

2011-11-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-popup-buffer): Restore history position always.

	* w3m.el (w3m-copy-buffer): Save history position.

2011-11-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-lnum-actions-custom-type): New variable.
	(w3m-lnum-actions-general, w3m-lnum-actions-image-alist)
	(w3m-lnum-actions-link-alist w3m-lnum-actions-button-alist)
	(w3m-lnum-actions-form-alist): Use it to improve custom type.

2011-11-16  Andrey Kotlarski  <m00naticus@gmail.com>

	Add alternative selection->action method.

	* w3m-lnum.el: Update comment section.
	(w3m-lnum-quick-browsing): Change default value.
	(w3m-lnum-actions-general, w3m-lnum-actions-image-alist)
	(w3m-lnum-actions-link-alist, w3m-lnum-actions-button-alist)
	(w3m-lnum-actions-form-alist): New custom options.
	(w3m-lnum-remove-overlays): Add optional parameters for start and end.
	(w3m-lnum, w3m-lnum-prompt-str, w3m-lnum-highlight-anchor): Sanitize
	variable naming.
	(w3m-read-event, w3m-lnum-visit, w3m-lnum-make-action): New macros.
	(w3m-lnum-read-interactive): Add optional parameters for previous filter
	and selected number.  Return last applied filter along selected value.
	Use `w3m-read-event'.  Remove lnum overlays within all buffer on
	scroll.
	(w3m-with-lnum): Add parameter for initial filter.  Change mode-line
	during selection.
	(w3m-lnum-get-action): If single image during image selection -
	immediately select it.  Accommodate to new return format of
	`w3m-lnum-read-interactive'.
	(w3m-lnum-follow): Use `w3m-lnum-visit'.
	(w3m-lnum-universal-dispatch): New function.
	(w3m-lnum-universal): New command.
	(w3m-lnum-view-image, w3m-lnum-save-image, w3m-lnum-print-this-url):
	Use nth.
	(w3m-lnum-zoom-image): Use `w3m-resize-image-interactive'.
	(w3m-lnum-zoom-in-image, w3m-lnum-zoom-out-image): Update doc string.
	(w3m-lnum-bookmark-add-this-url): Fix bookmarking of current url.
	(w3m-lnum-actions-link-alist): Add actions for generic browser and Curl
	if present.

	* w3m.el (autoload): Autoload `w3m-lnum-universal'.
	(w3m-resize-image-interactive): New function.
	(w3m-lnum-map): Add key for `w3m-lnum-universal'.

2011-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-expand-url): Assume only a name anchor, that has no
	scheme part nor directory part, to be the buffer: scheme.
	(w3m-buffer-local-url): Move forward.

2011-10-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el: Require w3m-util.

2011-10-22  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-goto-url): Check name anchor after redirect resolution.

2011-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-restore-position): Don't hscroll if there
	are images ([emacs-w3m:11658]).

2011-10-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-canonicalize-url): Fix url that fails to have put
	a separator following a domain name.
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

2011-10-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-coding-system-alist): Add a rule for Google.
	(w3m-url-coding-system): Allow function to determine coding system.

2011-10-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-encode-string, w3m-url-transfer-encode-string):
	Restore optional coding argument.
	(w3m-gmane-url-at-point, w3m-canonicalize-url): Do.
	(w3m-download): Decode file name in url.

	* w3m-form.el (w3m-form-make-form-data, w3m-form-parse-and-fontify):
	* w3m-search.el (w3m-search-escape-query-string, w3m-search-do-search)
	(w3m-search-uri-replace): Revert last change.

2011-10-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-coding-system-alist): New user option.
	(w3m-show-decoded-url, w3m-google-feeling-lucky-charset): Abolish.
	(w3m-url-coding-system): New function.
	(w3m-url-encode-string, w3m-url-readable-string)
	(w3m-url-transfer-encode-string): Use it.

	* w3m.el (w3m-fontify-anchors, w3m-gmane-url-at-point)
	(w3m-canonicalize-url, w3m-goto-url):
	* w3m-form.el (w3m-form-make-form-data, w3m-form-parse-and-fontify):
	* w3m-search.el (w3m-search-escape-query-string, w3m-search-do-search)
	(w3m-search-uri-replace): Don't specify coding system for encoding url.

2011-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-type): Prefer gif.
	(w3m-favicon-convert): Work for gif icons named "favicon.ico".

2011-09-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-lnum-face): Remove face alias.
	(w3m-lnum-quick-browsing): Add custom type.
	(w3m-lnum-remove-overlays, w3m-lnum-set-numbering)
	(w3m-lnum-highlight-anchor, w3m-lnum-get-match-info): Fix overlay end
	range, too.

2011-09-07  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m.el: Use `w3m-lnum' as naming prefix for commands and
	maps from `w3m-lnum.el'.

	* w3m-lnum.el: Use `w3m-lnum' as naming prefix everywhere instead of
	`w3m-linknum' or `w3m-link-numbering'.
	(w3m-lnum-set-numbering, w3m-lnum): Optionally don't clean previous
	numbering.
	(w3m-lnum-read-interactive): Don't clean previous numbering with
	`w3m-lnum' in cases when there is no such.
	(w3m-lnum-remove-overlays, w3m-lnum-set-numbering): Fix overlay start
	range to make it work for XEmacs.
	(w3m-lnum-get-action): Don't invoke `w3m-lnum-read-interactive' with 0
	numbered items.

	* w3m-util.el (w3m-goto-next-defun): New macro.
	(w3m-goto-next-anchor-or-image, w3m-substitute-key-definitions): Move
	from w3m-lnum.el

2011-09-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-link-numbering, w3m-linknum-minibuffer-prompt)
	(w3m-linknum-match): Use old defface style for XEmacs.
	(w3m-link-set-numbering): Replace string-match-p w/ w3m-string-match-p.
	(w3m-highlight-numbered-anchor, w3m-get-match-info): Fix range passed
	to overlays-in to make it work for XEmacs.

2011-09-04  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el: Update copyright years. Don't require `cl'.
	(w3m-linknum-match): Make numbering face visible for some
	consoles.
	(w3m-link-numbering-quick-browsing)
	(w3m-link-numbering-context-alist): New custom variables.
	(w3m-linknum-remove-overlays): Delete overlays only within the
	visible window part.
	(w3m-link-set-overlay): Don't use `incf'.
	(w3m-link-set-numbering): Number additional context items as
	specified by `w3m-link-numbering-context-alist'. Return index of
	the last matched item.
	(w3m-goto-next-image2): Fix doc typo.
	(w3m-goto-next-anchor-or-image, w3m-link-numbering): Cosmetic
	indent.
	(w3m-linknum-prompt-str): Don't show 0 when this is being current
	default for selection.
	(w3m-read-int-interactive): Up and down scrolling preserves text
	filter and cleans previous numbering. Allow <enter> shortcutting
	options as specified by `w3m-link-numbering-quick-browsing'. Don't
	let the text filter grow when no items match.
	(w3m-with-linknum): Make `last-index' variable visible within body
	and set as the last index currently used for numbering.
	(w3m-get-match-info): New macro.
	(w3m-get-anchor-info): Use `w3m-get-match-info'.
	(w3m-go-to-linknum, w3m-linknum-get-action): Call
	`w3m-get-anchor-info' with a selection number.
	(w3m-linknum-follow, w3m-linknum-view-image)
	(w3m-linknum-save-image, w3m-linknum-print-this-url): Don't use cl
	functions.
	(w3m-linknum-zoom-image): Cosmetic doc string change.
	(w3m-linknum-bookmark-add-this-url): Use 1+.

2011-09-03  Dan Jacobson  <jidanni@jidanni.org>

	* w3m.el (w3m-lynx-like-map, w3m-info-like-map): Bind the `C-t t' key
	to w3m-create-empty-session.

2011-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-create-empty-session): New user command.
	(w3m-new-session-url): Default to about:blank.
	(w3m-input-url): Don't use about:* as initial value.
	(w3m-goto-url-new-session): Use w3m-new-session-url as the default.

2011-07-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-toolbar-define-keys): No need to take care of
	the tool-bar default bindings for Emacs 24.

2011-07-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ccl.el (charset-id): Work for old Emacsen.

2011-07-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-buffer): Switch to the previous emacs-w3m buffer
	explicitly; bind frame-auto-delete and ignore-window-parameters while
	killing the buffer.
	(w3m-goto-url): Change the order of retrieving group:* urls so as to
	arrange the buffer list in turn.

2011-07-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ccl.el (charset-id): Silence the byte compiler.

	* w3m-ems.el (w3m-detect-coding-region): Use with-coding-priority.
	(w3m-make-ccl-coding-system): Silence the byte compiler.

2011-07-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-switch-to-buffer): New function.

	* w3m-bookmark.el (w3m-bookmark-add-all-urls):
	* w3m-ems.el (w3m-tab-drag-mouse-function)
	(w3m-tab-click-mouse-function, w3m-tab-next-buffer)
	(w3m-tab-make-keymap):
	* w3m-form.el (w3m-form-input-textarea, w3m-form-input-select)
	(w3m-form-input-map):
	* w3m-session.el (w3m-session-select):
	* w3m-tabmenu.el (w3m-switch-buffer, w3m-tab-menubar-open-item):
	* w3m-util.el (w3m-popup-buffer, w3m-make-menu-commands):
	* w3m.el (w3m-next-buffer, w3m-move-unseen-buffer)
	(w3m-goto-url-new-session, w3m-reload-all-pages): Use it.

2011-07-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-mailto-url): Pass other headers to the agent.
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

2011-07-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-interactive-p): New macro.

	* w3m.el (w3m-toggle-inline-image, w3m-toggle-inline-images)
	(w3m-goto-url, w3m-safe-view-this-url):
	* w3m-hist.el (w3m-history-store-position)
	(w3m-history-restore-position): Use it.

	* w3m-ems.el (w3m-toolbar-define-keys): Work around the Emacs 24 error
	"`keymap' is reserved for embedded parent maps".

2011-05-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-form-hint): Give point as arg to w3m-submit to
	prevent cursor from being caught in form area.

2011-04-20  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Fix description comment style.

2011-04-13  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Use lexical binding.
	(ptexinfmt-broken-facility): Rename _dummy argument.
	(texinfo-enclosure-list, texinfo-alias-list): Add defvar stub for
	lexical binding.

2011-03-10  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-content-type-alist): Use functionp instead of symbolp for
	the users who set their own private function to
	browse-url-browser-function.

2011-02-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-active-region-or-url-at-point): Move w3m-url-at-point()
	after to check the properties of w3m-URL.

2011-02-23  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-goto-url): Invoke error if you try to invoke another w3m
	process when one loading.

2011-02-09  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-show-form-hint): New function to display submitting form
	hint.
	(w3m-after-cursor-move-hook): Use it.

2011-01-31  Johan Claesson  <johanclaesson@bredband.net>

	* w3m.el (w3m-content-type-alist): When selecting which external html
	browser to use, handle the case where browse-url-browser-function is
	an alist.

2011-01-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-rendering-half-dump): Protect against things that look
	like tags but aren't.

2011-01-23  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Decode entities in title of anchor.

2011-01-23  Kevin Ryde  <user42@zip.com.au>

	* w3m.el (w3m-print-this-url): Correction to my last, use string-width
	not length.

2011-01-13  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-goto-mailto-url): Decode entities in URL.

2011-01-11  Kevin Ryde  <user42@zip.com.au>

	* w3m.el (w3m-print-this-url): If anchor-title plus url is wider than
	the frame then use two lines "Title\nURL".
	(w3m-about-header): Show anchor-title of link at point.

2011-01-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): If exist `title' in anchor, it adds to
	w3m-balloon-help property and puts it to w3m-anchor-title property.
	(w3m-print-this-url): Treat w3m-anchor-title property.

	* w3m-util.el (w3m-anchor-title): New macro.

2011-01-03  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fix-illegal-blocks): Fix FIXEDCASE and LITERAL options of
	replace-match to `t'.

2010-12-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-rendering-half-dump): Add name anchors that w3m can
	handle ([emacs-w3m:11153]).

2010-12-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-replace-regexps-in-string): Move from w3m-lnum.el;
	use w3m-replace-in-string instead of replace-regexp-in-string that is
	not available in XEmacs 21.4; make it a Lisp function.
	(w3m-string-match-p, w3m-substring-no-properties): New functions.

	* w3m-lnum.el (w3m-link-set-numbering): Use w3m-string-match-p instead
	of string-match-p that is not available in Emacs 21~22 and XEmacs.
	(w3m-read-int-interactive): Use w3m-substring-no-properties instead of
	substring-no-properties that is not available in Emacs 21, XEmacs 21.4,
	and SXEmacs.
	(w3m-linknum-follow): Remove the 5th arg passed to read-string.  It is
	not available in XEmacs.

2010-12-26  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el: Updated comments section.
	(w3m-link-numbering-mode-hook, w3m-link-numbering-mode-map):
	Updated doc string.
	(w3m-link-set-overlay): No more need for save-excursion.
	(w3m-replace-regexps-in-string, w3m-linknum-prompt-str): New
	macros.
	(w3m-link-set-numbering): Refactored, does filtering as well.
	Does numbering only within the visible window part.
	(w3m-goto-next-link, w3m-goto-next-image2): New functions.
	(w3m-goto-next-anchor-or-image): Take optional argument for
	position.  No need to use goto-char.
	(w3m-link-numbering): Take additional argument for filtering
	string.  Use `w3m-goto-next-link', `w3m-goto-next-image2'.  No
	more need for `save-excursion'.
	(w3m-read-int-interactive): I-search functionality added.  Offer
	to select firstly numbered option when possible.
	(w3m-with-linknum): Put the call to `w3m-link-numbering' inside
	the `unwind-protect'.
	(w3m-highlight-numbered-anchor): Highlight only within the visible
	window part.  Return text for the form fields or buttons as well.
	(w3m-get-anchor-info): Operate only within the visible window
	part.
	(w3m-go-to-linknum, w3m-linknum-get-action): Updated for the
	changed `w3m-link-numbering' argument codes.
	(w3m-linknum-follow): According to prefix arguments may toggle
	instead of visit image links.  Also options to edit link before
	visiting.

2010-12-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fix-illegal-blocks): Save restriction.

2010-12-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el (kill-new): Don't compile defadvice form when building
	emacs-w3m.

	* w3m.el (w3m-fix-illegal-blocks): New function.
	(w3m-rendering-buffer): Use it.

	* w3m-util.el (w3m-beginning-of-tag, w3m-end-of-tag): Move from
	shimbun/shimbun.el.

2010-12-13  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-external-view): Execute default web browser insted of
	download if content-type is not supported.

2010-12-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-print-this-url, w3m-print-this-image-url):
	Fix "no url" message.  Suggested by Dan Jacobson <jidanni@jidanni.org>.

2010-12-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-session.el (w3m-session-crash-recovery-remove):
	Add autoload cookie.

2010-12-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url): Return nil for empty url.
	(w3m-view-url-with-external-browser): Prompt user to edit url, not to
	answer y/n.  Suggested by Dan Jacobson <jidanni@jidanni.org>.

2010-11-03  Kevin Ryde  <user42@zip.com.au>

	* w3m-util.el (w3m-condition-case): Add a missing quote
	([emacs-w3m:11405]).

2010-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* bookmark-w3m.el (bookmark-make-record-function): Don't bind it to any
	value.  Suggested by David Engster ([emacs-w3m:11395]).

2010-10-13  IRIE Shinsuke  <irieshinsuke@yahoo.co.jp>

	* w3m-ems.el (w3m-tab-previous-buffer): Work when called interactively
	with no arg.

2010-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Load bookmark-w3m for Emacs >=23.

	* w3mhack.el (w3mhack-module-list): Exclude bookmark-w3m.el from
	compilation under Emacs <23 and XEmacs.

	* bookmark-w3m.el: Provide the feature; add comment.
	(bookmark-w3m-bookmark-jump): Add autoload cookie.

2010-10-08  Masatake YAMATO  <yamato@redhat.com>

	* bookmark-w3m.el: New file.

2010-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-make-local-hook): New function.

	* mime-w3m.el (mime-display-message)
	* w3m-mail.el (w3m-mail-compose-with-vm)
	* w3m.el (w3m-set-buffer-unseen, w3m-buffer-setup): Use it.

2010-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-add-local-hook, w3m-remove-local-hook): Abolish.

	* mime-w3m.el (mime-display-message)
	* w3m-mail.el (w3m-mail-compose-with-vm)
	* w3m.el (w3m-set-buffer-unseen, w3m-set-buffer-seen)
	(w3m-buffer-setup): Don't use w3m-add-local-hook and
	w3m-remove-local-hook.

2010-09-25  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el: Update Commentary section.
	(w3m-link-set-overlay): New macro.
	(w3m-link-set-numbering, w3m-goto-next-anchor-or-image): New
	functions.
	(w3m-link-numbering): Refactor, use `w3m-link-set-numbering'.
	(w3m-read-int-interactive): Echo currently to be selected element.
	(w3m-with-linknum): Update docstring.
	(w3m-highlight-numbered-anchor): Properly highlight and
	unhighlight multiline elements and return selection info.
	(w3m-get-anchor-info): Always return 4 element list.
	(w3m-go-to-linknum): Echo `w3m-current-url' for default selection.
	(w3m-linknum-follow): Add support for toggling non link images.
	Inverse prefix argument behaviour for some elements.
	(w3m-linknum-toggle-inline-image, w3m-linknum-edit-this-url)
	(w3m-linknum-print-this-url): Cosmetic indentation changes.

2010-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-init-file): Allow nil.  Suggested by Leo.

2010-09-09  Leo  <sdl.web@gmail.com>

	* w3m.el (w3m-input-url): Pass DEFAULT argument to completing-read,
	instead of replacing its return value, to enable a user to edit.

2010-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-active-region-or-url-at-point): Remove only newlines and
	leading and trailing whitespace in region string.
	(w3m-input-url): Treat INITIAL if it is "" as nil but don't mind region
	even if it is active; treat DEFAULT if it is "" as nil but don't regard
	to w3m-home-page; always show DEFAULT if any within prompt string.
	Suggested by Leo <sdl.web@gmail.com>.

2010-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-read-int-interactive): Make it work for XEmacs
	(note: `?<' is not `eq' to `60' in XEmacs, for example).

2010-09-06  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el (w3m-linknum-remove-overlays): Simplified.
	(w3m-link-numbering-mode): Using `or' instead of `unless'.
	(w3m-read-int-interactive): Added ability to scroll page while
	selecting number.

2010-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url): Move cursor to place where a user likely
	begins to edit.

2010-09-02  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el (texinfo-multitable-widths): Use `make-char'
	instead of KANJI literal.

2010-08-24  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el (texinfo-format-verb): Use (delete-char -1)
	instead of (delete-backward-char 1); For Emacs24.

2010-08-20  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-entity-table): Reverte last change.
	(w3m-extra-numeric-character-reference): New variable.
	(w3m-entity-value): Use it.

2010-08-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* octet.el (octet-find-file)
	* w3m-form.el (w3m-fontify-textareas, w3m-form-replace)
	* w3m-proc.el (w3m-process-filter)
	* w3m-session.el (w3m-session-select-list-all-sessions)
	(w3m-session-select-list-session-group, w3m-session-select-next)
	* w3m.el (w3m-idle-images-show, w3m-toggle-inline-images-internal)
	(w3m-resize-inline-image-internal, w3m-fontify, w3m-refontify-anchor)
	(w3m-cache-remove-oldest, w3m-cache-remove, w3m-cache-contents)
	(w3m-cache-request-contents, w3m-create-text-page)
	(w3m-create-image-page, w3m-select-buffer-generate-contents)
	(w3m-select-buffer-recheck): Replace let-bindings of buffer-read-only
	to nil with inhibit-read-only to t.

2010-08-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Fix `google news' url forms
	used to non-Japanese utf-8 environments.

	* w3m.el (w3m-entity-table): Add table for "&#149;".
	(w3m-entity-value): Prefer "&#NUM;" type entities specified in
	w3m-entity-table.

2010-08-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-safe-view-this-url): Never query "Are you sure..." if
	prefix arg is given.

2010-08-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-create-text-page): Make point and window start be the
	start of contents, especially for text/plain pages.

2010-08-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Update regexps for Google.

2010-07-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Autoload w3m-bookmark-add.

	* w3m-lnum.el (w3m-read-int-interactive): Ignore mouse event in XEmacs.

2010-07-29  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m.el (autoload, w3m-linknum-map):
	`w3m-linknum-bookmark-add-this-url', `w3m-linknum-zoom-in-image'
	and `w3m-linknum-zoom-out-image' added.

	* w3m-lnum.el (w3m-link-numbering-mode-map):
	`w3m-linknum-bookmark-add-this-url', `w3m-linknum-zoom-in-image'
	and `w3m-linknum-zoom-out-image' added.
	(w3m-link-numbering-mode, w3m-with-linknum)
	(w3m-linknum-get-action): Use `zerop'.
	(w3m-link-numbering): Simplify argument list and checks assosiated
	with it.
	(w3m-read-int-interactive): Add <escape> for quit.
	(w3m-linknum-follow): Add position to history when visiting url in
	curent page.  Change message when no valid anchor is selected.
	(w3m-linknum-view-image, w3m-linknum-save-image): Rewrite using
	`cond'.
	(w3m-linknum-zoom-image): New macro.
	(w3m-linknum-zoom-in-image, w3m-linknum-zoom-out-image)
	(w3m-linknum-bookmark-add-this-url): New functions.

2010-07-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-auto-show): Guard error if this-command is not a symbol.
	Thanks to IRIE Shinsuke san. cf. [emacs-w3m:11282]

2010-07-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Save positions iff called interactively.
	(w3m-goto-url-new-session): Save positions.

	* w3m-bookmark.el (w3m-bookmark-view): Save positions.

	* w3m-hist.el (w3m-history-copy): Copy positions.

2010-07-13  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el (w3m-link-numbering-mode): Using `buffer-list' instead of
	`w3m-list-buffers' as the latter does unnecessary stuff.
	(w3m-linknum-read-url): Removed. It's now equivalent to:
	(car (w3m-linknum-get-action prompt 1))
	(w3m-linknum-toggle-inline-image): If no url under selected image,
	move over it and toggle it.
	(w3m-linknum-external-view-this-url, w3m-linknum-edit-this-url):
	Using `w3m-linknum-get-action' instead of `w3m-linknum-read-url'.

	* w3m.el (autoload): Added `w3m-link-numbering-mode', removed
	`w3m-linknum-read-url'.

2010-07-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el (w3m-linknum-minibuffer-prompt): Make face config valid
	for XEmacs as well.
	(w3m-linknum-match): New face.
	(w3m-read-int-interactive): Make it work for XEmacs as well.
	(w3m-highlight-numbered-anchor): Use w3m-linknum-match face.

2010-07-12  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el: Updated commentary and usage sections.
	(w3m-substitute-key-definitions): New macro.
	(w3m-link-numbering-mode-map): Changed keybindings.
	(w3m-link-numbering-mode): Added mode-line indicator. Don't
	activate numbering overlays. Changing status mode causes all other
	w3m buffers to change status as well.
	(w3m-move-numbered-anchor): Removed.
	(w3m-with-linknum): Numbering overlays should never be active
	before invoking linknum functions thus less bookkeeping.
	(w3m-go-to-linknum, w3m-linknum-follow): Add mark for previous
	position.

2010-07-09  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-lnum.el (w3m-read-int-interactive): Add keys to exit event loop,
	C-m & C-j.

2010-07-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-ctl-c-map, w3m-redisplay-map)
	(w3m-linknum-map): New sub-keymaps.
	(w3m-lynx-like-map, w3m-info-like-map): Move `C-c' prefixed commands
	and `C' prefixed commands to w3m-ctl-c-map and w3m-redisplay-map
	respectively.

2010-07-09  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m.el: Autoload w3m-linknum-follow, w3m-linknum-read-url,
	w3m-linknum-toggle-inline-image, w3m-linknum-view-image,
	w3m-linknum-external-view-this-url, w3m-linknum-edit-this-url,
	w3m-linknum-print-this-url, w3m-linknum-download-this-url.

	* w3m-lnum.el: Update usage comment.
	(w3m-link-numbering-mode): Cosmetic change.
	(w3m-get-anchor-info): Added w3m-image-alt char property to return
	list.
	(w3m-go-to-linknum, w3m-linknum-get-action): On 0 input select
	location url.
	(w3m-linknum-follow): Changed prompt and using w3m-message.
	(w3m-linknum-toggle-inline-image): Renamed from
	w3m-linknum-toggle-image and using w3m-message.  When image on
	point, toggle it.
	(w3m-linknum-view-image, w3m-linknum-save-image)
	(w3m-linknum-external-view-this-url)
	(w3m-linknum-edit-this-url, w3m-linknum-print-this-url)
	(w3m-linknum-download-this-url): New commands.

2010-07-08  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el: Update usage comment.
	(w3m-linknum-minibuffer-prompt): New face.
	(w3m-linknum-remove-overlays): Quit immediately when it finds and
	deletes temporary match overlay.
	(w3m-link-numbering-mode): Pass prefix arg, which makes this function
	index only images if it is 2, to w3m-link-numbering. Remove
	interactive declaration and autoload cookie.
	(w3m-link-numbering, w3m-with-linknum): Vary function according to arg;
	index only images if it is 2.
	(w3m-read-int-interactive): Change prompt face to
	w3m-linknum-minibuffer-prompt.
	(w3m-highlight-numbered-anchor): Use next-single-property-change.
	(w3m-get-anchor-info): New function. Renamed from
	w3m-get-numbered-url. Using macrolet for less clutter.
	(w3m-go-to-linknum): Rewrote it more in style with the other
	user commands.
	(w3m-linknum-get-action): Added optional type argument to
	determine numbering scheme.
	(w3m-linknum-follow): Rewrite to use the new
	w3m-linknum-get-action return format.
	(w3m-linknum-read-url): Rewrite using w3m-linknum-get-action.
	(w3m-linknum-toggle-image): New function.

2010-07-06  Andrey Kotlarski  <m00naticus@gmail.com>

	* w3m-lnum.el: Update usage comment.
	(w3m-linknum-remove-overlays): New function.
	(w3m-link-numbering-mode): Turn mode off if prefix arg is 0;
	index forms as well as url links if prefix arg is 4.
	(w3m-link-numbering): Index forms as well if prefix arg is given.
	(w3m-move-numbered-anchor): Fix grammar in error message.
	(w3m-read-int-interactive): New function.
	(w3m-with-linknum): New macro.
	(w3m-highlight-numbered-anchor, w3m-get-numbered-url): New functions.
	(w3m-go-to-linknum): Add autoload cookie; turn on form numbers as well;
	don't highlight current link if prefix arg is given.
	(w3m-linknum-get-action, w3m-linknum-follow, w3m-linknum-read-url): New
	functions.

2010-06-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toggle-inline-image)
	(w3m-toggle-inline-images): Fix query logic about safe url.

2010-06-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-menubar): Add w3m-pipe-source.
	(w3m-lynx-like-map, w3m-info-like-map): Bind "|" to w3m-pipe-source.
	(w3m-pipe-source): New command.

2010-06-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-update-files-autoloads): Strip subdirectory name
	that Emacs 24 doesn't strip from load-name.

2010-06-03  Hideyuki SHIRAI  <shirai@meadowy.org>

	* octet.el (octet-w3m-region): Set to unibyte string for base64
	encoding.

2010-05-24  Fedor Khod'kov  <fedor76@istra.ru>

	* w3m-cookie.el (w3m-cookie-trusted-host-p): Don't bother to add
	excessive "$" to a regexp that w3m-cookie-reject-domains specifies.

2010-05-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Update regexps for Google.

2010-04-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-previous-page): Save positions.

2010-03-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify-images): Use the identical Lisp object for a
	string used as w3m-image's property in order to enable XEmacs to
	display images in shimbun articles properly.

2010-03-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-active-region-or-url-at-point): Check availability of
	w3m-current-url.

2010-03-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-ems-create-image): New function that's an alias to
	create-animated-image or create-image.
	(w3m-create-image): Use it.

	* w3m.el (w3m-emacs-w3m-icon): Replace it with data not optimized.

2010-03-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_PATH_EMACS): Support Emacs 24.
	(AC_ADD_LOAD_PATH): Pipe stderr to /dev/null when running
	w3mhack-print-status.

2010-03-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-ignored-image-url-regexp): Fix custom type.

2010-03-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url-1): Don't recenter if page is not changed.
	(w3m-goto-url): Don't move point to the top unless redisplaying page.

2010-03-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Suppress compiler warnings that Emacs<22.2 and XEmacs issue
	against image-mode functions.

2010-03-02  Naohiro Aota  <naota@elisp.net>

	* w3m.el (top): Require image-mode if available.
	(w3m-image-page-displayed-p): New function.
	(w3m-create-image-page): Setup image-mode's variable if possible.
	(w3m-scroll-up-or-next-url, w3m-scroll-down-or-previous-url)
	(w3m-shift-left, w3m-shift-right, w3m-beginning-of-line)
	(w3m-end-of-line): Call image-mode functions if possible and needed.

2010-02-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Turn truncate-lines off for text/plain pages.

2010-02-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify-images): Add menu to images.
	(w3m-download-this-image, w3m-print-this-image-url): New functions.
	(w3m-link-menu): Add them; enable menu only when url or image is there.

2010-02-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-window-hscroll): Revert 2010-01-13 change.

2010-02-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-cache-available-p): Now, pages with neither Last-Modified
	header and ETag header are treated as dynamically-generated pages.
	(w3m-cache-header-delete-variable-part): Contination lines are also
	removed.

2010-02-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-local-dirlist-cgi, w3m-set-display-ins-del):
	Honor w3m-command-environment.
	Suggested by Toru TSUNEYOSHI <t_tuneyosi@hotmail.com>.

2010-02-01  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-redisplay-this-page): Save positions.

2010-02-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-reload-this-page): Save positions.

	* w3m-hist.el (w3m-history-store-position)
	(w3m-history-restore-position): Use line number and column number to
	save positions.

2010-01-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-previous-page): Restore positions as well when
	jumping within a page.
	(w3m-view-this-url-1): Reset hscroll after retrieving a new page.
	(w3m-view-this-url): Save positions first.
	(w3m-delete-buffer): Restore positions in a page being left.
	(w3m-goto-url): Don't save positions here.

	* w3m-util.el (w3m-popup-buffer): Restore positions only when buffer to
	be displayed is hidden, not always.

2010-01-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-next-anchor, w3m-previous-anchor, w3m-next-form)
	(w3m-previous-form, w3m-next-image, w3m-previous-image): Remove unused
	var `st'.

2010-01-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Make it work as before for group: urls.

2010-01-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-doc-view-map): New variable.
	(w3m-view-this-url-1): Improve the way to keep the window configuration
	for the case where w3m-new-session-in-background is non-nil.
	(w3m-doc-view): Use w3m-doc-view-map.
	(w3m-doc-view-quit): New function.

2010-01-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug)
	* w3m-session.el (w3m-session-save, w3m-session-automatic-save)
	(w3m-session-deleted-save, w3m-session-crash-recovery-save)
	* w3m.el (w3m-key-binding): Use save-current-buffer instead of
	save-excursion.

	* mew-w3m.el (mew-w3m-view-inline-image, mew-mime-text/html-w3m)
	* w3m-xmas.el (w3m-window-hscroll)
	* w3mhack.el (toplevel, w3mhack-generate-load-file): Use
	with-current-buffer rather than save-excursion + set-buffer.

	* w3m-cookie.el (w3m-cookie-parse-args): Use with-current-buffer rather
	than save-excursion + set-buffer; no need to use save-restriction and
	narrow-to-region; remove duplicate set-syntax-table.

2010-01-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-print-this-url): Exclude empty image-alt string.

	* w3m-form.el (w3m-form-parse-and-fontify): Strip text props from
	string elements contained in w3m-current-forms so as to enable XEmacs
	to read ~/.w3m/.sessions file.

2010-01-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-refontify-anchor, w3m-cache-setup)
	(w3m-cache-remove-oldest, w3m-cache-remove, w3m-cache-contents)
	(w3m-cache-request-contents, w3m-view-this-url-1)
	(w3m-download-this-url, w3m-goto-url)
	* w3m-session.el (w3m-session-save)
	* w3m-bookmark.el (w3m-bookmark-sections, w3m-bookmark-write-file)
	(w3m-bookmark-kill-entries, w3m-bookmark-undo, w3m-bookmark-iterator)
	* w3m-util.el (w3m-unseen-buffer-p): Use with-current-buffer rather
	than save-excursion + set-buffer.

	* w3m.el (toplevel, w3m-highlight-current-anchor-1): Use point-at-eol
	rather than `(save-excursion (end-of-line) (point))'.

	* w3m-util.el: Autoload w3m-history-restore-position when compiling;
	autoload w3m-fb-frame-parameter only when compiling.

2010-01-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-next-buffer): Save and restore positions.
	(w3m-close-window): Save positions.

	* w3m-hist.el (w3m-history-store-position)
	(w3m-history-restore-position): Save and restore hscroll.

	* w3m-util.el (w3m-popup-buffer): Restore positions.

2009-11-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-check-rss): Ignore future entries to
	display site announcements.

2009-11-03  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-region-cite-mark): Add new selection.
	(mew-w3m-region): Rewrite.

2009-11-02  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-region-cite-mark): New option.
	(mew-w3m-region): New function.
	(mew-mime-text/html-w3m): Use `mew-w3m-region' instead of `w3m-region'.

2009-09-02  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-image.el (w3m-imagick-convert-program-available-p): If someone
	set `w3m-imagick-convert-program' to nil before load emacs-w3m, do not
	show warning message for ImageMagick's `convert'.

2009-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-mail.el (w3m-mail-embed-base-url, w3m-mail-compose-with-mml)
	(w3m-mail-compose-with-vm): Don't use
	default-enable-multibyte-characters that is obsolete in Emacs 23.2.

2009-09-01  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-content-type-alist): Support
	`browse-url-default-windows|macosx-browser'. Thanks to Leo.
	Cf. [emacs-w3m:11035].

	* w3m-ems.el (w3m-form-button, w3m-form-button-mouse)
	(w3m-form-button-pressed, w3m-tab-unselected)
	(w3m-tab-unselected-retrieving, w3m-tab-unselected-unseen)
	(w3m-tab-selected, w3m-tab-selected-retrieving, w3m-tab-background)
	(w3m-tab-selected-background, w3m-tab-mouse): Add type ns. Thanks to
	Leo. Cf. [emacs-w3m:11034].

2009-08-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-toggle-inline-images-internal): Do not display image, if
	its url is local and current url is not local.

2009-08-24  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-output-coding-system): Use `utf-8' except for emacs-21
	under Japaese environment.

2009-08-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-use-symbol): Set nil with emacs-23 or later.
	cf. [emacs-w3m:11002].

2009-08-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-util.el (w3m-puny-decode-url): Decode the part of hostname only.
	Add doc-strings.
	(w3m-puny-encode-url): Add doc-strings.

2009-08-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-puny-utf-16be): New variable.
	(w3m-url-readable-string): Call `w3m-puny-decode-url'.
	(w3m-url-transfer-encode-string): Call `w3m-puny-encode-url'.
	(w3m-header-line-insert): Call `w3m-puny-decode-url'.
	(w3m-input-url): Call `w3m-puny-decode-url' for initial URL.

	* w3m-util.el (top): Add the variable definition of `w3m-puny-utf-16be'
	to avoid byte-compile warnings.
	(w3m-puny-code-regex, w3m-puny-code-nonascii, w3m-puny-base)
	(w3m-puny-tmin, w3m-puny-tmax, w3m-puny-damp, w3m-puny-skew)
	(w3m-puny-initial-bias, w3m-puny-initial-n, w3m-puny-delimiter): New
	constants.
	(w3m-puny-adapt, w3m-puny-decode-digit, w3m-puny-encode-digit)
	(w3m-puny-decode1, w3m-puny-decode, w3m-puny-decode-url)
	(w3m-puny-encode1, w3m-puny-encode, w3m-puny-encode-url): New
	functions.

2009-08-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-decode-anchor-string): Convert contol-characters to
	space.

2009-07-17  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-about-retrieve): When type is `nil', decode cached
	contents to display source of 404 page.  Reported by Dan Jacobson
	<jidanni@jidanni.org>.
	(w3m-do-cleanup-temp-files): New customize variable.
	(w3m-cleanup-temp-files): Use it.
	(toplevel): Call it when emacs-w3m shutdown.

2009-07-04  Naohiro Aota  <naota@elisp.net>

	* w3m-search.el (w3m-search-thing-at-point-arg): New variable.
	(w3m-search-read-query): Use it.

	* w3m-util.el (w3m-current-title): Set title to "<retrieving>>" when
	w3m is retrieving a page.

2009-06-13  Kevin Ryde  <user42@zip.com.au>

	* w3m.el (w3m-view-recenter): Only nil,t,integer, not a cons.
	(w3m-search-name-anchor, w3m-view-this-url-1): No arg to w3m-recenter.
	(w3m-next-anchor, w3m-previous-anchor, w3m-next-form,
	w3m-previous-form, w3m-next-image, w3m-previous-image): Don't
	recenter, leave recentering just for following a link, not Tab etc
	within the buffer.
	(w3m-recenter): Remove NAME arg, believe don't need to differentiate
	URLs with an anchor or not since with no anchor `point' is at the
	start of the buffer and can't be recentered anyway.
	Use C-u style "(recenter '(4))" for the `t' middle-of-screen case.
	No need for code to avoid redisplay, `recenter' doesn't redisplay in
	the integer or C-u cases.

2009-06-13  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-fontify-anchors): Decode entities of name anchor.

2009-05-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-cache-available-p): Analyze the cache-control header more
	strictly.
	(w3m-scroll-up-or-next-url): Bind w3m-prefer-cache to `t' when goto
	the w3m-next-url.
	(w3m-scroll-down-or-previous-url): Bind w3m-prefer-cache to `t' when
	goto the w3m-previous-url.

2009-05-23  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-reload-this-page): Add new argument `no-popup'; Call
	w3m-goto-url() with the argument.
	(w3m-goto-url-with-timer): Use it.

2009-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-bookmark-make-item)
	* w3m-cookie.el (w3m-cookie-create)
	* w3m-dtree.el (w3m-dtree-expand-file-name, w3m-dtree-directory-name)
	* w3m-form.el (w3m-form-normalize-action, w3m-form-p)
	(w3m-form-set-method, w3m-form-put-property, w3m-form-field-parse)
	(w3m-form-real-reset)
	* w3m-hist.el (w3m-history-set-current)
	* w3m-namazu.el (w3m-namazu-call-process)
	* w3m-proc.el (w3m-process-p, w3m-process-kill-process)
	(w3m-process-error-handler)
	* w3m-session.el (w3m-session-history-to-save, w3m-session-make-item)
	* w3m-tabmenu.el (w3m-tab-menubar-make-items-1)
	* w3m-util.el (w3m-get-buffer-create, w3m-kill-buffer)
	(w3m-current-title, w3m-buffer-title, w3m-buffer-number)
	(w3m-buffer-set-number, w3m-buffer-name-add-title)
	(w3m-generate-new-buffer, w3m-lefttab-exist-p, w3m-righttab-exist-p)
	(w3m-url-valid, w3m-time-newer-p, w3m-time-lapse-seconds)
	(w3m-url-local-p, w3m-url-authinfo, w3m-url-strip-authinfo)
	(w3m-url-strip-fragment, w3m-url-strip-query, w3m-which-command)
	(w3m-assoc-ignore-case, w3m-unseen-buffer-p)
	* w3m-xmas.el (w3m-make-glyph)
	* w3m.el (w3m-clear-local-variables, w3m-copy-local-variables)
	(w3m-arrived-p, w3m-arrived-put, w3m-arrived-get)
	(w3m-url-transfer-encode-string, w3m-entity-value)
	(w3m-decode-anchor-string, w3m-toggle-inline-images-internal)
	(w3m-canonicalize-url, w3m-cache-header-delete-variable-part)
	(w3m-w3m-canonicalize-url, w3m-view-this-url-1)
	* mime-w3m.el (mime-w3m-setup): Don't use defsubst.

	* w3m-hist.el (w3m-history-plist-put, w3m-history-remove-properties):
	Don't inline w3m-history-add-properties.

2009-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-cache-available-p): Work around too large integer in
	Cache-Control header.

2009-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-to-file-name): Fix regexp used for stripping
	localhost part; make url a Tramp name if it is guessed.

2009-04-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-to-file-name): Allow "file:/foo.html" in addition to
	"file://foo.html" and "file:///foo.html".

2009-04-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-bookmark-buffer): Use the time 0 as modtime of
	the bookmark buffer by default.

2009-04-22  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-this-url-1): Pass url to sentinel.
	(w3m-recenter): Save excursion.

2009-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-recenter): New user option.
	(w3m-recenter): New function.
	(w3m-search-name-anchor, w3m-view-this-url-1, w3m-next-anchor)
	(w3m-previous-anchor, w3m-next-form, w3m-previous-form, w3m-next-image)
	(w3m-previous-image): Use it.

2009-04-20  Kevin Ryde  <user42@zip.com.au>

	* w3m.el (w3m-local-find-file-regexps): Make regexp-opt group regexps
	explicitly.

2009-04-14  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-cache-available-p): The control of expire is added.
	(w3m-w3m-retrieve-1): The case where the option "no_cache=1" is put has
	been increased.

2009-04-12  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-select-buffer-delete-buffer, w3m-goto-url)
	(w3m-delete-buffers): Unqueue image retrieving process manually.
	(w3m-idle-images-show): Widen narrowing.

	* w3m-proc.el (w3m-process-stop): Don't unqueue image retrieving
	process.

	* w3m.el (w3m-message-silent): New variable.
	(w3m-message): Use it: when the variable is `t', don't show a message.
	(w3m-idle-images-show): Use it.
	(w3m-w3m-dump-head): lexical-let it.
	(w3m-w3m-dump-extra): Ditto.
	(w3m-w3m-retrieve): Ditto.
	(w3m-retrieve-and-render): Ditto.
	(w3m-refresh-minimum-interval): New variable.
	(w3m-check-refresh-attribute): Use it.
	(w3m-view-previous-page): When visiting pages by history-back or
	history-next, don't just ignore refresh, but wait for a while.
	(w3m-idle-images-show): When there are events pended, re-create the
	idle timer; Check current position's item every time loop starts.
	(w3m-idle-images-show-unqueue): Set w3m-idle-images-show-timer
	properly.
	(w3m-arrived-add): Revert recent changes.

	* w3m-favicon.el (w3m-favicon-retrieve): lexical-let w3m-message-silent.

2009-04-02  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-arrived-add): If url has a multi-byte character, do not
	do recursive-call itself. If decoded url does not have a multi-byte
	character, do not do recursive-call itself.

2009-03-28  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-goto-url-with-timer): When going to the same url, use
	`w3m-reload-this-page'.
	(w3m-image-no-idle-timer): New variable.
	(w3m-toggle-inline-images-internal): Use it.
	(w3m-arrived-add): Add also decoded url.
	(w3m-goto-url): Restore forms also when url is local.

2009-03-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-link-menu): Always provide title string.  Suggested by
	David Abrahams <dave@boostpro.com>.
	cf. <http://emacs-w3m.namazu.org/ml/msg10658.html>.

2009-03-17  Victor Ren  <victor.ren@ericsson.com>

	* w3m.el (w3m-url-to-file-name): Support "file://c:/" in addition to
	"file:///c:/".

2009-03-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-w3m-parse-header): The value of w3m-document-charset is
	not used excluding x-moe-internal.

2009-03-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-decode-buffer): If context-charset is x-moe-internal,
	x-moe-internal is used as charset regardless of w3m-type.
	(w3m-w3m-parse-header): Add w3m-document-charset to handle of the
	headers. If w3m-document-charset is x-moe-internal, charset sets to
	x-moe-internal compulsorily. If x-w3m-content-encoding is exist, the
	value of x-w3m-content-encoding is used as encoding method regardless
	of w3m-type.

2009-03-03  Naohiro Aota  <naota@elisp.net>

	* w3m-hist.el (w3m-history-slimmed-history-flat, w3m-history-slim): New
	functions.

	* w3m-session.el (w3m-session-history-to-save): Use it.

2009-02-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Require w3m-session instead of autoloading it.

	* w3m-session.el: Don't require w3m; require w3m-util; silent warnings.
	(w3m-session-select): Use w3m-get-buffer-create instead of
	get-buffer-create to kill the session select buffer when quitting.

	* w3m-util.el (w3m-delete-frames-and-windows): Delete frames if the
	other windows visit buffers being related to emacs-w3m or the session
	select buffer.
	(w3m-replace-in-string): eval-and-compile.

2009-02-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Autoload w3m-go-to-linknum.
	(w3m-lynx-like-map, w3m-info-like-map): Bind `C-c C-l' to it.
	(w3m-mode): Mention w3m-go-to-linknum in doc string.

	* w3m-util.el (w3m-read-number): New function.

	* w3m-lnum.el (w3m-go-to-linknum): Use w3m-read-number.

2008-04-12  Jose A. Ortega Ruiz  <jao@gnu.org>

	* w3m-lnum.el (w3m-go-to-linknum): New function.

2009-02-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-session.el (w3m-session-ignore-errors): New macro.
	(w3m-session-save, w3m-session-automatic-save)
	(w3m-session-deleted-save, w3m-session-crash-recovery-save)
	(w3m-session-crash-recovery-remove, w3m-session-select-mode)
	(w3m-session-select, w3m-session-make-menu-items)
	(w3m-session-last-autosave-session, w3m-session-last-crashed-session):
	Use it.

	(toplevel): Require cl when compiling.
	(w3m-session-crash-recovery-save)
	(w3m-session-select-list-all-sessions): Remove unused variables.

2009-02-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-session.el (w3m-session-last-crashed-session): Fix tiny typo.

2009-02-15  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-idle-images-show): If detect deleted buffer, unqueue
	processes related to the buffer.

	* w3m-session.el (w3m-session-crash-recovery): Change the default to t.

2009-02-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-buffer-setup): Add keymap that cycles buffers as usual to
	mode-line-buffer-identification.

2009-02-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-bookmark-view, w3m-bookmark-view-new-session)
	(w3m-bookmark-make-menu-items): Check if bookmark file exists.

2009-02-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-header-line-insert): Don't decode url containing
	non-ASCII characters already.  e.g. about://weather/WHERE

2009-02-03  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-cid-retrieve): Remove a wrong set-buffer().

2009-02-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-input-url): Offer decoded url in the minibuffer.
	(w3m-copy-buffer): Copy w3m-current-coding-system.
	(w3m-header-line-insert): Display decoded url.

2009-02-02  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-idle-images-show): Change the order of image retrieving.
	(w3m-toggle-inline-images-internal): Use `w3m-idle-image-item'
	text-property.
	(w3m-goto-url): Add new argument `no-popup'.
	(w3m-goto-url-with-timer): Call w3m-goto-url with `no-popup' nil.

2009-02-01  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-toggle-inline-images-internal): Add new argument
	`safe-regexp'.
	(w3m-toggle-inline-images): Pass `safe-regexp' to
	w3m-toggle-inline-images-internal when called non-interactively.

2009-01-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el: Autoload w3m-idle-images-show-unqueue when compiling.

2009-01-27  Naohiro Aota  <naota@elisp.net>

	* w3m-proc.el (w3m-process-stop): Call `w3m-idle-images-show-unqueue'.

	* w3m.el (w3m-idle-images-show-timer, w3m-idle-images-show-list)
	(w3m-idle-images-show-interval): New variables.
	(w3m-idle-images-show, w3m-idle-images-show-unqueue): New functions.
	(w3m-toggle-inline-images-internal): Use them.

2009-01-26  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-content-type-alist): Add "application/x-pdf" content
	type.

2009-01-21  Kevin Ryde  <user42@zip.com.au>

	* w3m.el (w3m-search-name-anchor): Return true meaning "found" if
	point is already at the anchor position.

2009-01-21  Naohiro Aota  <naota@elisp.net>

	* w3m-session.el (w3m-session-last-autosave-session): Check if
	autosaved sessions set exists before asking whether to load the last
	sessions set; Search older sessions sets when the last sessions set
	doesn't exist (maybe it is removed by user); Load autosaved sessions
	set when w3m-session-load-last-sessions is non-nil.
	(w3m-session-load-last-sessions): Fix docstring; Change `auto' to `t'.
	(w3m-session-crash-recovery-title): New variable.
	(w3m-session-load-crashed-sessions): Ditto.
	(w3m-session-crash-recovery-save): New function.

	* w3m.el (w3m-goto-url): Save sessions set for crash recovering.
	(w3m-delete-buffer): Ditto.
	(w3m): Load crashed sessions if necessary.  Suggested by Samuel Wales
	<samologist@gmail.com>.

2009-01-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Use new `w3m-balloon-help'
	text-property for balloon help.
	(w3m-fontify-images): Ditto and create help together href, alt and URL
	of image.

2009-01-19  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-image-anchor): Fix docstring.
	(toplevel): Fix w3m-image-anchor-face's alias.

2009-01-15  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-images): Put the 'full alt text' on new
	'w3m-image-alt' property.
	(w3m-print-this-url): Print the content of 'w3m-image-alt'.

	* w3m-util.el (w3m-image-alt): New macro.

2009-01-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/Makefile.in (.texi.info): Use --no-split.

2009-01-11  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m): Move last session restoring asking afterward, so that
	the restoring wouldn't be avoided by w3m-input-url's input.

	* w3m-session.el (w3m-session-last-autosave-session): Follow the above
	change.

2009-01-10  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m): Check whether to load the last autosaved
	sessions.  Suggested by Samuel Wales <samologist@gmail.com>.

	* w3m-session.el (w3m-session-automatic-keep-number): New variable.
	Suggested by Samuel Wales <samologist@gmail.com>.
	(w3m-session-automatic-save): Use it.
	(w3m-session-last-autosave-session): New function.
	(w3m-session-load-last-sessions): New variable.

	* w3m.el (w3m-image-anchor): New face.
	(w3m-fontify-images): Use it.

2009-01-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-language): Allow the value like "Japanese (UTF-8)" of
	current-language-environment.

	* w3m-symbol.el (w3m-symbol): Ditto.

	* w3mhack.el (w3mhack-makeinfo): Use locale-coding-system for Emacs to
	encode Japanese messages.

2009-01-09  Naohiro Aota  <naota@elisp.net>

	* w3m.el (w3m-create-text-page, w3m-goto-url): Check if the url is
	arrived before getting real-url.

2009-01-06  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (top): Add the variable definitions of
	`w3m-tab-menubar-make-items-preitems' and `w3m-session-menu-items-pre'
	to avoid byte-compile warnings.
	(w3m-setup-menu): Move the postion of session menu.
	(w3m-mouse-major-mode-menu): Add session menu.

	* w3m-xmas.el (autoload): Add w3m-setup-session-menu.
	(w3m-menu-on-forefront): Treat "Session" menu.
	(w3m-setup-menu): Call `w3m-setup-session-menu'.

2008-12-30  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-select-buffer-mode-map): Bind `w3m-select-buffer-quit' to
	C-g.

	* w3m-session.el (w3m-session-select-mode-map): Bind
	`w3m-session-select-quit' to C-g.

	* w3m-form.el (w3m-form-input-select-keymap): Bind
	`w3m-form-input-select-keymap' to C-g.
	(w3m-form-input-map-keymap): Bind `w3m-form-input-map-exit' to C-g.

2008-12-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-session.el (w3m-session-select-mode-map): Add new key.
	(w3m-session-select-mode): Modify doc-string.
	(w3m-session-select-rename): New command.
	(w3m-session-rename): New function.

2008-12-17  Naohiro Aota  <naota@elisp.net>

	* w3m.el (autoload): Add w3m-setup-session-menu.
	(w3m-menubar): Moved session menu to w3m-session-menu-items.
	(top): Call w3m-setup-session-menu.

	* w3m-session.el: Change to use major mode; Add session menu.
	(w3m-session-unknown-title): New option.

2008-12-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-compatible-encoding-alist): Add (gb2312 . gbk).

2008-12-12  David Engster  <dengste@eml.cc>

	* w3m-proc.el (w3m-process-wait-process): Reduce sit-for time.
	(w3m-process-sentinel): Wait for process output (on Emacs only).

2008-12-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-redirection-error-information): Improve the
	error message.

2008-12-10  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-next-anchor): Go to the first anchor when next
	anchor is not found.
	(w3m-previous-anchor): Go to the last anchor when previous anchor
	is not found.
	(w3m-url-encode-string): Encode SPC only when encode-space is
	non-nil.

	* w3m-form.el (w3m-form-make-form-data): Follow the above change.

	* w3m.el (w3m-gmane-url-at-point): Ditto.
	(w3m-canonicalize-url): Ditto.

2008-12-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-make-ccl-coding-system): Use define-coding-system if
	it is available.

2008-12-06  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-show-redirection-error-information): New function.
	(w3m-retrieve-and-render): Use it.
	(w3m-w3m-retrieve-1): Return 'redirection-exceeded if redirect counter
	exceeded.
	(w3m-w3m-retrieve): Return "X-w3m-error/redirection" if attr eq
	'redirection-exceeded.
	(w3m-w3m-attributes-1): Return dummy attribute if redirect counter
	exceeded.

2008-12-05  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-same-window-p): New function.
	(w3m-form-input-textarea): Use it.

	* w3m.el (w3m-local-find-file-regexps): Try to open with emacs-w3m as
	many types as possible.

2008-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify): Remove hidden anchors like "<a href=url> </a>".
	cf. [emacs-w3m:10484]

2008-12-01  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-input-textarea): Use the whole current window
	for the textarea when `same-window-buffer-names' contains the buffer
	name "*w3m form textarea*"; simplify the window size calculation.

2008-11-21  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-w3m-parse-header): Also remove parameters when charset is
	specified.

2008-11-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-visited-file-modtime): New function.

	* w3m-bookmark.el (w3m-bookmark-file-modtime): Just return result of
	file-attributes().

2008-11-11  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-antenna.el (w3m-antenna-check-rss): Support RSS2.0. Check also
	items.
	(w3m-antenna-alist): Update site-class if needed.

	* w3m-bookmark.el (w3m-bookmark-buffer, w3m-bookmark-verify-modtime):
	Replace visited-file-modtime with w3m-visited-file-modtime.

2008-10-28  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-view-header): Check if current page is source of
	about:something.

2008-10-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-active-region-or-url-at-point): Take notice of the link
	under the point as well; return the url of the current page by default
	if the new optional argument `default=current' is given.
	(w3m-input-url): Make w3m-active-region-or-url-at-point return the url
	of the current page by default; modify the prompt string according to
	whether there is an initial input.
	(w3m-download, w3m-goto-url, w3m-goto-url-new-session): Simplify args
	passed to w3m-input-url.
	(w3m-view-this-url): Make w3m-active-region-or-url-at-point return the
	url of the current page by default.

2008-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-italic): Make it be a underline face on a non-window
	system by default.

2008-09-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toggle-inline-images-internal)
	(w3m-resize-inline-image-internal): Confirm whether to retrieve
	insecure image only once, or don't confirm it if
	w3m-confirm-leaving-secure-page is nil.  Suggested by Dan Jacobson
	<jidanni@jidanni.org>.
	(w3m-confirm-leaving-secure-page): Doc fix.

	* w3mhack.el (w3mhack-makeinfo): Remove Emacs 19 stuff; remove TeX
	directives first; don't call texinfo-mode.

2008-09-21  Akinori MUSHA  <knu@iDaemons.org>

	* doc/emacs-w3m.texi (Image Variables): Fix syntax error.

	* doc/emacs-w3m-ja.texi (Image Variables): Ditto.

2008-09-17  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-buffer-local-url): New constant variable.
	(w3m-buffer-local-url-p): New function.
	(w3m-goto-url): Also process buffer local url.
	(w3m-region): Use w3m-buffer-local-url as url if it is not set.
	(w3m-safe-view-this-url, w3m-mouse-safe-view-this-url): Check if url is
	buffer local.

2008-09-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-download): Add doc string.
	(w3m-lynx-like-map): Bind M-d key to w3m-download.
	(w3m-mode): Add w3m-download to major mode info; clarify description of
	w3m-download-this-url.

2008-09-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-gmane-url-at-point): Return a url used for asking Gmane
	for the thread that begins with the current article instead of the
	whole thread if it is run on the Message-ID header.
	(w3m-examine-command-line-args): Make it an alias to `(lambda nil)'
	instead of `ignore' after it is run for the first time in order to
	silence the byte compiler.

2008-09-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-use-favicon): Assume w3m-image.elc is always loaded.
	(w3m-resize-inline-image-internal): Change it to a normal function from
	an inline function; remove interactive.
	(w3m-zoom-in-image, w3m-zoom-out-image): Error if ImageMagick's convert
	program is not available; improve doc string.
	(w3m-auto-show): Don't make the cursor position disappear after
	executing beginning-of-buffer and end-of-buffer.

2008-08-25  David Hansen  <david.hansen@gmx.net>

	* w3m.el (w3m-about-header): Fixed typo.

2008-08-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-source, w3m-view-header): Save points positioned
	last in pages.  Suggested by Dan Jacobson <jidanni@jidanni.org>.

2008-07-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el: Bind w3m-image-default-background when compiling.

2008-07-20  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-hist.el (w3m-history-restore-position): Run
	w3m-after-cursor-move-hook after restoring cursor position.

2008-07-18  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-image-default-background): New variable.

	* w3m-ems.el (w3m-create-image): Use it.
	(w3m-initialize-graphic-icons): Check if xpm is available.  Reported by
	Diego 'Flameeyes' Petten,Ar(B <flameeyes@gmail.com>.

	* w3m-filter.el (w3m-filter-wikipedia): Improve regexp.

2008-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Test if mule-version is
	bound (XEmacs does not provide it).

2008-06-30  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-input, w3m-form-input-password): Process
	readonly attribute.

2008-06-25  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-toggle-inline-images-internal): Make it non-interactive.

	* w3m-form.el (w3m-form-input-textarea): Make buffer unmodified when
	user selected to reuse saved text; parse readonly attribute; kill newly
	generated buffer when the reusing question aborted.
	(w3m-form-textarea-info): Also provide readonly info.
	(w3m-fontify-textareas): Parse readonly attribute.
	(w3m-form-parse-and-fontify): Ditto.
	(w3m-form-input): Ignore cursor moving while read from minibuffer.
	(w3m-form-input-password): Ditto.
	(w3m-form-input-file): Ditto.

	* w3m.el (w3m-toggle-inline-image): Don't toggle images that are
	outside of the region even if they are identical to the ones in the
	region; don't do recursive call of itself; rearrange the source code.
	(w3m-toggle-inline-images): Check whether images are safe even if it is
	called with w3m-display-inline-images=t and force=t; rearrange the
	source code.
	(w3m-toggle-inline-images-internal): Add new optional argument:
	`begin-pos' and `end-pos'. Only process region from `begin-pos' to
	`end-pos'.

2008-06-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toggle-inline-image): Work for an image in which there is
	the region end within its anchor.  Reported by Dan Jacobson
	<jidanni@jidanni.org>.

	* w3m-util.el (w3m-deactivate-region): Use zmacs-deactivate-region for
	XEmacs.

2008-06-22  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-search.el (w3m-search-engine-alist): Improve detection of utf-8
	capability.
	(w3m-search-engine-alist): Abolish `yahoo beta' entry; Improve `blog'
	entry to work like `google' entry.

	* w3m-session.el: Add coding cookie.

2008-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-submit-form-safety-check): New user option.  Suggested by
	Dan Jacobson <jidanni@jidanni.org>.
	(w3m-submit-form): Use it.

2008-06-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-auto-show): Scrool horizontally after executing a search
	command.

2008-06-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-use-header-line-title): Modify the doc-string.

2008-06-06  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-select-buffer): Don't delete other windows.

	* w3m-filter.el (w3m-filter-wikipedia): New function.
	(w3m-filter-rules): Add w3m-filter-wikipedia.

2008-06-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Add coding cookie.

2008-06-02  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-detect-meta-charset): Use also ';' as delimiter.

2008-05-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-examine-command-line-args): Treat the null string given
	as a url in the command line args as `w3m-home-page' or "about:".

2008-05-28  Naohiro Aota  <nao.aota@gmail.com>

	* doc/emacs-w3m.texi (Inline Images): Update.

	* doc/emacs-w3m-ja.texi (Inline Images): Ditto.

2008-05-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-readable-string): Don't decode url if it looks not to
	have been encoded.
	(w3m-current-longest-line): New variable.
	(w3m-set-current-longest-line): New function.
	(w3m-scroll-left, w3m-shift-left): Don't scroll the window endlessly;
	beep if the window can't be scrolled any more.
	(w3m-scroll-right, w3m-shift-right): Beep if the window can't be
	scrolled any more.

2008-05-25  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-relationship-estimate-rules): Fix regexp for Google
	search within EmacsWiki.

2008-05-20  Naohiro Aota  <nao.aota@gmail.com>

	* README: Add information about how to create `configure' script.

	* README.ja: Ditto.

	* w3m.el (w3m-goto-url): Delayed encoding of fragment part.

2008-05-18  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-cookie.el (w3m-cookie-save-current-site-cookies): New function.
	(w3m-cookie-save): Add optional argument "domain".

2008-05-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-add-text-properties): New inline macro.
	(mew-w3m-view-inline-image): Use `mew-w3m-add-text-properties'.
	(mew-mime-text/html-w3m): Ditto.

2008-05-09  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-cookie.el (w3m-cookie-save): Make it interactive function.
	(w3m-cookie-save-cookies): New variable.
	(w3m-cookie-shutdown): Use it.

	* w3m.el (toplevel): Shutdown cookie system when exiting emacs.

2008-05-08  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-cookie.el (w3m-cookie-shutdown): Fixed docstring.

2008-05-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-amazon): Fix string to search the body.

2008-04-30  Naohiro Aota  <nao.aota@gmail.com>

	* doc/emacs-w3m-ja.texi: Update translation.

	* w3m.el (w3m-goto-url): Use w3m-current-coding-system first to encode
	url if available; Also encode name part when url is local.
	(w3m-ignored-image-url-regexp): New variable.
	(w3m-toggle-inline-images-internal): Don't display image whose url
	match `w3m-ignored-image-url-regexp'.
	(w3m-decode-entities, w3m-decode-entities-string): Replace
	"(match-beginning 2)" with "(match-end 1)" to deal with emacs-21's
	strange behavior.

2008-04-24  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-rules): Support Mixi with SSL.

2008-04-22  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Fix Comments.
	(texinfo-format-geq, texinfo-format-leq,): Support @geq and @leq.

2008-04-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-rules): Add rule for the site of Allatanys.
	(w3m-filter-allatanys): New function.

	* w3m.el (w3m-relationship-estimate-rules): Fix regexp for Google
	search within EmacsWiki. Add rule for Google Mobile Proxy.

2008-04-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (top): Add the variables definition of `w3m-bookmark-mode',
	`w3m-bookmark-menu-items', `w3m-bookmark-menu-items-pre' and
	`w3m-tab-menubar-make-items-preitems' avoid byte-compile warnings.
	(w3m-rmouse-menubar): New user option.
	(w3m-setup-menu): Add the setup of `w3m-rmouse-menubar'.
	(w3m-mouse-major-mode-menu): Rewrite to use `w3m-rmouse-menubar'.
	(w3m-link-menu): Add `w3m-external-view-this-url'.

2008-04-15  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-turnoff-inline-images): New command.
	(w3m-toggle-inline-images): If force is 'turnoff, turn off to display
	images.
	(w3m-menubar): Add w3m-turnoff-inline-images.
	(w3m-lynx-like-map): Ditto.
	(w3m-info-like-map): Ditto.
	(w3m-mode): Ditto.

2008-04-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Fix custom type.

2008-04-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Support Google search
	within EmacsWiki.  cf. [emacs-w3m:10067]

2008-03-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mouse-safe-view-this-url): Remove redundant confirmation
	of whether to follow link.

2008-03-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-doc-view-content-types): New variable.
	(w3m-doc-view): New function.
	(w3m-create-page): Use it.
	(w3m-content-type-alist): Add application/dvi.
	(w3m-delete-buffer): Save windows layout.

2008-03-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-image.el (w3m-imagick-convert-program-available-p): Don't use
	w3m-imagick-convert-data which may issue a warning when checking
	whether the convert program supports png32.  cf. [emacs-w3m:10048]

2008-03-03  Naohiro Aota  <nao.aota@gmail.com>

	* doc/emacs-w3m.texi (Inline Images): Updated.

	* doc/emacs-w3m-ja.texi (Inline Images): Ditto.

	* w3m.el (w3m-toggle-inline-images): Only toggle in the region if
	Transient Mark mode.
	(w3m-toggle-inline-image): Ditto.

2008-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-arrived-intern): Protect against null string.  It enables
	url completion even for null string.  Suggested by Aota-san.

2008-02-07  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-expand-path-name): New function.
	(w3m-expand-url): Remove useless expanded path-name check.

2008-02-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-lisp, install-icons, install-icons30): Quote
	directory name that might contain whitespace.

	* doc/Makefile.in (install): Ditto.

	* aclocal.m4 (AC_PATH_LISPDIR): Ditto; always report prefix name.

	* mkinstalldirs: Replace it with the 2006-05-11.19 version.

2008-01-30  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-fontify-anchors): Don't expand icon's url when it is nil.

2008-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-safe-url-regexp): Add note to doc string.
	(w3m-fontify): Hold the value of w3m-safe-url-regexp with the
	w3m-safe-url-regexp text-property.
	(w3m-toggle-inline-image, w3m-toggle-inline-images)
	(w3m-safe-view-this-url, w3m-mouse-safe-view-this-url): Check whether
	url is safe by comparing it with the value of the w3m-safe-url-regexp
	text property; prompt a user to confirm whether to proceed.
	(w3m-safe-toggle-inline-image, w3m-safe-toggle-inline-images): Abolish.
	(w3m-minor-mode-command-alist): Map w3m-toggle-inline-image and
	w3m-toggle-inline-images to themselves.

2008-01-20  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-search-name-anchor): Accept and optional argument
	`no-record'.
	(w3m-goto-url): Going other page's anchor, call
	`w3m-search-name-anchor' with 3rd argument t.

2008-01-16  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-input-textarea-coding-system): Revert.
	(w3m-form-input-textarea): Set w3m-form-input-textarea-coding-system to
	use in w3m-form-coding-system-accept-region-p.

2008-01-15  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-textarea-file-coding-system): New variable.
	(w3m-form-input-textarea-save): Use it.
	(w3m-form-input-textarea): Ditto.
	(w3m-form-input-textarea-coding-system): Abolish.

2008-01-11  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-filter.el (w3m-filter-iframe): New function.
	(w3m-filter-rules): Add rule for inserting link to the url iframe
	displays.

2008-01-09  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-coding-system-accept-region-p): Abolish.

	* w3m-ems.el (w3m-form-coding-system-accept-region-p): Use
	select-safe-coding-system if unencodable-char-position is not
	available.

	* w3m-xmas.el (w3m-form-coding-system-accept-region-p): Use
	decode-coding-string and encode-coding-string instead of
	unencodable-char-position; Only warn coding-system problem.

2008-01-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-decode-string): Don't replace +'s with spaces.

2007-12-27  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-coding-system-accept-region-p): New function.
	(w3m-form-input-textarea-save, w3m-form-input-textarea-set): Use it.

2007-12-24  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-session.el (w3m-session-goto-session): Go to the current w3m
	buffer in data of session.

2007-12-24  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-session.el (w3m-session-history-to-save): New function.
	(w3m-session-save): Also record history data.
	(w3m-session-automatic-save, w3m-session-deleted-save): Ditto.
	(w3m-session-select): Follow the format change.
	(w3m-session-goto-session): Also restore history data.

2007-12-23  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-tabmenu.el (w3m-tab-menubar-force-update): New function.
	(top): Register `w3m-tab-menubar-force-update' to
	`w3m-display-functions'.

2007-12-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-lynx-like-map): Bind `w3m-move-unseen-buffer'.
	(w3m-info-like-map): Ditto.
	(w3m-buffer-unseen): New buffer local variable.
	(w3m-set-buffer-unseen): New function.
	(w3m-set-buffer-seen): Ditto.
	(w3m-move-unseen-buffer): Ditto.
	(w3m-remove-local-hook): Ditto.
	(w3m-goto-url): Set buffer to unseen.
	(w3m-select-buffer-generate-contents): Support `unseen'.

	* w3m-util.el (top): Add the variable definition of `w3m-buffer-unseen'
	to avoid byte-compile warnings.
	(w3m-unseen-buffer-p): New inline macro.

	* w3m-tabmenu.el (w3m-tab-menubar-make-items-1): Support `unseen'.

	* w3m-ems.el (w3m-remove-local-hook): New function.
	(w3m-tab-unselected-unseen): New face.
	(w3m-tab-line): Support `unseen'.

2007-12-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mode): Set show-trailing-whitespace to nil.

2007-12-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-default-background): New user option.
	(w3m-favicon-set-image): Don't set background color of favicon here.
	(w3m-favicon-convert): Set the background color of favicon according to
	w3m-favicon-default-background.

	* w3m-ems.el (w3m-tab-line): Don't set the background color of favicon
	here.

	* w3m-image.el (w3m-imagick-identify-program): New user option.

2007-12-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-kill-stray-processes): Do not kill
	process when the buffer associated to it is alive.
	(w3m-process-sentinel): Do not call a handler when its parent
	buffer have been killed.

2007-12-15  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-submit): Remove query part from the form's
	action url when using get method.

2007-12-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-size): Change the value form into
	the cons of WIDTH and HEIGHT.
	(w3m-favicon-convert-args): New user option.
	(w3m-favicon-convert): Pass it to convert.

	* w3m-ems.el (w3m-tab-mouse-track-selected-tab): Follow change of
	w3m-favicon-size.

2007-12-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-tab-line): Set the background color of favicon
	for Emacs 22+.

	* w3m-favicon.el (w3m-favicon-set-image): Ditto.

	* w3m-image.el (w3m-imagick-convert-program-available-p): Check
	whether the convert program supports the image type png32 for
	Emacs 22+.
	(w3m-imagick-convert-buffer, w3m-imagick-start-convert-buffer):
	Use png32 if it is available.

2007-12-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-convert): Make last change revert.

2007-12-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-convert): Apply the background color
	of header line or mode line to pixels of which the color is
	transparent.

2007-12-06  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-goto-url): Canonicalize the url when it is called
	non-interactively.

2007-12-01  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-name-anchor-from-hist): New buffer-local variable.
	(w3m-clear-local-variables): Also clear w3m-name-anchor-from-hist.
	(w3m-goto-url): Save and restoe w3m-name-anchor-from-hist.
	(w3m-search-name-anchor): Record (point)s of before and after
	following a name-anchor.
	(w3m-view-previous-page): If possible, move back the cursor to the
	point where it was before following name-anchors.

2007-11-30  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-proc.el (w3m-process-y-or-n-p): Ignore space to avoid
	answering y without intention.

2007-11-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url-new-session): Use
	w3m-active-region-or-url-at-point.  Reported by Naohiro Aota.

	* w3m-ems.el (w3m-create-image): Don't modify case-fold-search.

	* w3m-xmas.el (w3m-create-image): Ditto; parse image data to
	identify its type in the beginning position.

2007-11-29  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-w3m-dump-extra, w3m-w3m-retrieve): Removed image
	data type tests.

	* w3m-xmas.el (w3m-create-image): Parse image data first, use
	server's content-type when it failed to identify type.

	* w3m-ems.el (w3m-create-image): Ditto.

2007-11-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Fix google news entry.

	* w3m-ems.el (w3m-create-image): Parse image data if it failed in
	identifying type.

	* w3m-xmas.el (w3m-create-image): Ditto.

2007-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-resize-inline-image-internal): Validate image url.
	Reported by Naohiro Aota <nao.aota@gmail.com>.

2007-11-27  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-toggle-inline-images-internal): Confirm retrieving
	non-secure image.
	(w3m-resize-inline-image-internal): Ditto.

2007-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>,
	    TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-retrieve-and-render): Permit leaving safe pages
	without confirmation for several safe commands.

2007-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-symbol.el: Autoload w3m-mule-unicode-p when compiling.

	* w3m-proc.el: Update the way to suppress compile warning for gensym.

2007-11-26  Trent W. Buck  <trentbuck@gmail.com>

	* w3m.el (w3m-confirm-leaving-secure-page): New user option.
	(w3m-retrieve-and-render): Use it.

2007-11-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-use-japanese-menu): Default to nil for XEmacs 21.4 and
	SXEmacs.
	(w3m-link-map): New variable.
	(w3m-fontify-anchors): Add menu to links.
	(w3m-read-file-name): Don't use default file name if it is "".
	(w3m-link-menu): Define.

2007-11-06  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-redisplay-with-charset): Strip first 'about://source/'
	before setf w3m-arrived-content-charset.
	(w3m-redisplay-and-reset): Ditto.

2007-11-05  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-filter.el (w3m-filter-rules): Add rule for the site of imepita.
	(w3m-filter-imepita): New function.

2007-11-03  David Hansen  <david.hansen@gmx.net>

	* w3m-proc.el (w3m-process-wait-process): Preserve the current buffer
	\(work around an Emacs bug\).

2007-11-03  David Hansen  <david.hansen@gmx.net>

	* w3m.el (w3m-relationship-oddmuse-estimate): Follow new page layout.

2007-11-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-ucs-to-char): Alias to unicode-to-char, ucs-to-char,
	or int-to-char.

	* w3m-ems.el (w3m-ucs-to-char): Always define it.

	* w3m.el (w3m-ucs-to-char): Abolish.

2007-10-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-module-list): Don't compile mew-w3m.el and
	mew-shimbun.el if there is only the official Mew XEmacs package that is
	extremely old.

	* w3m-proc.el: Update the way to suppress compile warning for gensym.

	* w3m-util.el (w3m-list-buffers): Check if w3m-fb-mode is bound.

	* w3m.el (w3m-copy-buffer, w3m-mouse-major-mode-menu): Remove unused
	let-bound variables.

2007-10-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-lisp): Don't install w3m-ems.el for XEmacs and
	w3m-xmas.el for GNU Emacs.

2007-10-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* *, doc/*: Fix expressions of the copyright notices.

	* w3mhack.el (w3mhack-makeinfo): Don't split Info file to pieces.

	* doc/emacs-w3m.texi, doc/emacs-w3m-ja.texi: Use @copying and
	@insertcopying to put up the copyright notice.
	(Coding convention of Shimbun): Don't use @itemx with @@multitable.

	* doc/ptexinfmt.el (texinfo-copying-text, texinfo-copying)
	(texinfo-insertcopying, texinfo-format-scan): Add them for old Emacsen.

	* doc/Makefile.in (install): Remove installed *.info-[0-9] files;
	install only *.info files.
	(.texi.dvi): Don't specify "-l ja" to texi2dvi.
	(clean): No need to remove *.info-[0-9] and *.info-[0-9][0-9] files.

2007-10-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-find-coding-system): Return symbol, not coding
	system object.

2007-10-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-entity-regexp, w3m-entity-value): Accept case-insensitive
	numeric character references.

2007-10-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-message): Work with XEmacs.

2007-10-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el: Bind w3m-use-title-buffer-name (see the comment).

	* Makefile.in (very-slow): Add missing semicolon.

2007-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-lisp): Don't install ChangeLog~.

2007-10-02  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-show-error-information): When emacs-w3m cannot find
	host, set charset to us-ascii.

2007-10-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-decoded-url): Add entry for nikkei.co.jp.

2007-09-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-decode-buffer): Don't decode escaped URLs.
	(w3m-toggle-inline-images-internal): Escape non-ASCII characters in the
	URL of the image before retrieving it.

2007-09-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-safe-view-this-url): When a function which is
	specified by `w3m-goto-article-function' returns the
	`w3m-goto-url' symbol, it falls back to emacs-w3m displaying
	functions.  Cf. [emacs-w3m:09660]
	(w3m-goto-article-function): Its comment is updated to follow the
	above change.
	(w3m-entity-value, w3m-decode-entities-string): Change to save
	working memory.

2007-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-entity-regexp): Bind max-specpdl-size for old Emacsen.
	(w3m): Revert 2007-09-19 change.

2007-09-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* NEWS: New file.

2007-09-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-examine-command-line-args): Don't pass negative number to
	nthcdr.

	* w3m-session.el (w3m-session-save, w3m-session-select): Use mapc
	instead of mapcar.

2007-09-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Changes to stricten entities decoded by
	`w3m-decode-entities'.
	(w3m-entity-table, w3m-entity-reverse-table): New constants.
	(w3m-entity-regexp): Stricten.
	(w3m-entity-alist, w3m-entity-db, w3m-entity-db-size): Abolished.
	(w3m-entity-value, w3m-decode-entities, w3m-decode-entities-string,
	w3m-encode-specials-string): Rewritten to use the above constants.

2007-09-21  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Support @fonttextsize, @textdegree.

2007-09-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-examine-command-line-args): Rewrite.
	(w3m): Always call it; set the 2nd arg new-session when Emacs 21 or
	XEmacs runs in the batch mode.

2007-09-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-examine-command-line-args): Inhibit Emacs head from
	displaying startup screen when emacs-w3m runs in the batch mode;
	improve parsing of arguments.

2007-09-13  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-expand-path-name): Save the matched data surely.

2007-09-09  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-expand-url): Use "/" as path when it of base-uri is not
	defined; Clear query of base-uri when empty query exist; Changes to
	follow RFC3986.

2007-09-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-euc-japan-encoder, w3m-iso-latin-1-encoder): Use
	mule-version to decide whether to redefine them.

	* w3m.el: Use emacs-version instead of emacs-major-version to show the
	version of Emacs that emacs-w3m doesn't support.

2007-09-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-local-file-type): Regard news:* urls as text/html.
	(w3m-w3m-retrieve): Return nil if retrieving failed.
	(w3m-show-error-information): Improve error message for news:* urls.

2007-09-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_PATH_EMACS): Improve expression of Emacs version.

	* doc/ptexinfmt.el (ptexinfmt-broken-facility)
	(ptexinfmt-defun-if-broken, ptexinfmt-defun-if-void)
	(ptexinfmt-defvar-if-void): Don't use old-style backquotes.
	(texinfo-format-cedilla-accent): Quote `,'.

	* w3m-antenna.el (w3m-antenna-site-key, w3m-antenna-site-title)
	(w3m-antenna-site-class, w3m-antenna-site-url)
	(w3m-antenna-site-last-modified, w3m-antenna-site-size)
	(w3m-antenna-site-size-detected): Don't use old-style backquotes.

	* w3m-ccl.el (w3m-ccl-write-repeat, w3m-euc-japan-decoder)
	(w3m-euc-japan-encoder, w3m-iso-latin-1-decoder)
	(w3m-iso-latin-1-encoder): Don't use old-style backquotes.

	* w3m-dtree.el (w3m-dtree-has-child): Don't use old-style backquotes.

	* w3m-form.el (w3m-form-method, w3m-form-action, w3m-form-charlst)
	(w3m-form-enctype, w3m-form-plist, w3m-form-get-property, w3m-form-put)
	(w3m-form-get): Don't use old-style backquotes.

	* w3m-namazu.el (w3m-namazu-default-index-customize-spec): Don't use
	old-style backquotes.

	* w3m-util.el (w3m-static-if, w3m-static-when, w3m-static-unless)
	(w3m-condition-case, w3m-add-text-properties)
	(w3m-get-text-property-around, w3m-action, w3m-anchor, w3m-image)
	(w3m-submit, w3m-anchor-sequence): Don't use old-style backquotes.

	* w3m.el (w3m-dirlist-cgi-program): Don't use old-style backquotes.

	* w3mhack.el (char-before, match-string-no-properties)
	(set-text-properties): Don't use old-style backquotes.

	* w3m-filter.el: Set file's coding-system to euc-japan in order to
	enable non-Mule XEmacsen to byte-compile this module.

2007-08-31  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (top): Remove unnecessary space at the line end.
	(w3m-use-title-buffer-name): New option.
	(w3m-copy-buffer): Use `w3m-generate-new-buffer' instead of
	`generate-new-buffer'.
	(w3m-pack-buffer-numbers): Call `w3m-form-set-number' with new name of
	buffer.
	(w3m-buffer-setup): Use `w3m-generate-new-buffer' instead of
	`generate-new-buffer'.
	(w3m-buffer-setup): Do not display title if w3m-use-title-buffer-name
	is non-nil.
	(w3m-modeline-title): Retrun "" if w3m-use-title-buffer-name is
	non-nil.
	(w3m-goto-url): Call `w3m-buffer-name-add-title' when display.
	(w3m): Use `w3m-generate-new-buffer' instead of `generate-new-buffer'.
	(w3m-use-header-line-title): New option.

	* w3m-form.el (w3m-form-set-number): Change 2'nd argument to `newname'
	from `count'.

	* w3m-util.el (top): Add the variable definition of
	`w3m-use-title-buffer-name' to avoid byte-compile warnings.
	(w3m-buffer-number): Support the feature of buffer-name with title.
	(w3m-buffer-set-number): Ditto.
	(w3m-generate-new-buffer): Ditto.
	(w3m-buffer-name-lessp): Ditto.
	(w3m-buffer-name-add-title): New inline macro.

	* w3m-ems.el (top): Add the variable definition of
	`w3m-use-header-line-title' to avoid byte-compile warnings.
	(w3m-setup-header-line): If `w3m-use-header-line-title' is not nil,
	display title and URI.

2007-08-30  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-proc.el (top): Add the function definition of
	`w3m-decode-coding-string-with-priority' to avoid byte-compile
	warnings.

	* w3m-ems.el (top): Add the variable definition of
	`w3m-default-coding-system' and `w3m-coding-system' to avoid
	byte-compile warnings.

	* w3m-xmas.el (top): Add the variable definition of `w3m-coding-system'
	to avoid byte-compile warnings.

2007-08-29  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-proc.el (w3m-process-filter): Decode realm string.

	* w3m.el (w3m-url-decode-string): Define latter half as a function :
	w3m-decode-coding-string-with-priority ,and use it.

	* w3m-ems.el (w3m-decode-coding-string-with-priority): New function.

	* w3m-xmas.el (w3m-decode-coding-string-with-priority): Return string
	itself unless find-coding-system is defined as built-in function.

2007-08-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-uri-replace-alist): Add key of "alc:".
	(w3m-relationship-estimate-rules): Add alc's rule.
	(w3m-relationship-alc-estimate): New function.

	* w3m-search.el (w3m-search-engine-alist): Add rule of
	http://eow.alc.co.jp/.

	* w3m-filter.el (w3m-filter-rules): Add w3m-filter-alc.
	(w3m-filter-alc): New function. Supper `goFairWord'.

2007-08-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-mailto-url): Make it work even with no rfc2368.el.

2007-08-21  Eugene Oleinik  <eo@aoizora.org>

	* w3m-filter.el (w3m-filter-google-separator): New user option.
	(w3m-filter-google): Replace hard-coded ones with it.
	(w3m-filter): Iterate through all cases in w3m-filter-rules.
	(w3m-filter-replace-regexp): New function.

2007-08-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-detect-xml-type): New function that treats
	application/xml looking like xhtml+xml as text/html.
	(w3m-content-type-alist): Use it for application/xml.
	(w3m-w3m-parse-header): Parse Alternates header for a real url.
	(w3m-w3m-retrieve-1): Retrieve real url according to Alternates header.
	(w3m-external-view): Treat xhtml+xml as html.

2007-07-30  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el: Changes to download contents after submitting form.
	(w3m-form-download): New variable.
	(w3m-fontify-textareas, w3m-form-parse-and-fontify): Combine the above
	variable into expressions which represent form actions.
	(w3m-form-submit): Accept and optional argument `download'.

	* w3m.el: Changes to download contents after submitting form.
	(w3m-download): Accept and optional argument `post-data'.
	(w3m-download-this-url): `w3m-form-download' is binded locally.
	(w3m-view-this-url): Ditto.
	(w3m-submit-form): Ditto.

2007-07-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ucs.el (font-ccl-encoder-alist): Bind it for XEmacs 21.5.

2007-07-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Make Google rule support
	images.

2007-07-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-session.el (w3m-session-select, w3m-session-selected): Add spec
	for dark tty.
	(w3m-session-select): Use read-key-sequence rather than read-event or
	next-command-event in order to enable it to read arrow keys in tty.

2007-07-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-make-button): Make it work.

	* w3m-ems.el (w3m-form-make-button): Work when w3m-form-use-fancy-faces
	is nil.

2007-07-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-article-function): Change the default function into
	browse-url; doc fix.
	(w3m-safe-view-this-url): Catch a signal from function which is set to
	w3m-goto-article-function, and don't run the default function if it is
	nil.

2007-07-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-article-function): Use defcustom; doc fix.
	(w3m-safe-view-this-url): Use functionp instead of fboundp to check the
	value of w3m-goto-article-function.

	* w3m-favicon.el, w3m-namazu.el, w3m-perldoc.el, w3m-xmas.el, w3m.el:
	Use custom-set-default instead of set-default in defcustom forms.

2007-07-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-make-help-echo): Make the function for Emacs bind
	deactivate-mark to nil.

2007-06-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el, w3m-form.el, w3m-lnum.el, w3m-search.el, w3m-session.el
	* w3m.el: Rename w3m-FOO-face with w3m-FOO.

2007-06-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Format @key{...}.

2007-06-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-lynx-like-map, w3m-info-like-map): Bind [backtab] to
	w3m-previous-anchor.

2007-06-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-local-retrieve, w3m-w3m-retrieve, w3m-about-retrieve)
	(w3m-cid-retrieve, w3m-data-retrieve, w3m-retrieve, w3m-about-header):
	Change the term and the symbol name `no-decode' into `no-uncompress'.

2007-06-08  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-w3m-retrieve): Check if content-type is wrong after
	decoding encoded contents.

	* w3m-ems.el (w3m-create-image, w3m-create-resized-image): Decode
	content retrieving image.

	* w3m-xmas.el (w3m-create-image, w3m-create-resized-image): Ditto.

2007-06-07  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-search.el (w3m-search-engine-alist): Add output encoding argument
	to google search.

2007-06-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-image.el (w3m-imagick-convert-program, w3m-resize-images): Reset
	them if convert program is not really available.
	(w3m-imagick-convert-program-available-p): New function.
	(w3m-imagick-convert-buffer, w3m-imagick-start-convert-data): Use it.

2007-06-05  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m-image.el (w3m-imagick-start-convert-data): Clarify message which
	is issued when convert program is not available.

2007-06-05  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-mixi): Follow the change of Mixi's HTML.

2007-06-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* attic/vm-w3m.el, attic/vm-7.19.patch: Remove.  They have been
	integrated into VM 8.x.

2007-05-17  Tatsuya Kinoshita  <tats@vega.ocn.ne.jp>

	* w3m.el (w3m-view-this-url-1): Check whether the marker buffer exists.

2007-05-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-switch-to-buffer, w3m-subst-switch-to-buffer-keys):
	Remove.

2007-05-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-expand-url): Guard error in aref when url is "".

2007-05-16  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-expand-url): Remove query strings when expanding URL like
	"foo.cgi?#bar"; add "./" to top of URL when expanding "?hoge".

2007-05-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-switch-to-buffer): Work just like switch-to-buffer.
	Suggested by Robert J. Chassell <bob@rattlesnake.com>.

2007-05-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-encode-string, w3m-url-transfer-encode-string): Use
	uppercase letters in hexadecimal string.  Suggested by Lukasz Demianiuk
	<ldemianiuk@gmail.com>.

2007-05-09  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-header-line-url): New function.
	(w3m-url-at-point): Call w3m-header-line-url after
	w3m-gmane-url-at-point.
	(w3m-goto-url-with-timer): Execute w3m-goto-url if its buffer does not
	exist foreground.

2007-05-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (all): Revert SHIRAI's 2007-04-24 changes and fix it to
	accompany Ito-san's patch [w3m-dev 04233].
	(w3m-display-ins-del): New option.
	(w3m-support-emacs-w3m): Remove this variable.
	(w3m-strike-through-face): Modify.
	(w3m-insert-face): Ditto.
	(w3m-strike-through-face-no-windowsystem): Remove this face.
	(w3m-fontify-insert): Remove this variable.
	(w3m-halfdump-command-arguments): Remove w3m-support-emacs-w3m.
	(w3m-halfdump-command-common-arguments): Add w3m-display-ins-del
	support.
	(w3m-fontify-strike-through): Rewrite.
	(w3m-fontify-insert): Ditto.
	(w3m-set-display-ins-del): New function.
	(w3m-rendering-half-dump): Call w3m-set-display-ins-del.

2007-04-30  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-resume): Also resume contents of forms without
	name.
	(w3m-fontify-textareas): Also fontify textareas without name.
	(w3m-form-field-parse): Also parse form fields without name.

2007-04-28  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-decode-buffer): Use w3m-url-transfer-encode-string
	instead of w3m-url-encode-string.

2007-04-27  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-view-this-url): Check if w3m-current-url is string before
	matching.

2007-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Fully decode a source by default.
	(w3m-view-source): Doc fix.

2007-04-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-goto-url): Redisplay to search an anchor sure with
	goto-new-session.

2007-04-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-source-decode-level): New variable.
	(w3m-decode-buffer): Control how much it decodes an html source
	according to w3m-view-source-decode-level.
	(w3m-view-source): Bind w3m-view-source-decode-level with prefix arg.

2007-04-25  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-decode-buffer): Encode urls containing non-ASCII
	characters quoted with '' as well as those quoted with "".
	(w3m-goto-url): Decode urls when url is local.

	characters when displaying an html source.

2007-04-24  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-decode-buffer): Use charset specified in meta tag even
	for decoding html source.

2007-04-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-lisp): Install shimbun/ChangeLog file.

2007-04-24  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-support-emacs-w3m): New variable.
	(w3m-compile-options): Set w3m-support-emacs-w3m to t if w3m compiled
	with emacsdump.
	(w3m-strike-through-face-no-windowsystem): New face.
	(w3m-halfdump-command-arguments): Use '-emacsdump' instead of
	'-halfdump' when w3m has it.
	(w3m-fontify-strike-through): Support w3m-support-emacs-w3m.
	(w3m-fontify-insert): Ditto.

2007-04-24  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-goto-url): Set truncate-lines to nil, if a source or
	header view.
	(w3m-view-source): Remove to set truncate-lines.
	(w3m-view-header): Ditto.

2007-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* ChangeLog, ChangeLog.1: Separate shimbun entries.
	(Local Variables): Set fill-column to 79.

2007-04-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-input-textarea-filename): Use MD5 first.

2007-04-14  Naohiro Aota  <nao.aota@gmail.com>

	* w3m-form.el (w3m-form-input-textarea-filename): Truncate filename
	into less than or equal to 255 bytes long.

2007-04-06  Matt Hodges  <M.P.Hodges@rl.ac.uk>

	* w3m.el (w3m-next-buffer): Fix last change when w3m-fb-mode.

2007-04-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-parent-page): Use numbered prefix argument to move
	the parent directory according to input number.

2007-03-31  Andreas Seltenreich  <seltenreich@gmx.de>

	* w3m.el (w3m-external-view-file): Actually kill the temporary buffer.

2007-03-30  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-ems.el (w3m-tab-mouse-track-selected-tab): Sleep anyway.
	(w3m-tab-make-keymap): Add key-bindings for mouse wheel-up|down to
	w3m-mode-map.

2007-03-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug-system-informations): Add gtk.
	(report-emacs-w3m-bug): Bind print-quoted to t.

	* w3m-ems.el (w3m-force-window-update): Do split-window-vertically
	instead of performing enlarge-window/shrink-window for Emacs 21.
	(w3m-tab-mouse-track-selected-tab): Add `decelerate' argument; use it
	instead of to check the value of this-command.
	(w3m-tab-move-right): Set it.
	(w3m-tab-make-keymap): Rearrange.
	(w3m-update-tab-line): Remove.

	* w3m.el (w3m-select-buffer-update): Use w3m-force-window-update
	instead of w3m-update-tab-line.

2007-03-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-ems.el (w3m-tab-mouse-track-selected-tab): Tiny fix.
	(w3m-tab-make-keymap): Use next|previous-buffer-action instead of
	w3m-tab-next|previous-buffer.

2007-03-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-tab-mouse-track-selected-tab): Ignore mouse position
	info if mouse points to other frame; recognize wheel-up and wheel-down
	in addition to mouse-4 and mouse-5; don't respond to too fast operation
	of mouse wheel for moving a tab.

2007-03-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-tab-track-mouse): New variable.
	(w3m-tab-mouse-position-adjuster): Express the values in pixel units
	rather than the number of characters.
	(w3m-tab-mouse-track-selected-tab): Be controlled by
	w3m-tab-track-mouse; calculate the mouse position in pixel units rather
	than the number of characters.
	(w3m-tab-make-keymap): Make the buffer selected by a tab the current
	buffer before performing w3m-tab-move-(left|right).
	(w3m-tab-separator-map): New keymap.
	(w3m-tab-separator): Use it as the local-map property.
	(w3m-tab-line): Use it as the local-map property in trailing space.

2007-03-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el (w3m-tab-unselected-face)
	(w3m-tab-unselected-retrieving-face, w3m-tab-selected-face)
	(w3m-tab-selected-retrieving-face, w3m-tab-mouse-face): Make background
	colors bright.
	(w3m-tab-mouse-position-adjuster): New variable.
	(w3m-tab-mouse-track-selected-tab, w3m-tab-next-buffer)
	(w3m-tab-previous-buffer, w3m-tab-move-right, w3m-tab-move-left): New
	functions.
	(w3m-tab-map): Bind C-wheel-up and C-mouse-4 to w3m-tab-move-left; bind
	C-wheel-down and C-mouse-5 to w3m-tab-move-right; use
	w3m-tab-previous-buffer and w3m-tab-next-buffer instead of
	w3m-previous-buffer and w3m-next-buffer.
	(w3m-tab-separator): Add tab-separator property.

	* w3m.el (w3m-next-buffer): Fix calculation.
	(w3m-lynx-like-map, w3m-info-like-map): Bind `C-c C-,' and `C-c C-<' to
	w3m-tab-move-left, and bind `C-c C-.' and `C-c C->' to
	w3m-tab-move-right for GNU Emacs.

2007-03-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-add-tab-number): New user option.

	* w3m-ems.el (top): Add w3m-add-tab-number to avoid byte-compile
	warnings.
	(w3m-tab-line): Display sequential number on tab title when
	w3m-add-tab-number is not nil.

	* w3m.el (w3m-menubar): Add w3m-session-save and w3m-session-select.
	(w3m-tab-button-menu-commands): Ditto.

2007-03-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ems.el: New file merging w3m-e21.el, w3m-e23.el and w3m-fsf.el.
	(image-size): No need to silence the byte compiler.
	(w3m-ccl-get-ucs-codepoint-with-emacs-unicode): Remove.
	(w3m-euc-japan-encoder, w3m-euc-japan-encoder)
	(w3m-iso-latin-1-encoder, w3m-iso-latin-1-encoder): Redefine them only
	for Emacs 22 and earlier.

	* w3m-e21.el, w3m-e23.el, w3m-fsf.el: Remove.

	* w3m.el: Load w3m-ems.el instead of w3m-e21.el or w3m-e23.el.
	(w3m-fontify-strike-through): Remove variable.

	* w3mhack.el (w3mhack-mdelete): Remove.
	(w3mhack-module-list): Use w3m-ems.el instead of w3m-fsf.el and
	w3m-e21.el or w3m-e23.el.

	* Makefile.in (tarball): No need to exclude w3m-e23.el.

2007-03-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_SET_XEMACSDEBUG): Fix the way to quote the value of
	XEMACSDEBUG.  Reported by Norbert Koch <nk@viteno.net>.

2007-03-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_SET_XEMACSDEBUG): Quote VANILLA_FLAG.

2007-03-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_SET_XEMACSDEBUG): New function; set XEMACSDEBUG
	environment variable, which is eval'd when XEmacs 21.5 starts, to the
	Lisp form, which sets `log-warning-minimum-level' to `error', in order
	to suppress warnings for Lisp shadows when XEmacs 21.5 starts.
	(AC_PATH_EMACS): Run AC_SET_XEMACSDEBUG.
	(AC_EMACS_LISP, AC_ADD_LOAD_PATH): Use XEMACSDEBUG.

	* Makefile.in (XEMACSDEBUG): New variable.
	(lisp, what-where, install-package, install-package-ja, dist)
	(.el.elc, slow, very-slow): Use it.

	* doc/Makefile.in (XEMACSDEBUG): New variable.
	(EMACSINFO, version.texi, install-en, install-ja): Use it.

	* w3mhack.el: Reset `log-warning-minimum-level' to `info'.

2007-03-15  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-session.el (w3m-session-deleted-save): Sort buffers to use their
	name.

2007-03-13  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (autoload): Add w3m-session-deleted-save.
	(w3m-delete-buffer): Call w3m-session-deleted-save.
	(w3m-delete-other-buffers): Call w3m-delete-buffers instead of piece of
	code.
	(w3m-delete-buffers): Call w3m-session-deleted-save.

	* w3m-session.el (w3m-session-deleted-save): New option.
	(w3m-session-deleted-title): Ditto.
	(w3m-session-deleted-keep-number): Ditto.
	(w3m-session-deleted-save): New function.
	(w3m-session-select): Display URLs.
	(w3m-session-select): Add key assignment; `k' and `j'.

2007-03-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug): Use a new buffer to compose a mail
	if at least mail-user-agent is sendmail-user-agent that is the default.
	cf.
	<https://lists.gnu.org/archive/html/emacs-devel/2007-03/msg00399.html>

2007-03-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-generate-load-file): Advise make-autoload to
	support define-minor-mode if it should be necessary.

2007-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-async-exec-with-many-urls): New variable; default to t
	except for XEmacs 21.5.
	(w3m-goto-url): Bind w3m-async-exec to nil when retrieving group:* urls
	if w3m-async-exec-with-many-urls is nil.

	* w3m-session.el (w3m-session-goto-session): Bind w3m-async-exec to nil
	if w3m-async-exec-with-many-urls is nil.

2007-03-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-session.el (w3m-session-select): Use next-command-event and
	event-key for XEmacs with checked surely.

2007-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-session.el (w3m-session-automatic-save): Remove unused vars.
	(w3m-session-select): Use next-command-event for XEmacs; clear the echo
	area after entering command.

2007-03-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (autoload): Add w3m-session-select, w3m-session-save and
	w3m-session-automatic-save.
	(w3m-lynx-like-map): Add w3m-session-select and w3m-session-save to
	map.
	(w3m-info-like-map): Ditto.
	(w3m-arrived-shutdown-functions): Add w3m-session-automatic-save.
	(w3m-quit): Call w3m-session-automatic-save.

	* w3m-session.el: New file.

2007-02-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-rules): Add rules for the site of Amazon
	and Mixi.
	(w3m-filter-amazon-regxp): New option.
	(w3m-filter-amazon-short-url-bottom): Ditto.
	(w3m-filter-google): Add doc-string.
	(w3m-filter-amazon): New function.
	(w3m-filter-mixi): New function.

2007-02-24  Tatsuya Kinoshita  <tats@vega.ocn.ne.jp>

	* Makefile.in, doc/Makefile.in (clean): Remove doc/version.texi.

2007-02-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Improve further regexp matching urls
	containing non-ASCII characters.

2007-02-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Improve regexp matching urls containing
	non-ASCII characters.

2007-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Encode urls containing non-ASCII
	characters.

2007-02-06  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-decode-entities): Don't decode things like entities in
	forms of the text or the select type having the name property.

2007-02-05  Naohiro Aota  <nao.aota@gmail.com>

	* w3m.el (w3m-fontify): Don't delete things like tags in forms of
	type=text as well as of type=textarea.

2007-02-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-arrived-intern): New macro, that normalizes urls by
	stripping last `/'s.
	(w3m-arrived-add, w3m-arrived-p, w3m-arrived-time)
	(w3m-arrived-put, w3m-arrived-get): Use it.
	(w3m-create-text-page): Make sure to set w3m-current-title.

2007-02-04  David Hansen  <david.hansen@physik.fu-berlin.de>

	* w3m.el (w3m-relationship-estimate-rules): Added
	`w3m-relationship-slashdot-estimate'.
	(w3m-relationship-slashdot-estimate): New function.

2007-02-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-menu-on-forefront): New variable.
	(w3m-setup-menu): Use it.

	* w3m-e21.el (w3m-menu-on-forefront): New function.

	* w3m-xmas.el (w3m-menu-on-forefront): New function.
	(w3m-setup-menu): Use it.

	* w3m-bookmark.el (w3m-setup-bookmark-menu): Don't arrange the order of
	the menu items here.
	* w3m-tabmenu.el (w3m-setup-tab-menu): Ditto.

2007-02-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in, doc/Makefile.in: Add datarootdir setting that is
	required for newer autoconfs.

	* w3m.el (w3m-lynx-like-map, w3m-info-like-map): Use (featurep 'gtk)
	instead of (boundp 'gtk-version-string); use down-mouse-3 instead of
	mouse-3, and bind drag-mouse-3 and mouse-3 to undefined for GTK Emacs.

	* w3m-e21.el (w3m-use-toolbar)
	(w3m-toolbar-icon-preferred-image-types): Use (featurep 'gtk) instead
	of (boundp 'gtk-version-string).
	(w3m-toolbar-configurations): Select frame visiting buffer which is
	about to apply configurations; use (featurep 'gtk) instead of \(boundp
	'gtk-version-string); enable it for GTK Emacs; exclude
	auto-resize-tool-bars and auto-raise-tool-bar-buttons.

2007-01-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-clean-hook-options): Remove.

2007-01-31  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-search.el (w3m-search-read-query): Check that face property is
	`list' to avoid argument error.

2007-01-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-define-w3m-make-ccl-coding-system): Rename from
	w3m-xmas-define-w3m-make-ccl-coding-system.
	(w3m-toolbar-make-buttons): Rename from w3m-xmas-make-toolbar-buttons.
	(w3m-define-missing-widgets): Rename from
	w3m-xmas-define-missing-widgets.
	(w3m-show-current-title-in-buffer-tab): Rename from
	w3m-xmas-show-current-title-in-buffer-tab.
	(w3m-setup-tab-in-gutter): Rename from w3m-xmas-setup-tab-in-gutter.
	(w3m-update-tab-in-gutter): Rename from w3m-xmas-update-tab-in-gutter.

	* w3m-e21.el (w3m-toolbar-icon-preferred-image-types)
	(w3m-toolbar-icon-preferred-image-types): Use w3m-update-toolbars
	instead of w3m-setup-toolbar.
	(w3m-toolbar-configurations): Rename from
	w3m-e21-toolbar-configurations; make it customizable for LUCID Emacs.
	(w3m-toolbar-define-keys): Rename from w3m-e21-setup-toolbar; don't
	apply w3m-toolbar-configurations here.
	(w3m-toolbar-make-buttons): Rename from w3m-e21-make-toolbar-buttons.
	(w3m-toolbar-set-configurations): New function.
	(w3m-setup-toolbar): Remove force argument; apply
	w3m-toolbar-configurations here.
	(w3m-update-toolbars): New function.
	(w3m-switch-to-buffer): Rename from w3m-e21-switch-to-buffer.
	(w3m-subst-switch-to-buffer-keys): Rename from
	w3m-e21-subst-switch-to-buffer-keys.

	* w3m.el (w3m-message): Clear previous message only if it is longer
	than the window width and running Emacs 22 and greater.

2007-01-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-toolbar-icon-preferred-image-types)
	(w3m-toolbar-use-single-image-per-icon): New variables.
	(w3m-find-image): New function.
	(w3m-xmas-make-toolbar-buttons): Use it; add force argument.
	(w3m-setup-toolbar): Use it; add force and buffer arguments.
	(w3m-initialize-graphic-icons): Use it.

	* w3m-e21.el (w3m-toolbar-icon-preferred-image-types)
	(w3m-toolbar-use-single-image-per-icon): Apply customized value to tool
	bar immediately.
	(w3m-e21-make-toolbar-buttons, w3m-setup-toolbar): Add force arg.

2007-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* icons/*.png, icons30/*.png: New files.

	* Makefile.in (install-icons, install-icons30): Install png files.

	* w3mhack.el (w3mhack-nonunix-install, w3mhack-make-package): Install
	png files.
	(w3mhack-what-where): Update for png files.

	* w3m-e21.el (w3m-use-toolbar): Check whether tool-bar and
	gtk-version-string are available.
	(w3m-toolbar-icon-preferred-image-types)
	(w3m-toolbar-use-single-image-per-icon): New variables.
	(w3m-find-image): New function.
	(w3m-e21-make-toolbar-buttons, w3m-setup-toolbar)
	(w3m-initialize-graphic-icons): Use it.

2007-01-24  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-halfdump-command-arguments): Generate the right values
	for non-Mule XEmacs.

2007-01-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-message): Clear previous message first.  Suggested by
	David Hansen <david.hansen@gmx.net>.

2007-01-18  Friedrich Delgado Friedrichs  <delgado@dfn-cert.de>

	* w3m-proc.el (w3m-process-ssl-passphrase): New variable.
	(w3m-process-filter): Enable w3m to authenticate itself with a client
	certificate.

2007-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el: Autoload iswitchb-read-buffer when compiling.

2007-01-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-e21-switch-to-buffer): Add iswitchb-mode support.

2007-01-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-modeline-title): Don't use w3m-force-window-update which
	obstructs viewing of large images.  Reported by Chris Moore
	<dooglus@gmail.com>.

2006-12-21  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-rules): Add rule for the site of Google.
	(w3m-filter-google-use-utf8): New user option.
	(w3m-filter-google-use-ruled-line): Ditto.
	(w3m-filter-google): New function.

2006-12-13  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Fix amazon entry.

2006-12-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_EXAMINE_PACKAGEDIR): Check for
	(early|late|last)-package-hierarchies as well as
	(early|late|last)-packages; prefer them to configure-package-path.

2006-12-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-form.el: Changes to create a new session after submitting form.
	(w3m-form-new-session): New variable.
	(w3m-fontify-textareas, w3m-form-parse-and-fontify): Combine the above
	variable into expressions which represent form actions.
	(w3m-form-submit): Accept and optional argument `new-session'.

	* w3m.el: Changes to create a new session after submitting form.
	(w3m-submit-form): Accept and optional argument `new-session'.
	`w3m-form-new-session' is binded locally.
	(w3m-view-this-url): `w3m-form-new-session' is binded locally.

2006-12-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-parent-page): Add prefix argument `TOP'. If TOP is
	non-nil, visit the top of this site."
	(w3m-parent-page-available-p): Fix regexp.

2006-12-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* patches/README: Update.
	* patches/italic-text.patch: New file.
	* patches/dot-domain.patch: New file.
	* patches/file-progress.patch: Renew.
	* patches/w3m-0.2.1-inu-1.5-solaris-xemacs.patch: Remove.
	* patches/no-proxy.patch: Remove.

2006-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-italic-face): New face.
	(w3m-fontify-italic): New function.
	(w3m-fontify): Use it.

2006-11-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (w3m-mail-compose-with-mew): Refrain handling of
	`current-prefix-arg'.

2006-11-14  Ren Lifeng  <lfren@cad.zju.edu.cn>

	* w3m-cookie.el (w3m-cookie-1-acceptable-p): Accept cookie whose domain
	attribute is ".foo.barz.bar" from host "foo.barz.bar".
	(w3m-cookie-retrieve): Send cookie whose domain attribute is
	".foo.barz.bar" when requesting host "foo.barz.bar".

2006-11-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-mail.el (w3m-mail-compose-with-vm): Require vm-startup.

2006-11-20  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* w3m-mail.el (w3m-mail-compose-with-semi): Require mime-edit.

2006-10-11  David Hansen  <david.hansen@physik.fu-berlin.de>

	* w3m.el (w3m-relationship-estimate-rules): Support for google code
	search added.

2006-10-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el, w3m-bookmarks.el, w3m-search.el: Remove misadded Luca Capello
	from the Authors field.

2006-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-compatible-encoding-alist): Add iso-8859-8/windows-1255
	and iso-8859-9/windows-1254.

2006-10-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-mail.el (w3m-mail-compose-with-vm): Treat source as binary data
	for images; encode source according to charset; use mail-send-actions
	to kill source buffer.
	(w3m-mail): Examine charset when the page is displayed normally.

	* w3m-util.el (w3m-coding-system-to-mime-charset): Rename to
	w3m-coding-system-to-charset and move to w3m.el

	* w3m.el (w3m-coding-system-to-charset): Move from w3m-util.el.
	(w3m-buffer): New function.

2006-09-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mail-user-agents): Add vm-user-agent.

	* w3m-mail.el (w3m-mail-user-agent-compose-function-alist): Add
	vm-user-agent.
	(w3m-mail-compose-with-vm): New function.
	(w3m-mail-goto-body-and-clear-body): New function.
	(w3m-mail-position-point): New function.
	(w3m-mail-compose-with-mml, w3m-mail-compose-with-semi): Use them.

2006-09-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (w3m-mail-compose-with-mew): Handle coding-system and
	charset accurately. When call with `current-prefix-arg', try to use
	existing draft buffer.

	* w3m-mail.el (w3m-mail): Bind `w3m-history-reuse-history-elements' to
	'reload.

2006-09-29  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* w3m-mail.el (w3m-mail-compose-with-semi): Handle types other than
	text/html as well. Decide the charset when the charset is nil though
	the content-type is a text.

2006-09-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-mail.el (w3m-mail-compose-with-mml): Treat source as binary data
	for images (we will probably have to do so for some more types); pass
	content-type argument to MML.

2006-09-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-mail-user-agents): Add mew-user-agent.

	* w3m-mail.el (top): Autoload w3m-mail-compose-with-mew
	(w3m-mail-user-agent-compose-function-alist): Add mew-user-agent.
	(w3m-mail-compose-with-mml): Add `content-type' argument
	(w3m-mail-compose-with-semi): Ditto.
	(w3m-mail): Handle `content-type' and `about://header/'.

	* mew-w3m.el (w3m-mail-compose-with-mew): New function.  Add
	`content-type' argument and handle it.

2006-09-28  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* w3m-mail.el (w3m-mail-user-agent-compose-function-alist): Add
	wl-user-agent.
	(w3m-mail-compose-with-semi): New function.

	* w3m.el (w3m-mail-user-agents): Add wl-user-agent.

2006-09-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-coding-system-to-mime-charset): New function.

	* w3m-mail.el (w3m-mail-compose-with-mml): Bind gnus-newsgroup-name to
	nil while composing mail if gnus-user-agent is used instead of removing
	X-Draft-From header.
	(w3m-mail): Use w3m-coding-system-to-mime-charset.

2006-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-mail.el (w3m-mail-compose-with-mml): Remove X-Draft-From header;
	make charset argument a string.
	(w3m-mail): Make charset argument to be passed to composer a symbol.

2006-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-mail.el: New file.

	* w3m.el: Autoload w3m-mail.
	(w3m-mail-user-agents): New variable.
	(w3m-menubar): Add w3m-mail.

2006-09-26  Luca Capello  <luca@pca.it>

	* w3m-search.el (w3m-search-new-session): New command.
	(w3m-search-read-variables): Ditto.
	(w3m-search-do-search): Ditto.
	(w3m-search): Rewrite to use the new commands above; add myself to the
	authors list.

	* w3m.el (autoload): Add w3m-search-new-session.
	(w3m-menubar): Add w3m-search-new-session.
	(w3m-info-like-map): Add w3m-search-new-session at the place of the
	called-interactively w3m-search to be compliant with the other
	*-new-session key-bindings.
	(w3m-mode): Add description of w3m-search-new-session to docstring.

2006-09-25  Luca Capello  <luca@pca.it>

	* w3m-bookmark.el: Add myself to the authors list, forgotten when
	submitting the patch for w3m-bookmark-view-new-session.

	* w3m.el: Ditto.

2006-09-22  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-e21.el (w3m-tab-make-keymap): Support mouse wheel on the tab.

	* w3m-e23.el (w3m-tab-make-keymap): Ditto.

2006-09-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-fb.el: Bind w3m-delete-buffer, w3m-fb-frame-parameter,
	w3m-list-buffers, w3m-next-buffer, and w3m-pop-up-frames when
	compiling.

2006-09-16  David Hansen  <david.hansen@physik.fu-berlin.de>

	* w3m.el (w3m-relationship-estimate-rules): Changed freshmeat URL
	regexp.

2006-09-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-lynx-like-map, w3m-info-like-map): Don't bind M-g key
	because Emacs 22 uses it as a prefix command in global map.  Suggested
	by David Hansen <david.hansen@gmx.net>.

2006-09-09  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Instruct explicitly Google
	to return English pages for google-en.

2006-09-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-default-directory): New variable.
	(w3m-current-directory): Use it.

2006-09-05  David Hansen  <david.hansen@gmx.net>

	* w3m.el (w3m-local-find-file-regexps): Default to '(nil
	. "\\.[sx]?html?\\'").

2006-08-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-enable-google-feeling-lucky): New variable.
	(w3m-input-url): Disable the Google feeling lucky feature if it is nil.

2006-08-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-decoded-url): Add entry for ohmynews.co.jp.

2006-08-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-relationship-search-patterns): Call
	`w3m-decode-anchor-string' in order to decode "&amp;" in anchor
	strings.
	(w3m-relationship-freshmeat-estimate): Removed.
	(w3m-relationship-estimate-rules): Use
	`w3m-relationship-simple-estimate' instead of the above, to simplify
	related codes.

2006-08-11  David Hansen  <david.hansen@pysik.fu-berlin.de>

	* w3m.el (w3m-relationship-oddmuse-estimate): New function.
	(w3m-relationship-freshmeat-estimate): New function.
	(w3m-relationship-estimate-rules): Fixed regexp for google groups.
	Added above new functions.

2006-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-truncate-string): Don't autoload mule-util.el.

2006-06-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-tabmenu.el (w3m-tab-menubar-make-items-precbuf): New internal
	variable.
	(w3m-tab-menubar-make-items-prebuflst): Ditto.
	(w3m-tab-menubar-make-items-preurl): Ditto.
	(w3m-tab-menubar-make-items-preitems): Ditto.
	(w3m-tab-menubar-make-items): Set an use previous variables to used for
	the speed improvement.

	* w3m-util.el (w3m-make-menu-commands-keys): New internal variable.
	(w3m-make-menu-commands): Set and use `w3m-make-menu-commands-keys to
	used for the speed improvement.

2006-06-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* attic/rfc2368.el: Copy from Emacs 22; modify rfc2368-unhexify-string
	to work with both Emacs and XEmacs.

2006-05-31  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-this-url-1): Set 5th argument of `w3m-copy-buffer'
	to `w3m-new-session-in-background'.
	(w3m-copy-buffer): Add `background' argument. When URL is null and
	`background' is not non-nil, stay the current buffer.

2006-05-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-read-query): Ignore page title only in
	w3m-mode buffers.

2006-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-read-query): Assume there's not only a list
	of faces but also just a face.

2006-05-30  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m.el (w3m-copy-buffer): Create empty w3m buffer when url is not
	set.  Cause error on meaningless combination of arguments.

2006-05-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-e21.el (w3m-tab-selected-background-face): New face.
	(w3m-tab-separator): Put `mouse-face' for the shape of a mouse button.
	(w3m-tab-line): Ditto.

	* w3m-e23.el (w3m-tab-selected-background-face): New face.
	(w3m-tab-separator): Put `mouse-face' for the shape of a mouse button.
	(w3m-tab-line): Ditto.

2006-05-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-tab-button-menu-commands): Disable same items if
	`w3m-tab-button-menu-current-buffer' is nil.
	(w3m-tab-button-menu2): New function.

	* w3m-e21.el (top): Add the variables and function to avoid
	byte-compile warnings.
	(w3m-tab-drag-mouse-function): Support drag & drop to out of the
	frame. Don't call `bury-buffer'.
	(w3m-tab-click-mouse-function): Don't call `bury-buffer'.
	(w3m-tab-double-click-mouse1-function): new function.
	(w3m-tab-double-click-mouse2-function): Ditto.
	(w3m-tab-make-keymap): Add some methods.

	* w3m-e23.el (top): Add the variables and function to avoid
	byte-compile warnings.
	(w3m-tab-drag-mouse-function): Support drag & drop to out of the
	frame. Don't call `bury-buffer'.
	(w3m-tab-click-mouse-function): Don't call `bury-buffer'.
	(w3m-tab-double-click-mouse1-function): new function.
	(w3m-tab-double-click-mouse2-function): Ditto.
	(w3m-tab-make-keymap): Add some methods.

	* w3m.el (w3m-tab-button-menu-commands): Change position some items.

2006-05-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-widget-type-convert-widget): New function.

	* w3m.el (w3m-home-page, w3m-new-session-url)
	(w3m-uri-replace-alist): Use it.

	* w3m-dtree.el (w3m-dtree-indent-strings, w3m-dtree-stop-strings): Use
	it.

	* w3m-symbol.el (w3m-symbol-custom-type): Use it.

2006-05-21  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m.el (autoload): `w3m-bookmark-view-new-sessiont' ->
	`w3m-bookmark-view-new-session'.

2006-05-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-home-page): Rewrite :convert-widget function.
	(w3m-new-session-url): Ditto.

2006-05-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-new-session-url): Doc fix; improve custom type.
	(w3m-new-session-in-background): Doc fix.

2006-05-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-new-session-url): Rename from
	`w3m-tab-button-new-session-url'.
	(w3m-tab-button-focus-new-tab): Delete.
	(w3m-view-this-url-new-session-in-background): This option sets
	obsolete.
	(w3m-new-session-in-background): New option.
	(w3m-menubar): Change and add Some items.
	(w3m-copy-buffer): If call-interactively, set `just-copy' to `t'.  If
	`w3m-new-session-in-background' and `just-copy' is non-nil, swith to
	original buffer when finished.
	(w3m-lynx-like-map): Add `w3m-bookmark-view-new-session'.
	(w3m-tab-button-menu-commands): Use `w3m-new-session-in-background'
	insted of `w3m-tab-button-focus-new-tab'.
	(w3m-goto-new-session-url): New command.
	(w3m-goto-url-new-session): Call `w3m-copy-buffer' with
	`w3m-new-session-in-background'.
	(w3m-select-buffer-generate-contents): Add prefix number to beginning
	of title name.

	* w3m-tabmenu.el (w3m-tab-menubar-items-sub-coeff): New variable.
	(w3m-tab-menubar-items-width): Ditto.
	(w3m-tab-menubar-make-items-1): New inline macro and trancate string of
	tab's title if over `w3m-tab-menubar-items-width'.
	(w3m-tab-menubar-make-items): Use `w3m-tab-menubar-make-items-1'.  If
	the number of tabs over `(- (frame-height)
	w3m-tab-menubar-items-sub-coeff)', make sub-menu.

	* w3m-bookmark.el (w3m-bookmark-view-new-session): Use
	w3m-view-this-url-1 instead of w3m-goto-url; warn if w3m-mode does not
	run.
	(w3m-bookmark-menu-items): Add w3m-bookmark-view-new-session.

2006-05-18  Luca Capello  <luca@pca.it>

	* w3m-bookmark.el (w3m-bookmark-view): Add docstring.
	(w3m-bookmark-view-new-session): New command.

	* w3m.el (autoload): Add docstring to w3m-bookmark-view; add
	w3m-bookmark-view-new-session.
	(w3m-menubar): Add Bookmark submenu and w3m-bookmark-view-new-session.
	(w3m-info-like-map): Add w3m-bookmark-view-new-session.
	(w3m-mode): Add description of w3m-bookmark-view-new-session to
	docstring.

2006-05-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-tab-button-focus-new-tab): New option.
	(w3m-menubar): Add some items.
	(w3m-external-view-this-url): New command.
	(w3m-external-view-current-url): Ditto.
	(w3m-tab-button-menu-commands): Use `w3m-tab-button-focus-new-tab' on
	`w3m-goto-url-new-session' and `w3m-copy-buffer'.
	(w3m-tab-button-menu): Make with `w3m-make-menu-commands'.

	* w3m-util.el (top): Add the variable definition of `w3m-mode-map' to
	avoid byte-compile warnings.
	(w3m-make-menu-commands): New function.

	* w3m-tabmenu.el (w3m-tab-menubar-make-items): Use
	`w3m-make-menu-commands'.

2006-05-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-url-with-external-browser): Add optional url
	argument.
	(w3m-tab-button-menu-commands): Make w3m-copy-buffer and
	w3m-view-url-with-external-browser select the buffer; pass url to
	w3m-view-url-with-external-browser.

2006-05-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-bookmark-add-all-urls): New function.

	* w3m.el: Autoload w3m-bookmark-add-all-urls.
	(w3m-menubar): Add w3m-reload-all-pages.
	(w3m-lynx-like-map): Add w3m-reload-all-pages and
	w3m-bookmark-add-all-urls.
	(w3m-info-like-map): Ditto.
	(w3m-tab-button-menu-commands): Make it enable to pass arguments to
	function items; use w3m-goto-url-new-session, w3m-reload-all-pages, and
	w3m-bookmark-add-all-urls instead of lambda forms.
	(w3m-tab-button-menu): Pass arguments to functions defined in
	w3m-tab-button-menu-commands.
	(w3m-mode): Add descriptions about w3m-reload-all-pages and
	w3m-bookmark-add-all-urls to docstring.
	(w3m-reload-all-pages): New function.

2006-05-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-lynx-like-map): Define `w3m-mouse-major-mode-menu' to
	mouse-3.
	(w3m-info-like-map): Ditto.
	(w3m-mouse-major-mode-menu): New command.

	* w3m-util.el (top): Add the variable definition of
	`w3m-use-japanese-menu' to avoid byte-compile warnings.
	(w3m-make-menu-item): Change method to take measures for garbage
	characters on XEmacs.

	* w3m-bookmark.el (w3m-bookmark-make-item-xmas): New variable.
	(w3m-bookmark-make-item): New inline macro.
	(w3m-bookmark-make-menu-items): Use `w3m-bookmark-make-item'.

2006-05-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-menubar): Use `w3m-make-menu-item'.
	(w3m-tab-button-menu-current-buffer): Enable always.
	(w3m-tab-button-menu-commands): Ditto. Use `w3m-make-menu-item'.

	* w3m-util.el (w3m-make-menu-item): New function.

	* w3m-tabmenu.el (w3m-tab-menubar-make-items): Handle
	`w3m-tab-button-menu-commands' always.

	* w3m-bookmark.el (w3m-bookmark-menu-items): Use `w3m-make-menu-item'.

2006-05-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-use-japanese-menu): Change default value.
	(w3m-menubar): Simplify the rule to use Japanese menu.
	(w3m-tab-button-menu-commands): Ditto.

	* w3m-bookmark.el (w3m-bookmark-menu-items): Simplify the rule to use
	Japanese menu.

2006-05-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-menubar): Escape the Japanese katakana `a' which breaks
	the string syntax in non-Mule XEmacs.

	* w3m-bookmark.el (w3m-bookmark-menu-items): Escape the Japanese kanji
	`etsu' which breaks the string syntax in non-Mule XEmacs.

2006-05-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-use-japanese-menu): New option.
	(w3m-menubar): Add Japanese menu.
	(w3m-tab-button-menu-commands): Change the way to check Japanse or
	others.

	* w3m-bookmark.el (w3m-bookmark-menu-items): Add Japanese menu.

2006-05-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-tab-button-new-session-url): New option.
	(w3m-delete-other-buffers): New command.
	(w3m-delete-left-tabs): Ditto.
	(w3m-delete-right-tabs): Ditto.
	(w3m-delete-buffers): New function.
	(w3m-lynx-like-map): Add `w3m-delete-left|right-tabs'.
	(w3m-tab-button-menu-commands): New new items.

	* w3m-util.el (w3m-lefttab-exist-p): New inline function.
	(w3m-righttab-exist-p): Ditto.

	* w3m-tabmenu.el (w3m-tab-menubar-make-items): Handle
	`w3m-tab-button-menu-commands' if possible.

2006-05-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-tab-button-menu-commands): New variable.
	(w3m-tab-button-menu-current-buffer): New variable.
	(w3m-tab-button-menu): New variable.
	(w3m-tab-button-menu): New function.

	* w3m-e21.el (w3m-tab-make-keymap): Bind mouse-3 to menu.

2006-05-14  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-refontify-anchor): Improve parameter check.
	(w3m-create-image-page): Use `w3m-add-face-property' instead
	`put-text-property'/`add-text-properties'/`w3m-add-text-properties'.
	(w3m-history-highlight-current-url): Ditto.
	(w3m-header-line-insert): Ditto.

	* w3m-search.el (w3m-search-read-query): Improve parameter check.

	* w3m-lnum.el (w3m-link-numbering): Use `w3m-add-face-property' instead
	`put-text-property'.

	* w3m-form.el (w3m-form-make-button): Use `w3m-add-face-property'
	instead `add-text-properties'.
	(w3m-fontify-textareas): Ditto.
	(w3m-form-parse-and-fontify): Ditto.

	* w3m-e21.el,w3m-e23.el (w3m-form-make-button): Improve face property
	append method.
	(w3m-setup-header-line): Ditto.
	(w3m-tab-line): Ditto.
	(w3m-tab-separator): Modify `face' value to list.

2006-05-11  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-search.el (w3m-search-engine-alist): Use utf-8 for google if
	possible.

2006-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-show-decoded-url): Add entry for hatena.ne.jp.

2006-05-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_SET_VANILLA_FLAG): Add --no-unibyte option so as to
	invalidate EMACS_UNIBYTE environment variable.

2006-05-07  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-symbol.el: Bind w3m-use-symbol when compiling.
	(w3m-use-symbol): New function.
	(w3m-replace-symbol): Use it.

	* w3m.el (w3m-use-symbol): Changed its default value when
	w3m-output-coding-system is utf-8.

2006-05-07  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-util.el (w3m-device-on-window-system-p): New function.
	(w3m-popup-frame-p): Use it.

	* w3m-search.el (w3m-search-engine-alist): Ditto.

	* w3m.el (w3m-fontify-strike-through): Ditto.

2006-05-06  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m-search.el (w3m-search-engine-alist): Remove lycos-ja.

2006-05-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-history): New variable.
	(w3m-search): Use it.

2006-05-01  David Hansen  <david.hansen@gmx.net>

	* w3m-search.el (w3m-search-engine-alist): Add freshmeat.

2006-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-decode-string): Don't perform find-coding-system on a
	list of coding system in XEmacs.

2006-04-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-google-feeling-lucky-charset): New user option.
	(w3m-canonicalize-url): Support search-keyword for "I'm Feeling Lucky
	on Google". Add 2nd argument.
	(w3m-input-url): Suport "I'm Feeling Lucky".  Add 5th argument
	`feeling-lucky'.  Bind key to `self-insert-command' if `feeling-lucky'.
	Call `w3m-canonicalize-url' with `feeling-lucky'.
	(w3m-view-this-url): Call `w3m-input-url' with `feeling-lucky'.
	(w3m-goto-url-new-session): Ditto.
	(w3m): Ditto.

2006-04-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Require APEL XEmacs package 1.32 and later.

2006-04-22  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m-search.el (w3m-search-engine-alist): Add msdn.

2006-04-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-decode-string): Support non-Mule XEmacs
	superficially.

	* w3m-util.el (w3m-replace-in-string): Prefer replace-regexp-in-string
	over of replace-in-string.  It was done in Gnus by Reiner Steib.

2006-04-20  Kazuhiro NISHIYAMA  <zn@mbf.nifty.com>

	* w3m-search.el (w3m-search-engine-alist): Fix url for ja.wikipedia.

2006-04-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Add ja.wikipedia.

2006-04-20  David Hansen  <david.hansen@gmx.net>

	* w3m-search.el (w3m-search-engine-alist): Add wikipedia, en.wikipedia
	and de.wikipedia.

2006-04-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-download): Clear minibuffer after y-or-n-p.

2006-04-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* attic/vm-w3m.el (vm-w3m-use-w3m-minor-mode-map): New variable.
	(vm-mime-display-internal-text/html): Use it.

2006-04-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-decode-string): Make string unibyte before decoding.

2006-03-16  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-data-retrieve): New function.
	(w3m-attributes, w3m-retrieve): Add support `data:' scheme handled by
	`w3m-data-retrieve'.

2006-03-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ccl.el (charset-id): Define it as a macro instead of an alias to
	charset-id-internal if Emacs doesn't provide it.

2006-03-12  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-insert-face): New face.
	(w3m-fontify-insert): New variable.
	(w3m-fontify-insert): New function.
	(w3m-fontify): Add calling `w3m-fontify-insert'.

2006-02-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Decode buffer's string outside the
	buffer.

2006-02-26  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-w3m-parse-header): When the url matchs to ftp, rewrite
	type and charset.
	(w3m-w3m-attributes-1): Don't rewrite type and charset.
	(w3m-w3m-retrieve): Don't check status code when the url does not match
	to http.

2006-02-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-components-regexp): Move to w3m-util.el.
	(w3m-fontify-anchors, w3m-canonicalize-url, w3m-add-referer-p)
	(w3m-expand-url, w3m-view-this-url-1, w3m-goto-url)
	(w3m-goto-url-new-session): Use w3m-string-match-url-components rather
	than to run string-match with w3m-url-components-regexp.
	cf. <URL:http://emacs-w3m.namazu.org/ml/msg08412.html>.

	* w3m-form.el (w3m-form-normalize-action): Ditto.

	* w3m-cookie.el (w3m-parse-http-url): Ditto.

	* w3m-util.el (w3m-string-match-url-components-1): New function.
	(w3m-url-components-regexp): Move from w3m.el.
	(w3m-string-match-url-components): New macro.

2006-01-19  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-fontify-strike-through): Improve matching point.

2006-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/Makefile.in: Add rules to make pdf files.

	* configure.in: Check for dvipdfmx and texi2pdf.

2005-12-31  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-util.el (top): Add the variable definition of `w3m-mode-hook' to
	avoid byte-compile warnings.

2005-12-30  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-fontify-strike-through): Fix multi `<del>' problem.

2005-12-23  Matt Hodges  <MPHodges@member.fsf.org>

	* w3m-util.el (w3m-list-buffers): Ensure disabling the w3m-fb-mode
	after a careless (setq w3m-fb-mode t).

2005-12-22  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m-antenna.el (w3m-antenna-refresh-interval): Add new customize
	variable.
	(w3m-antenna-make-contents): Add new generation rule for refresh
	interval replacing `%R' to META Refresh tag and contents value are
	`w3m-antenna-refresh-interval'.
	(w3m-antenna-html-skelton): Add %R rule.

2005-12-19  Matt Hodges  <MPHodges@member.fsf.org>

	* w3m-util.el (w3m-list-buffers): Further fix against the case where
	someone did (setq w3m-fb-mode t).

2005-12-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-fb.el (w3m-fb-mode): Never activate w3m-fb-mode if
	w3m-pop-up-frames is non-nil.

	* w3m-util.el (w3m-list-buffers): Reset w3m-fb-mode if it seems to have
	been set thoughtlessly.

2005-12-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-fb.el: Don't require w3m.
	(w3m-fb-frame-parameter): Always define.
	(w3m-fb-delete-frame-functions): Ditto.
	(w3m-fb-select-buffer): Fix the 2nd clause of cond.
	(w3m-fb-advised-functions): Remove.
	(w3m-list-buffers): Move advice code to w3m-fb.el.
	(w3m-close-window): Move advice code to w3m.el.
	(w3m-delete-buffer): Ditto.
	(w3m-quit): Ditto.
	(w3m-fb-mode): Remove w3m-fb-advised-functions stuff.

	* w3m.el (w3m-fb): Require.
	(w3m-delete-buffer, w3m-quit, w3m-close-window): Merge the codes which
	were formerly provided as advices in w3m-fb.el.

	* w3m-util.el (w3m-fb-list-buffers-frame, w3m-fb-mode): Bind them when
	compiling.
	(w3m-fb-frame-parameter): Autoload.
	(w3m-list-buffers): Merge the code which was formerly provided as an
	advice in w3m-fb.el.

2005-11-26  Matt Hodges  <MPHodges@member.fsf.org>

	* w3m-fb.el: New file.

2005-12-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-submit): Use the post method for the
	multipart/form-data enctype according to the proposal of RFC2070 even
	if the form specifies the get method.

2005-11-24  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-form.el (w3m-form-submit): If anchor exists, go to the uri.

2005-11-21  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m-favicon.el (w3m-favicon-type): Renew default image type list.

2005-11-19  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-menubar): Renew enable/disable condition for `[Copy This
	Session]',`[Download This URL]', and Append `[Toggle This Image]'.

	* w3m-bookmark.el (w3m-bookmark-menu-items): Renew enable/disable
	condition for `[Add This URL to Bookmark]'.

2005-11-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-open-all-links-in-new-session): Reverse the list of URLs.

2005-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-drag-mouse-function): Lower the buffer displayed
	before moving to the other tab.
	(w3m-tab-click-mouse-function): Ditto.

2005-10-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-util.el (w3m-add-face-property): Simplified.

2005-10-15  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m-util.el (w3m-add-face-property): Add new functions.
	(w3m-remove-face-property): Ditto.

	* w3m.el (w3m-fontify-bold, w3m-fontify-underline)
	(w3m-fontify-strike-through, w3m-fontify-anchors)
	(w3m-fontify-images): Replace `w3m-add-text-properties' to
	`w3m-add-face-property' at FACE.
	(w3m-refontify-anchor): Change for FACE properly is list type.

2005-10-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-insert-image): Make it work with a face text property
	whose value is a list.
	(w3m-remove-image): Remove useless text property.
	* w3m-e23.el (w3m-insert-image,w3m-remove-image): Same as w3m-e21.el's
	modification.

2005-09-29  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-proc.el (w3m-process-filter): Fixed regexp.

2005-09-27  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-proc.el (w3m-process-filter): Remove SSL warning message for
	basic authentication over SSL.

2005-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify): Remove empty lines at the beginning of the
	buffer (see the comment).

2005-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el (mime-w3m-preview-text/html): Revert.

2005-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el (mime-w3m-preview-text/html): Bind w3m-treat-image-size
	to avoid inserting excessive newlines.

2005-09-18  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m.el (w3m-relationship-estimate-rules): Add a rule for Google Blog
	Search.

	* w3m-search.el (w3m-search-engine-alist): Use
	`http://blogsearch.google.com/' instead of `http://search.blogger.com/'
	for "blog-*" search, because search.blogger.com does not have a
	explicit link to previous search result page.

2005-09-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-redisplay-this-page): Use the cache always.

2005-09-15  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Add "blog-*" entries.

2005-09-02  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Support @frenchspacing, @euro, @sansserif.
	(texinfo-format-ordf): Fix typo.

2005-09-01  Hiroshi Fujishima  <hiroshi.fujishima@gmail.com>

	* w3m-search.el (w3m-search-engine-alist): Update goo-ja, waei, eiwa,
	kokugo URL.

2005-08-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-ucs.el: Enable XEmacs 21.5-Mule to compile it anyway.

2005-08-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Put the encoded anchor names instead of
	the itself.

2005-08-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* octet.el (octet-insert-buffer): Use insert-buffer-substring instead
	of insert-buffer.

	* w3m-bookmark.el (w3m-about-bookmark): Ditto.

	* w3m-proc.el (w3m-process-sentinel): Ditto.

2005-07-29  Kevin Rodgers  <kevin.rodgers@ihs.com>

	* w3m.el (w3m-content-type-alist): Add the text/sgml entry.

2005-07-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-scroll-up-1): New function.
	(w3m-lynx-like-map): Use it for the J command.
	(w3m-scroll-up-or-next-url): Use it.

2005-07-15  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-current-message): New internal variable.
	(w3m-message): Use the above variable to keep the last displayed
	message, to decide that this function can override the current message
	in the echo area.
	(w3m-make-help-echo): Use `message' instead of `w3m-message' to clear
	the echo area in the foreground context.
	(w3m-quit): Ditto.
	(w3m-goto-ftp-url): Ditto.
	(w3m-select-buffer-show-this-line-and-switch): Ditto.

	* w3m-proc.el (w3m-process-background): New internal variable.
	(w3m-process-sentinel): Set t to the above variable.

2005-07-13  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-message): Bury messages when the cursor in the echo area
	which is used by `y-or-n-p' etc.
	(w3m-view-parent-page): Refer both `start' link element and `content'
	start element before checking a parent URL.

2005-07-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-bookmark-menu-dummy-item): Remove.
	(w3m-bookmark-menubar-dummy): Remove.
	(w3m-bookmark-menu-items): Also define the menu for the case where
	w3m-bookmark-mode is turned on.
	(w3m-setup-bookmark-menu): Rewrite it so as to work properly with Emacs
	22.
	(w3m-bookmark-menubar-update): Ditto; remove the iswitchb section.
	(w3m-bookmark-make-menu-items): Return nil if there's no bookmark.

	* w3m-tabmenu.el (w3m-tab-menubar-dummy): Remove.
	(w3m-setup-tab-menu): Rewrite it so as to work properly with Emacs 22.
	(w3m-tab-menubar-update): Ditto; remove the iswitchb section.

2005-07-11  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-bookmark.el (w3m-bookmark-buffer): Disable undo before modify the
	buffer.
	(w3m-bookmark-menu-items-pre): New variable.
	(w3m-bookmark-menu-items-time): Ditto.
	(w3m-bookmark-make-menu-items): Use previous items if it available.

2005-07-09  Tsuyoshi CHO  <tsuyoshi_cho@yahoo.co.jp>

	* w3m-xmas.el (top): Add `w3m-setup-bookmark-menu' to autoload list at
	compiled time.
	(w3m-setup-menu): Append bookmark menu setup calling.

	* w3m-bookmark.el (top): Add requirement `easymenu' and
	`easy-menu-remove-item' autoload at compiled time.
	(w3m-bookmark-menu-open-new-session): Add new customize variable.
	(w3m-bookmark-menu-dummy-item): Add new const variable.
	(w3m-bookmark-menubar-dummy): Ditto.
	(w3m-bookmark-menu-items): Ditto, Define Bookmark const menu items.
	(w3m-setup-bookmark-menu): Add new autoload function.
	(w3m-bookmark-menubar-update): Add new function.
	(w3m-bookmark-iterator): Ditto.
	(w3m-bookmark-menu-open-item): Ditto.
	(w3m-bookmark-make-menu-items): Ditto.

	* w3m.el (top): Add `w3m-setup-bookmark-menu' to autoload list at
	compiled time.
	(w3m-menubar): Remove "Bookmark" menu item.

2005-07-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-print-current-url): Bind deactivate-mark.
	(w3m-print-this-url): Ditto.

2005-07-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-check-current-position): Bind deactivate-mark.  cf.
	<https://lists.gnu.org/archive/html/emacs-pretest-bug/2005-07/msg00109.html>

2005-07-05  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* ChangeLog: Add file local variables to set fill-column 74 and
	indent-tabs-mode t.

2005-07-03  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Add "technorati-*" entries.

2005-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-which-command): Make sure the command is not a
	directory.  cf. <URL:http://emacs-w3m.namazu.org/ml/msg08113.html>.

2005-06-26  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m.el (w3m-relationship-estimate-rules): Add a rule for Yahoo Search
	Beta.

2005-06-26  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m.el (w3m-relationship-estimate-rules): Improve regexp for Google
	in order to make the scroll-to-next-page feature work on Google News as
	well.

2005-06-26  Masayuki Ataka  <ataka@milk.freemail.ne.jp>
	    TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-search.el (w3m-search-engine-alist): Add Yahoo Beta.

2005-06-18  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Search Google News in US by
	"google news-en".

2005-06-17  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Add "google news" entry.

2005-06-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_PATH_EMACS): Check whether XEmacs works with the shy
	group regexp and runs call-process-region correctly.

	* w3m-perldoc.el (w3m-about-perldoc): Don't relieve buggy XEmacs 21.5
	for call-process-region.

	* w3m-xmas.el (w3m-fix-gif): Ditto.
	(w3m-initialize-graphic-icons): Ditto.

	* w3m.el (w3m-decode-encoded-contents): Ditto.
	(w3m-x-moe-decode-buffer): Ditto.
	(w3m-rendering-half-dump): Ditto.

	* w3mhack.el: Advise byte-optimize-form-code-walker to avoid the
	``...called for effect'' warnings for Emacs 21.4 as well as 21.3; don't
	relieve buggy XEmacs 21.5 for call-process-region.

2005-06-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make emacs-w3m not support the XEmacs versions older than 21.4.17
	or 21.5-b19.

	* aclocal.m4 (AC_PATH_EMACS): Check whether XEmacs runs the timer
	functions correctly.

	* w3m-util.el (w3m-cancel-refresh-timer): Use delete-itimer instead of
	cancel-timer under XEmacs.

	* w3m-xmas.el (call-process-region): Don't advise it.
	(w3m-run-at-time): Remove.

	* w3m.el (w3m-refresh-at-time): Use run-at-time instead of
	w3m-run-at-time.

	* w3mhack.el (w3mhack-byte-optimize-letX): Doc fix.

2005-06-09  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el: Update my mail address.

2005-06-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-antenna.el (w3m-antenna-mapcar): Remove unused temp var.

	* w3m-bookmark.el (w3m-bookmark-buffer): Remove
	file-coding-system-for-read.

	* w3m-form.el (w3m-form-input-textarea-save): Remove
	file-coding-system.
	(w3m-form-input-textarea): Ditto.

	* w3m-image.el (w3m-imagick-convert-buffer): Remove file-coding-system.
	(w3m-imagick-start-convert-buffer): Remove file-coding-system and
	jam-zcat-filename-list.

	* w3m.el (w3m-load-list): Remove file-coding-system-for-read.
	(w3m-save-list): Remove file-coding-system.
	(w3m-local-retrieve): Remove file-coding-system-for-read and
	jam-zcat-filename-list.
	(w3m-download): Remove file-coding-system and jam-zcat-filename-list.
	(w3m-copy-buffer): Remove unused temp var.

	* w3mhack.el (w3mhack-byte-optimize-letX): Remove file-coding-system,
	file-coding-system-for-read and pathname-coding-system.

2005-06-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-replace-in-string): Don't use eval-and-compile.
	(w3m-compare-strings): Ditto.
	(w3m-force-window-update): Alias to ignore if it is not defined.
	(w3m-force-window-update-later): New function.

	* w3m-favicon.el (w3m-favicon-retrieve): Use
	w3m-force-window-update-later.

	* w3m-proc.el (w3m-process-stop): Use w3m-force-window-update-later.

	* w3m.el (w3m-retrieve-and-render): Use w3m-force-window-update-later.
	(w3m-select-buffer-show-this-line): Always run w3m-force-window-update.

2005-06-09  Masatake YAMATO  <jet@gyve.org>

	* w3m-e21.el (w3m-initialize-graphic-icons): Highlight icon under
	mouse.

2005-06-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-mouse-face): New face.
	(w3m-setup-header-line): Use highlight face for bg color.
	(w3m-tab-line): Use w3m-tab-mouse-face.

2005-06-08  Masatake YAMATO  <jet@gyve.org>

	* w3m-e21.el (w3m-setup-header-line): Highlight url under mouse.
	(w3m-tab-line): Highlight tab under mouse.

2005-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-run-mode-hooks): New function.

	* w3m-form.el (w3m-form-input-select-mode): Use it.
	(w3m-form-input-map-mode): Use it.

	* w3m.el (w3m-mode): Use it.

2005-05-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-truncate-string): Autoload mule-util for
	truncate-string-to-width.

2005-05-26  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m.el (w3m-safe-view-this-url): `unsecure' -> `insecure'.
	(w3m-safe-toggle-inline-image): Ditto.
	(w3m-safe-toggle-inline-images): Ditto.

2005-05-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-menubar): Add the "Close Other Sessions" button.
	(w3m-delete-other-buffers): Run w3m-force-window-update.

2005-05-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* attic/vm-w3m.el (vm-w3m): Provide the feature.

	* attic/vm-7.19.patch: New file.

2005-05-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-open-all-links-in-new-session): Fix regexp.

2005-05-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bookmark.el (w3m-about-bookmark): Use shy group in regexp.

	* w3m-cookie.el (w3m-cookie-two-dot-domains-regexp): Ditto.
	(w3m-cookie-set): Ditto.

	* w3m-dtree.el (w3m-dtree-directory-name): Ditto.
	(w3m-about-dtree): Ditto.

	* w3m-favicon.el (w3m-favicon-setup): Ditto.

	* w3m-namazu.el (w3m-about-namazu): Ditto.

	* w3m-proc.el (w3m-process-filter): Ditto.

	* w3m-rss.el (w3m-rss-parse-date-string): Ditto.

	* w3m-util.el (w3m-html-string-regexp): Remove useless quotes.
	(w3m-parse-attributes): Don't use old fashioned backquotes; use shy
	group in regexp.
	(w3m-url-authinfo-regexp): Use shy group in regexp.

	* w3m-weather.el (w3m-weather-completion-table): Ditto.
	(w3m-weather-area-completion): Ditto.

	* w3m-xmas.el (w3m-fix-gif): Ditto.

	* w3m.el: Use shy group in regexp when examining w3m-command.
	(w3m-content-type-alist): Use shy group in regexp.
	(w3m-show-decoded-url): Ditto.
	(w3m-add-referer): Ditto.
	(w3m-relationship-estimate-rules): Ditto.
	(w3m-arrived-ignored-regexp): Ditto.
	(w3m-history-ignored-regexp): Ditto.
	(w3m-url-to-file-name): Ditto.
	(w3m-fontify-strike-through): Ditto.
	(w3m-fontify): Ditto.
	(w3m-url-completion): Ditto.
	(w3m-gmane-url-at-point): Ditto.
	(w3m-cache-header-delete-variable-part): Ditto.
	(w3m-cache-available-p): Ditto.
	(w3m-decode-buffer): Ditto.
	(w3m-local-dirlist-cgi): Ditto.
	(w3m-w3m-canonicalize-url): Ditto.
	(w3m-additional-command-arguments): Ditto.
	(w3m-download): Ditto.
	(w3m-check-header-tags): Ditto.
	(w3m-retrieve-and-render): Ditto.
	(w3m-create-text-page): Ditto.
	(w3m-view-this-url): Ditto.
	(w3m-open-all-links-in-new-session): Ditto.
	(w3m-external-view-file): Ditto.
	(w3m-edit-url): Ditto.
	(w3m-convert-ftp-url-for-emacsen): Ditto.
	(w3m-goto-url): Ditto.
	(w3m-goto-url-new-session): Ditto.
	(w3m-about-db-history): Ditto.
	(w3m-history-highlight-current-url): Ditto.

	* w3mhack.el: Fix the section adding dirs to load-path.
	(w3mhack-make-package): Use shy group in regexp.
	(w3mhack-makeinfo): Ditto.

2005-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (clean): Don't remove w3m-kwds.el.
	(.el.elc): Use batch-byte-compile instead of w3mhack-batch-compile.
	(very-slow): Don't run keywords.
	(keywords): Remove.

	* aclocal.m4 (AC_PATH_EMACS): Don't support Emacs 19 and 20.
	(AC_PATH_LISPDIR): Follow the change of the EMACS_FLAVOR value.
	(AC_PATH_ICONDIR): Ditto.
	(AC_CHECK_ELISP): Remove.
	(AC_CHECK_XML): Remove.

	* configure.in: Don't check for regexp-opt; don't run AC_CHECK_XML.

	* mime-w3m.el (mime-w3m-mode-map): Remove.
	(mime-w3m-local-map-property): Remove.
	(mime-w3m-preview-text/html): Don't use it.

	* octet.el (octet-decode-image): Ignore Emacs 19 and 20.

	* w3m-bitmap.el: Remove.

	* w3m-bookmark.el (w3m-bookmark-sections): Use point-at-eol.
	(w3m-bookmark-safe-string): Don't support Mule 2.3.
	(w3m-bookmark-current-number): Use point-at-eol.
	(w3m-bookmark-kill-entries): Use point-at-bol.

	* w3m-bug.el: Don't require w3m-om or w3m-e19.

	* w3m-ccl.el: Don't require w3m-om.

	* w3m-e19.el: Remove.

	* w3m-e20.el: Remove.

	* w3m-hist.el: Don't load w3m-kwds.el.

	* w3m-lnum.el (w3m-link-numbering): Don't support Emacs 20.

	* w3m-om.el: Remove.

	* w3m-proc.el: Don't require w3m-om or w3m-e19.

	* w3m-search.el (w3m-search-read-query): Use point-at-bol.

	* w3m-ucs.el: Ignore Emacs 20.

	* w3m-util.el: Don't load w3m-kwds.el; don't support Emacs 19.
	(w3m-use-tab-p): Ignore Emacs 19 and 20.
	(w3m-popup-window-p): Ditto.
	(w3m-add-w3m-initial-frames): Don't support Emacs 19.
	(after-make-frame-hook): Don't use it.
	(delete-frame): Don't advise it for Emacs 19 or 20.
	(w3m-truncate-string): Don't support Emacs 19 and 20.
	(w3m-default-face-colors): Remove.
	(w3m-replace-in-string): Don't support Emacs 19 and 20.

	* w3m-xmas.el (w3m-should-unoptimize-animated-gifs): Default to always
	t.
	(w3m-make-glyph): Use string-to-number instead of string-to-int.

	* w3m.el: Don't require w3m-e20, w3m-om or w3m-e19.
	(emacs-w3m-version): Reset to 1.4.50.
	(w3m-language): Ignore Mule 2.3.
	(w3m-history-current-url-face): Don't require wid-edit.
	(w3m-bold-face): Don't use w3m-default-face-colors.
	(w3m-underline-face): Ditto.
	(w3m-strike-through-face): Ditto.
	(w3m-use-symbol): Ignore Emacs 19 and 20.
	(w3m-show-decoded-url): Ditto.
	(w3m-use-tab): Doc fix.
	(w3m-entity-alist): Don't support Mule 2.3.
	(w3m-make-help-echo): Ignore Emacs version.
	(w3m-toggle-inline-images-internal): Ignore bitmap images.
	(w3m-resize-inline-image-internal): Don't support Emacs 19 and 20.
	(w3m-url-at-point): Always use ffap.
	(w3m-about-retrieve): Consider base64 codec is always available.
	(w3m-close-window): Don't support Emacs 19 and 20.
	(w3m-store-current-position): Use point-at-bol and point-at-eol.
	(w3m-buffer-setup): Ditto.
	(w3m-make-separator): Don't support Mule 2.3.
	(w3m-select-buffer-current-buffer): Use point-at-bol.
	(w3m-header-line-insert): Don't support Emacs 19 and 20.

	* w3mhack.el: Consider w3mhack-batch-compile is not used.
	(locate-library): Don't redefine it for Emacs 19.
	(APEL): Don't check for it for Emacs.
	(w3mhack-colon-keywords-file): Remove.
	(w3mhack-module-list): Ignore Emacs 19, 20, old XEmacsen and
	BITMAP-MULE.
	(w3mhack-shimbun-modules-using-rss): Remove.
	(current-column): Don't take care of it for old Emacsen.
	(w3mhack-compile): Don't run w3mhack-check-colon-keywords-file.
	(w3mhack-batch-compile): Remove.
	(w3mhack-nonunix-install): Ignore Emacs 19 and 20.
	(custom-declare-variable): Don't take care of it for Emacs 19.
	(locate-library): Ditto.
	(w3mhack-generate-colon-keywords-file): Remove.
	(w3mhack-check-colon-keywords-file): Remove.
	(w3mhack-load-path): Ignore Emacs 19, 20 and old XEmacsen.
	(w3mhack-makeinfo): Ignore Mule 2.3.

	* attic/regexp-opt.el: Remove.

	* attic/xml.el: Remove.

	* patches/mule-2.3@19.34.patch: Remove.

2005-04-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-remove-invisible-image-alt): New function.
	(w3m-rendering-buffer): Use it.

2005-04-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Decode "\240" into "&nbsp;".

2005-04-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-buffer): Decode `&#nnn;' entities in 128..159.

2005-04-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-detect-xml-charset): Return nil if the data don't look
	like xml contents.
	(w3m-compatible-encoding-alist): New variable.
	(w3m-decode-buffer): Always use w3m-detect-xml-charset; use a
	compatible encoding according to w3m-compatible-encoding-alist.

	* w3m-xmas.el (w3m-find-coding-system): Don't return binary for the nil
	argument.


2005-03-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Release emacs-w3m-1.4.4 from emacs-w3m-1_4 branch.

2005-03-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-setup-toolbar): Make sure icon files exist.
	(w3m-update-toolbar): Make sure toolbar items have been specified.
	(w3m-initialize-graphic-icons): Make sure icon files exist.

	* w3m-e21.el (w3m-setup-toolbar): Make sure icon files exist.
	(w3m-initialize-graphic-icons): Ditto.

2005-03-23  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (tarball): Remove `w3m-e23.el' instead of `w3m-e22.el'.

	* w3m.el (w3m-url-readable-string): Decide a scheme to guess encodings
	based on the target URL, instead of the current URL.
	(w3m-show-decoded-url): Doc fix to follow the above change.
	(w3m-copy-buffer): Do not set `w3m-current-url' and
	`w3m-current-coding-system'.
	(w3m-goto-url-new-session): Simplified.

2005-03-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (display-images-p): Remove alias.

2005-03-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (very-slow): Don't mv non-existent files.

	* w3m-e19.el (easy-menu-remove-item): Don't autoload it.

	* w3m-om.el (easy-menu-remove-item): Ditto.

	* w3m-rss.el (match-string-no-properties): Avoid warning for Emacs 19
	and XEmacs.
	(split-string): Avoid warning for Emacs 19.

	* w3m-symbol.el: Require cl when compiling.

	* w3m-tabmenu.el (easy-menu-remove-item): Aautoload it for Emacs 19.

	* w3m.el: Autoload widget-get to avoid compile warning for Emacs 19.
	(w3m): Remove unused bound variable.

	* w3mhack.el: Bind executable-binary-suffixes to the proper value for
	OS/2 and emx while checking for the shell command; cause an error only
	when compiling or formatting files.

	* attic/addpath.el: Make it work with old Emacsen even if cl is not
	loaded; load custom, bind defcustom'ed variables and make the
	locate-library function run quietly for Emacs 19; synch the code
	testing the shell command with w3mhack.el.
	(char-after): Add a byte-optimizer for Emacs 19.

	* w3m-ccl.el: Load w3m-om instead of autoloading it for charset-id.

	* w3m-util.el: Load cl independently when compiling.

2005-03-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Check whether the shell command can be used.

	* attic/addpath.el: Ditto; add early-package-load-path to load-path for
	XEmacs 21.5.

2005-03-17  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-favicon.el: Add autoload of `w3m-url-readable-string'.

2005-03-17  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>

	* w3m.el (w3m-check-header-tags): Check abnormal `base' url.

2005-03-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Add early-package-load-path to load-path for XEmacs 21.5.

	* w3m-xmas.el: Fbind coding-system-type to ignore if it is void.

2005-03-15  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-mee-new): Display clear signs of coding-system
	for `w3m-url-decode-string'.
	(w3m-form-mee-select-value): Ditto.
	(w3m-form-parse-and-fontify): Ditto.

	* w3m.el (w3m-decode-buffer): Decode the buffer within buffer set the
	`multibyte'.

2005-03-13  MIYOSHI Masanori  <miyoshi@meadowy.org>

	* doc/emacs-w3m-ja.texi (Sport Sites Supported by Shimbun): Update.

	* doc/emacs-w3m.texi (Sport Sites Supported by Shimbun): Ditto.

2005-03-12  MIYOSHI Masanori  <miyoshi@meadowy.org>

	* doc/emacs-w3m-ja.texi (Sport Sites Supported by Shimbun): Update.

	* doc/emacs-w3m.texi (Sport Sites Supported by Shimbun): Ditto.

2005-03-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Load w3m-e23.el(c) that exists in the same directory as
	w3m.el(c) so as to exclude ones in other places; report the precise
	error message if it doesn't exist.

2005-03-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-decode-coding-string-with-priority): Ignore
	`undecided' so as not to use it for the priority list.

2005-03-10  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-fsf.el (w3m-detect-coding-region): Guard error for `undecided'.

2005-03-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Remove the byte-optimizer which replaces truncate-string
	with truncate-string-to-width.

2005-03-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-modeline-title): Replace truncate-string-to-width with
	w3m-truncate-string.

	* w3m-util.el (w3m-truncate-string): Use truncate-string-to-width if it
	is available.

2005-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-info-like-map): Bind the `y' key to the
	w3m-print-current-url command; bind the `Y' key to the
	w3m-print-this-url command; don't bind the `c' key.

2005-03-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-make-help-echo): Fix the backquote form.
	(w3m-make-balloon-help): Ditto.

	* w3m-util.el (w3m-set-match-data): Use existing markers.

2005-03-04  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-url-readable-string): Save matching data.  Check whether
	`w3m-current-url' is string before checking it.
	(w3m-goto-url-new-session, w3m-copy-buffer): Call `w3m-goto-url' with
	`redisplay' option to enforce redisplaying the certain content.

	* w3m-favicon.el (w3m-favicon-retrieve): Decode an URL when displaying
	it.

	* w3m-form.el (w3m-form-input-textarea-mode-setup): An expression is
	evaluated without checking type, and save matching data.

2005-03-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-url-readable-string): Check whether
	`w3m-current-coding-system' is valid before calling
	`w3m-url-decode-string'.
	(w3m-local-dirlist-cgi, w3m-w3m-dump-extra): Use
	`w3m-url-readable-string'.
	(w3m-copy-buffer): Copy all buffer-local variables, and do not cancel
	them even if `empty' option is set.
	(w3m-display-progress-message): Import from w3m-util.el to suppress
	byte-compile warnings.

	* w3m-util.el (w3m-parse-attributes): Accept XHTML format of boolean
	atttibutes.
	(w3m-display-progress-message): Export to w3m.el.

2005-03-03  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-url-readable-string): An expression is evaluated without
	checking type.

2005-03-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-show-decoded-url): Update its customize spec to use it as
	the rule set to decode URIs when displaying them.  Changed its default
	value.
	(w3m-url-readable-string): New function to process the above option.
	(w3m-make-help-echo, w3m-make-balloon-help): Do not accept `url-decode'
	option, and use the above function to decore URIs.
	(w3m-fontify-anchors): Follow the above change.
	(w3m-print-current-url, w3m-print-this-url): Call the above function.
	(w3m-make-url-decode-function): Removed.
	(w3m-entity-alist, w3m-about-history): Remove redundant `function'.
	For more detail, see http://www.mew.org/~kazu/doc/elisp/function.html.

2005-03-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-modeline-title-string): New variable.
	(w3m-modeline-title-timer): New variable.
	(w3m-modeline-title): New function used to truncate the title string
	not to cut the right end of the mode line.  Works only with Emacs 22
	and newer.
	(w3m-buffer-setup): Use it.

2005-03-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-make-help-echo): Make it work with XEmacs.
	(w3m-make-balloon-help): Support decoding URIs.
	(w3m-fontify-anchors): Make the balloon-help show decoded URIs.

2005-03-02  ARISAWA Akihiro  <ari@mbf.ocn.ne.jp>

	* w3m.el (w3m-show-decoded-url): New user option.
	(w3m-make-url-decode-function): New inline function.
	(w3m-make-help-echo): Use it.
	(w3m-fontify-anchors): The function of help-echo property has an
	ability to decode url.

2005-03-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-decode-coding-string-with-priority): New function.

	* w3m.el (w3m-url-decode-string): Use it.

2005-03-01  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-w3m-attributes-1): Support `300 Multiple Choices'.
	(w3m-w3m-retrieve): Ditto.
	(w3m-w3m-retrieve-1): Ditto.

2005-02-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-detect-coding-region): Use the name of the coding
	system instead of the coding category if it is void.

	* w3m-util.el (w3m-set-match-data): New macro which converts points
	into markers under XEmacs.
	(w3m-search-tag-1): Use it.

	* w3m-e19.el: Autoload easymenu in order to avoid compile warning.
	* w3m-om.el: Ditto.

2005-02-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (all): Use `w3m-form-set-number' and `w3m-form-kill-buffer'
	instead of `w3m-form-textarea-set-number' and
	`w3m-form-textarea-kill-buffer'

	* w3m-form.el (w3m-form-input-select-urlid): New buffer local variable.
	(w3m-form-input-map-urlname): Ditto.
	(w3m-form-set-number): Rename from `w3m-form-textarea-set-number' and
	treate buffers of `select' and `map'.
	(w3m-form-kill-buffer): Ditto.
	(w3m-form-input-select-set): Allways remove own buffer.
	(w3m-form-input-select-exit): Ditto.
	(w3m-form-input-map-set): Ditto.
	(w3m-form-input-map-exit): Ditto.
	(w3m-form-input-select): When exists same from buffer, use it.
	(w3m-form-input-map): Ditto.

2005-02-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-what-where): Fix the form.
	(w3mhack-makeinfo): Silence it when formatting @multitable section.

2005-02-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (top): Add autoloads of `w3m-form-textarea-kill-buffer' and
	`w3m-form-textarea-set-number' to avoid byte-compile warnings.
	(w3m-delete-buffer): Call `w3m-form-textarea-kill-buffer' when use
	form.
	(w3m-delete-other-buffers): Ditto.
	(w3m-quit): Ditto.
	(w3m-select-buffer-delete-buffer): Ditto.
	(w3m-pack-buffer-numbers): Call `w3m-form-textarea-set-number' when use
	form.

	* w3m-form.el (top): Move all buffer local variables on the top to
	avoid byte-compile warnings.
	(w3m-form-parse-and-fontify): Set `w3m-form-use-textarea-backup-p' to
	nil.
	(w3m-form-input-textarea-save): Use `w3m-form-use-textarea-backup-p'
	instead of `w3m-form-use-textarea-backup'.
	(w3m-form-input-textarea-set): Allways remove textarea buffer and
	window.
	(w3m-form-input-textarea-exit): Ditto.
	(w3m-form-input-textarea): Check to call for backup. Check identity of
	existed textarea buffer and w3m buffer. Treat
	`w3m-form-use-textarea-backup-p'.
	(w3m-form-use-textarea-backup-p): New function.
	(w3m-form-textarea-set-number): Ditto.
	(w3m-form-textarea-kill-buffer): Ditto.
	(w3m-form-submit-get-textarea-files): If no backup, return nil.

2005-02-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el: Autoload cancel-timer for XEmacs.

	* w3m-xmas.el (w3m-run-at-time): Use run-at-time which comes from
	timer-funcs.el if it seems to work correctly.
	(cancel-timer): Defun if it is void.

2005-02-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/ptexinfmt.el (texinfo-multitable-widths): Reverse the logic that
	shows whether it is broken.

	* w3m-util.el: Autoload regexp-opt for Emacs 19.

	* w3mhack.el (w3mhack-makeinfo): Load poe for Emacs 19.

2005-02-24  Romain Francoise  <romain@orebokech.com>

	* w3m.el (w3m-lynx-like-map): Bind [follow-link] so as to make mouse-1
	work in Emacs 22 like mouse-2.
	(w3m-info-like-map): Ditto.

2005-02-23  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-antenna.el (w3m-antenna-check-rss): Parse all date fields.

2005-02-21  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-form.el (w3m-form-input-textarea): Fix.

2005-02-21  Tsuyoshi CHO  <tsuyoshi_cho@ybb.ne.jp>,
	Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-input-textarea-mode-setup): Fix.
	(w3m-form-input-textarea): Follow the above change.

2005-02-21  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-form.el (w3m-form-textarea-edit-mode): Changed its default value
	to `text-mode'.

2005-02-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install-package): Change the default directory in which
	icon files will be installed from `etc/w3m/icons/' into
	`etc/images/w3m/' following the most recent Emacs and Gnus.
	(install-package-ja): Ditto.

	* aclocal.m4 (AC_EXAMINE_PACKAGEDIR): Use configure-package-path.
	(AC_PATH_ICONDIR): Change the default directory in which icon files
	will be installed from `etc/w3m/icons/' into `etc/images/w3m/'
	following the most recent Emacs and Gnus.

	* w3m.el (w3m-icon-directory): Improve the way to determin the default
	value.

	* w3mhack.el (w3mhack-nonunix-install): Change the default directory in
	which icon files will be installed from `etc/w3m/icons/' into
	`etc/images/w3m/' following the most recent Emacs and Gnus.
	(w3mhack-make-package): Ditto.
	(w3mhack-what-where): Ditto.

2005-02-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-lnum.el: Rename from w3m-link-numbering.el.

	* mime-w3m.el: Load mime-parse.el before mime.el and w3m.el when
	compiling rather than always loading mime.el and w3m.el.

2005-02-16  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-form.el: Changes to define `w3m-form-input-textarea-mode' as a
	minor mode.
	(w3m-form-textarea-edit-mode): New option.
	(w3m-form-input-textarea-map): Renamed from
	`w3m-form-input-textarea-keymap'.
	(w3m-form-input-textarea-mode) [variable]: New internal variable.
	(w3m-form-input-textarea-mode) [function]: Reconstructed.
	(w3m-form-input-textarea-mode-setup): New function.
	(w3m-form-input-textarea): Clean up.

2005-02-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_PATH_EMACS): Show the correct Emacs version.

	* mime-w3m.el: Always require mime and w3m instead of to autoload
	mime-parse.el.

	* w3m-bitmap.el: Bind w3m-work-buffer-list when compiling.

	* w3m-proc.el: Silence the byte compiler complaining against gensym.

	* w3m-rss.el: Use eval-and-compile in order to autoload timezone.el.

	* w3m.el (w3m-treat-drive-letter): Use eval-and-compile.
	(w3m-touch-file-available-p): Move forward.
	(w3m-touch-file): Ditto.
	(w3m-expand-path-name): Use eval-and-compile.
	(w3m-window-hscroll): Ditto.
	(w3m-current-column): Ditto.
	(w3m-set-window-hscroll): Ditto.
	(w3m-add-local-hook): Silence the byte compiler.
	(w3m-run-at-time): Use eval-and-compile.

	* w3mhack.el: Remove the code used to silence the byte compiler which
	complains make-local-hook is obsolete.
	(w3mhack-makeinfo): Silence XEmacs when formatting Infos.

	* octet.el: Require cl when compiling.
	* w3m-filter.el: Ditto.
	* w3m-fsf.el: Ditto.
	* w3m-link-numbering.el: Ditto.
	* w3m-namazu.el: Ditto.

2005-02-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Load w3m-e23.el for Emacs 23.

	* w3mhack.el (w3mhack-module-list): Use w3m-e23.el for Emacs 23.

	* w3m-e23.el: Rename from w3m-e22.el.

2005-02-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Load w3m-e21.el even if the version of Emacs is 22.x when the
	Emacs CVS HEAD is used.

	* w3mhack.el (w3mhack-module-list): Prefer w3m-e21.el rather than
	w3m-e22.el if the Emacs CVS HEAD is used.

2005-02-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-html-skelton): Fix typo.
	(w3m-antenna-make-contents): Replace %D to the modified time of
	`w3m-antenna-file'.

2005-02-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-gmane-url-at-point): New function.
	(w3m-url-at-point): Use it.

2005-01-30  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m.el (w3m-attributes): Support cid urls.
	(w3m-external-view): Ditto.

2005-01-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-force-window-update): Make it work whatever the value
	for the resize-mini-windows variable is.
	(w3m-update-tab-line): Ditto.

2005-01-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-rss.el (w3m-rss-parse-date-string): Support the date format in
	the RFC822 style which RSS 2.0 allows.  Suggested by David Hansen
	<david.hansen@physik.fu-berlin.de>.

2005-01-23  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-e21.el (w3m-force-window-update, w3m-update-tab-line): Call
	`enlarge-window' before calling `shrink-window', in order to avoid
	deleting sole window.

2005-01-19  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-content-type-alist): Check if "fiber.exe" is exist.

2005-01-17  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-form.el (w3m-form-parse-and-fontify): Check if w3m-current-url is
	available.

2004-07-24  Tsuyoshi CHO  <mfalcon_sky@emailuser.net>

	* w3m.el (w3m-menubar): Rearrange it hierarchical.
	(w3m-setup-menu): Use easymenu.

2005-01-10  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-input-textarea): Modify string of the inquiry.

2005-01-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-goto-url): Call `w3m-form-textarea-files-remove' if
	necessary.

	* w3m-util.el (w3m-compare-strings): New define.

	* w3m-form.el (w3m-form-textarea-file-expire-date): Modify Document.
	(w3m-fontify-textareas): Put `w3m-form-file-name' property.
	(w3m-form-textarea-files, w3m-form-textarea-post-files): New buffer
	local variable.
	(w3m-form-parse-and-fontify): Set `w3m-form-textarea-files'. Put
	`w3m-form-file-name' property on the form of textarea.
	(w3m-form-input-textarea): Use same textarea buffer if exist.  Don't
	ask user if don't modify its area without tailed white space.  Visible
	the editted text when ask user. Guard against 'C-g'.  Added
	`w3m-form-textarea-file-cleanup' to hook as `kill-emacs-hook'
	(w3m-form-textarea-same-check): New function.
	(w3m-form-textarea-file-cleanup): Remove myself from `kill-emacs-hook'.
	(w3m-form-textarea-files-remove): New function.
	(w3m-form-submit-get-textarea-files): Ditto.
	(w3m-form-submit): Set `w3m-form-textarea-post-files' for removing
	files.
	(w3m-form-resume): Check `selects' is cons.

2005-01-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/Makefile.in (.texi.info): Set LC_ALL=C.

2004-12-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-quit): Call `w3m-form-textarea-file-cleanup'.
	(w3m-view-this-url-1): Revert final change.

	* w3m-form.el (w3m-form-textarea-file-expire-date): New user option.
	(w3m-form-textarea-file-cleanup): New function.

2004-12-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-use-textarea-backup): New user option.
	(w3m-form-textarea-directory): Ditto.
	(w3m-form-get-coding-system): New function.
	(w3m-form-make-form-data): Use `w3m-form-get-coding-system'.
	(w3m-form-input-textarea-keymap): Define "C-xC-s" to
	`w3m-form-input-textarea-save'.
	(w3m-form-input-textarea-file): New variable.
	(w3m-form-input-textarea-coding-system): Ditto.
	(w3m-form-input-textarea-filename): New function.
	(w3m-form-input-textarea-save): Ditto.
	(w3m-form-input-textarea-set): Call `w3m-form-input-textarea-save'.
	(w3m-form-input-textarea-exit): Ditto.
	(w3m-form-input-textarea-mode): Modify doc-string.
	(w3m-form-input-textarea): Handling filename and coding-system.

2004-12-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-this-url-1): Revert 2004-12-17 change.  The buffer
	seems empty killed before to restore window configuration.  Restore the
	position and window-start if last window equal current-window.

2004-12-24  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-hist.el (w3m-history-restore-position): Handling the window of
	w3m for sure absolutely.

2004-12-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Revert.

2004-12-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Bind undo-outer-limit.

2004-12-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Local file is given special treatment
	for `href'. Fix match data of `href'.
	(w3m-view-this-url-1): If the points of window was treated in
	w3m-goto-url(), now reconstruct window configuration.

2004-12-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-update-tab-line): Wobble the window size instead of
	setting the cursor color.

2004-12-15  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-namazu.el (w3m-namazu): Added optional argument `reload'.

2004-12-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-tag-regexp-of): Remove.
	(w3m-search-tag-1): New function.
	(w3m-search-tag): New macro.

	* w3m-form.el (w3m-form-parse-and-fontify): Use w3m-search-tag instead
	of w3m-tag-regexp-of.

2004-12-10  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Use 'w3m-name-anchor2 property to avoid
	overriding 'w3m-name-anchor property.
	(w3m-search-name-anchor): Search 'w3m-name-anchor2 property if not
	detect 'w3m-name-anchor property.

2004-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-parse-and-fontify): Ignore a select form in the
	case where w3mmee is running if its value is not specified.  Reported
	by Clemens Fischer <ino-qc@spotteswoode.de.eu.org>.

	* w3mhack.el (labels): Remove.

2004-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (labels): A temporary substitution against the Emacs CVS
	bug.

2004-11-26  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m-form.el (w3m-form-resume): Check whether a form exists, before
	resuming its values from its history.

2004-11-21  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-rss.el: New file.

	* w3m-antenna.el (w3m-antenna-check-rss): New function.
	(w3m-antenna-sites): Improve its customize spec to support
	`w3m-antenna-check-rss'.

	* w3m.el (w3m-content-type-alist): Add text/xml, application/xml,
	application/rdf+xml, and application/rss+xml.
	(w3m-detect-xml-charset): New function.
	(w3m-decode-buffer): Use the above function when decoding XML contents.

2004-11-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-redisplay-this-page): Don't make a new history.

2004-11-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-output-coding-system): Use `utf-8' if Emacs has internal
	utf-8 only.
	(w3m-input-coding-system): Revert last change.
	(w3m-halfdump-command-arguments): Bind `fix_width_conv' and
	`use_jisx0201' when w3m-m17n.

2004-11-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-input-coding-system): Use `utf-8' if Emacs has internal
	utf-8, it has no Mule-UCS and w3m-type is `w3m-m17n'.

2004-11-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-char-to-int, w3m-string-to-char-list,
	w3m-int-to-char): Silence byte-compiler.
	* w3m-ccl.el (charset-id): Ditto.

	* w3m-tabmenu.el (w3m-tab-menubar-update): Don't let iswitchb manage
	the w3m tab menubar.

2004-10-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-check-refresh-attribute): Support own page reload.
	(w3m-goto-url-with-timer): Ditto.

2004-10-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_ADD_LOAD_PATH): Clarify the error message.

2004-10-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (call-process-region): Add an advice in order to fix an
	XEmacs 21.5.18 bug.
	* w3mhack.el (call-process-region): Ditto.

2004-10-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-check-refresh-attribute): Fix to analyze the URL.

2004-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-touch-file): Protect against the absence of
	file-name-coding-system and default-file-name-coding-system.

2004-10-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-buffer-setup): Modify `mode-line-buffer-identification';
	display "Loading..." instead of `w3m-current-titile' when process of
	w3m active.

2004-10-16  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-touch-file): Use `set-file-times' if available; bind
	`coding-system-for-write' while calling `w3m-touch-command'.

2004-10-08  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-perldoc.el (w3m-perldoc-input-coding-system)
	(w3m-perldoc-output-coding-system): New options.
	(w3m-about-perldoc): Use the above options, to display both modules
	encoded in EUC-JP and ones encoded in UTF-8 correctly.

2004-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-line): Replace "%" with "%%" in
	w3m-tab-line-format.

2004-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve): Add autoload cookie.

2004-10-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-search.el (w3m-search-engine-alist): Add the parameter
	`ie=Shift_JIS' to Google for Japanese users.

2004-09-21  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-antenna.el (w3m-about-antenna): Revert 2004-09-16 change.

2004-09-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-antenna.el (w3m-about-antenna): Change the method to compare an
	arrived time to a last-modified time.

2004-09-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Don't make a new history when reloading.
	(w3m-reload-this-page): Ditto.

	* w3m-hist.el (w3m-history-restore-position): Don't cause an error even
	if a page has shrunk.


2004-08-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.4.3 from emacs-w3m-1_4 branch.

2004-08-15  Kazuhiro UCHIDA  <kayoujin@yahoo.co.jp>

	* w3m.el (w3m-remove-meta-charset-tags): Check that a content field has
	a valid value before parsing it.

2004-08-12  Romain Francoise  <romain@orebokech.com>

	* w3m.el (w3m-relationship-estimate-rules): Improve regexp for Google
	in order to make the scroll-to-next-page feature work on Google Groups
	as well.

2004-08-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-relationship-estimate-rules): Fix regexp for Google.
	Suggested by Romain Francoise <romain@orebokech.com>.

2004-08-02  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el (slanted): Rename @s to @slanted.

2004-07-30  Romain Francoise  <romain@orebokech.com>

	Enable emacs-w3m to be built with Emacs --without-x.

	* w3m-e21.el (image-size): Alias to ignore if it is not available.

	* w3m-favicon.el (w3m-favicon-type): Don't use image-types if it is not
	available.

	* w3m.el (mouse-set-point): Autoload mouse.elc.

2004-07-20  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Support @s.


2004-07-14  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.4.2 from emacs-w3m-1_4 branch.

	* w3m.el (w3m-w3m-canonicalize-url): Revival.
	(w3m-w3m-attributes, w3m-w3m-retrieve): Call the above.
	(w3m-canonicalize-url): Do not check a slash.

2004-07-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-detect-meta-charset): Check that a content field has a
	valid value before parsing it.

2004-07-08  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>
	Suggested by Tatsuya Kinoshita <tats@vega.ocn.ne.jp>

	* w3m.el (w3m-correct-charset-alist): Reverse "windows-125x" and
	"cp125x".


2004-07-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.4.1 from emacs-w3m-1_4 branch.

2004-07-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-weather.el: Reconstructed to follow the change of site design.
	(w3m-weather-completion-table, w3m-weather-filter-functions): Update.
	(w3m-weather-extract-contents, w3m-weather-adjust-contents): New
	functions.
	(w3m-weather-remove-headers, w3m-weather-remove-footers,
	w3m-weather-get-seikatu-sisu, w3m-weather-insert-seikatu-sisu):
	Removed.

2004-06-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-canonicalize-url): Don't make sure arg is a string.
	(w3m-input-url): Don't use w3m-canonicalize-url for non-string url
	which may be the symbol popup.

2004-06-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-canonicalize-url): New function.
	(w3m-input-url, w3m-browse-url): Call the above.
	(w3m-w3m-canonicalize-url): Abolished.
	(w3m-w3m-attributes, w3m-w3m-retrieve): Do not call the abolished
	function.
	(w3m-url-hierarchical-schemes): Add `ftps'.

2004-06-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-add-w3m-initial-frames): Share the opened frame in
	w3m-initial-frames over all emacs-w3m buffers if w3m-use-tab is
	non-nil.
	(w3m-delete-w3m-initial-frames): New function; add it to
	delete-frame-functions or delete-frame-hook, or merge into delete-frame
	using defadvice.
	(w3m-delete-frames-and-windows): Return to the former buffer after
	performing walk-windows; don't manage w3m-initial-frames.

	* w3m.el (w3m-delete-buffer): Don't manage w3m-initial-frames.

2004-06-14  Yoichi NAKAYAMA  <yoichi@geiin.org>

	* w3m.el (TopLevel): Display meaningful message when w3m-command is
	nil.

2004-06-21  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-fontify): Call `w3m-replace-symbol' before
	`w3m-fontify-anchors' in order not to lose text properties.

2004-06-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m): Run w3m-mode before popping to the newly created buffer
	up.

2004-06-12  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-output-coding-system): Change default value for w3m-m17n.

	* w3m-bug.el (report-emacs-w3m-bug-system-informations): Add
	w3m-input-coding-system and w3m-output-coding-system.

2004-06-11  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-meta-content-type-charset-regexp)
	(w3m-meta-charset-content-type-regexp)
	(w3m-meta-refresh-content-regexp)
	(w3m-meta-content-refresh-regexp): Removed.
	(w3m-detect-meta-charset, w3m-remove-meta-charset-tags)
	(w3m-check-refresh-attribute): Use `w3m-parse-attributes' instead of
	above regexp.
	(w3m-rendering-buffer): Don't call `w3m-remove-meta-charset-tags' for
	w3m-m17n.

2004-06-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-make-new-session): Doc fix.
	(w3m-safe-view-this-url): Use w3m-goto-url-new-session only when a user
	invokes this command in a buffer not being running the w3m-mode.

2004-06-07  Masatake YAMATO  <jet@gyve.org>

	* w3m-hist.el (w3m-history-store-position): Fix a wrong message.

2004-06-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-filter.el (w3m-filter-rules): Relax the condition.

2004-06-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-make-new-session): Doc fix.
	(w3m-safe-view-this-url): Use w3m-goto-url-new-session instead of
	w3m-goto-url when w3m-make-new-session is non-nil.

2004-06-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-make-new-session): New user option.
	(w3m): Make a new emacs-w3m buffer if w3m-make-new-session is non-nil
	and a user specifies a url string.

2004-06-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-popup-buffer): Don't use focus-frame in Emacs.

2004-06-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-wait-discard-input): Abolish.
	(w3m-process-wait-process): Don't use accept-process-output to make it
	possible to show progress messages; discard key press events while
	waiting for finishing of a process.

2004-05-24  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-form.el (w3m-form-put-by-name): Overwrite ID value when a name is
	found.

2004-05-22  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-fontify): Remove tags in the form element except for
	textarea.

2004-05-18  Katsumi Yamaoka  <yamaoka@jpl.org>
	Suggested by Yoichi NAKAYAMA <yoichi@geiin.org>

	* w3m-util.el (w3m-replace-in-string): New function which is a copy of
	shimbun-replace-in-string.
	* w3m.el (w3m-active-region-or-url-at-point): Use it; remove all
	whitespace in region.

2004-05-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-view-inline-image): Bind mew-use-text/html as t.

2004-05-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-home-page): Improve the customizing widget.

2004-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-expand-url): Bind file-name-handler-alist as nil.

2004-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-arrived-ignored-regexp): Add about:blank.
	(w3m-history-ignored-regexp): Ditto.
	(w3m-about-retrieve): Ditto.
	(w3m-buffer-setup): Prefer the last visited emacs-w3m buffer.

2004-05-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-filter.el (w3m-filter-rules): Update its default value and its
	customize spec.

2004-05-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-w3m-dump-extra): Examine image data briefly to detect
	only gif, jpeg and png by itself.

	* w3m-util.el (w3m-image-type-from-data): Abolish.

2004-05-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-dump-extra): Check only 300 bytes at the top of the
	data.

2004-05-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-image-type-from-data): New function.  Suggested by
	KOSEKI Yoshinori <kose@meadowy.org>.

	* w3m.el (w3m-w3m-dump-extra): Use it.

2004-05-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-start-process): Use
	set-process-query-on-exit-flag if it is available.

	* w3m.el (w3m-w3m-dump-extra): Trust the magic at the beginning of
	image data rather than the content-type header.

2004-05-11  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-copy-buffer): Prefer cached contents without checking
	their validity.

2004-05-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-waited): Revival.
	(w3m-process-with-wait-handler): Set t to the above.

	* w3m.el (w3m-w3m-dump-extra): Check the above.

2004-04-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (emacs-w3m-version): Reset.


2004-04-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.4 from emacs-w3m-1_4 branch.

	* Makefile.in (install-package): Install w3m-load.el.
	(dist, tarball): Reimplemented, in order to keep time stamps of source
	files.

	* w3mhack.el (w3mhack-generate-xemacs-load-file): Simplified.

2004-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-generate-xemacs-load-file): Replace
	`replace-string' with basic functions.

2004-04-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-generate-xemacs-load-file): New function.
	(w3mhack-make-package): Use `w3mhack-generate-xemacs-load-file.

2004-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-update-files-autoloads): New function.
	(w3mhack-generate-load-file): Use `w3mhack-update-files-autoloads'.

2004-04-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (tarball): Remove w3m-kwds.el and w3m-load.el.

	* configure.in, aclocal.m4: Add `--with-xml' option.

	* w3mhack.el (w3mhack-module-list): New function.
	(w3mhack-examine-modules): Use the above.
	(w3mhack-compile): Use `w3mhack-module-list' instead of
	`w3mhack-examine-modules'.
	(w3mhack-generate-load-file): Likewise; Insert ^L to avoid an error of
	`update-file-autoloads' of old emacsen.

2004-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-treat-image-size): Default to t.

	* w3m-filter.el (w3m-filter-asahi-shimbun): Use marker to limit the
	search bound.

2004-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-generate-load-file): Save w3m-load.el file before
	performing `update-file-autoloads'.

2004-04-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (install-lisp): Do not install w3mhack.el.
	(install-package): Install neither w3mhack.el nor w3m-load.el.

2004-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-treat-image-size): Default to nil.
	(w3m-rendering-half-dump): Fix a logic determining whether to specify
	`-ppl' and `-ppc' options to the w3m command.

2004-04-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el: Create w3m-load.el.
	(w3mhack-load-file): New variable.
	(w3mhack-examine-modules): Ignore `w3mhack-load-file'.
	(w3mhack-generate-load-file): New function.
	(w3mhack-compile): Call the above.

	* .cvsignore: Ignore w3m-load.el.

	* Makefile.in (clean): Remove w3m-load.el.

2004-04-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-expand-path-name): In Emacs, don't bind
	directory-sep-char which is an obsolete variable.

2004-04-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el, w3m-favicon.el: Move snippets managing
	`w3m-arrived-setup-functions' and `w3m-arrived-shutdown-functions' from
	w3m.el into w3m-favicon.el.

2004-04-23  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-hns-last-modified): Use 32400 as a
	correct timezone instead of JST (suggested by YAMAOKA-san).

2004-04-22  Christian Schmitt  <Christian.Schmitt@Dresdner-Bank.com>

	* w3m.el (w3m-expand-path-name): Bind directory-sep-char to `?/'.  It
	is `?\' by default in XEmacs on Windows (native, not Cygwin).

2004-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-use-symbol): Don't activate it in Emacs 20.  Advised by
	Arisawa-san.

2004-04-21  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Simplify the rule of sending referers.
	(w3m-add-referer-regexps): Abolished.
	(w3m-add-referer-predicate-function): Abolished.
	(w3m-add-referer): New option.
	(w3m-add-referer-p): New function.
	(w3m-add-referer-predicate-by-referer-regexps): Removed.
	(w3m-add-referer-predicate-by-hosts): Removed.
	(w3m-request-arguments, w3m-header-arguments): Follow the above
	changes.

2004-04-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-add-w3m-initial-frames): Get the correct value for
	the newly created frame in Emacs 19.

	* w3m.el (w3m-about-retrieve): Load base64 for Emacs 19.
	(w3m-minor-mode-command-alist): Add w3m-print-this-url.

	* w3m-bitmap.el (w3m-bitmap-image-insert): Don't put the evaporate
	property on empty overlays (revert 2004-04-07 change).

2004-04-20  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-link-numbering.el (w3m-view-numbered-link): Removed.
	(w3m-move-numbered-anchor): New command.
	(w3m-link-numbering-mode-map): Use `w3m-move-numbered-anchor' instead
	of `w3m-view-numbered-link'.

2004-04-19  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-input-coding-system): Use `w3m-output-coding-system' as
	its default value for w3m-m17n and w3mmee.
	(w3m-halfdump-command-arguments): Use "-I" option to disable
	automatic-detection of coding systems for w3m-m17n and w3mmee.

2004-04-16  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-meta-refresh-content-regexp): Allow quoted string as url.
	(w3m-meta-content-refresh-regexp): Ditto.
	(w3m-check-refresh-attribute): Decode entities.

2004-04-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-link-numbering.el (w3m-link-numbering): Quit when links have
	already been numbered.

2004-04-14  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-link-numbering.el (w3m-link-numbering-mode): Delete all overlays
	that display link numbers, when deactivating.

2004-04-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-link-numbering.el (w3m-link-numbering): Add face to before-string
	correctly under XEmacs; don't bother to delete overlays (suggested by
	TSUCHIYA-san).

2004-04-14  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-link-numbering.el (w3m-link-numbering-face): New face.
	(w3m-link-numbering): Use it.

2004-04-14  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-link-numbering.el: New file.

	* w3m.el (w3m-browse-url): Load `browse-url' before calling
	`browse-url-interactive-arg'.

2004-04-12  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Support @indicateurl, @LaTeX, @ordf, @ordm.  @url
	is now a synonym for @uref.

2004-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify-anchors): No need to enable evaporation of
	overlays in XEmacs.

2004-04-08  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* w3m.el (w3m-delete-all-overlays): Revert.
	(w3m-highlight-current-anchor): Ditto.

2004-04-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-all-overlays): Remove.

2004-04-07  Masatake YAMATO  <jet@gyve.org>

	* w3m-bitmap.el (w3m-bitmap-image-insert): Enable the evaporate
	property on overlays.

	* w3m-e21.el (w3m-form-make-button): Enable the evaporate property on
	buttun overlays.

	* w3m.el (w3m-fontify-anchors): Ditto.
	(w3m-create-text-page): No need to delete zombie overlays.
	(w3m-create-image-page): Ditto.
	(w3m-highlight-current-anchor-1): Enable the evaporate property on
	overlays.
	(w3m-highlight-current-anchor): No need to delete overlays.

2004-04-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-rendering-extract-title): Remove too much whitespace.

2004-04-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-all-overlays): Simply delete all overlays if the
	optional arg is given.
	(w3m-create-text-page): Delete zombie overlays.
	(w3m-create-image-page): Ditto.

2004-04-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Improve custom.

2004-04-04  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-search.el (w3m-search-engine-alist): Add "amazon" entry.

2004-03-31  Yuya Nishida  <yuya@j96.org>

	* w3m-search.el (w3m-search-engine-alist): Add "amazon-ja" entry;
	"PostData" can be specified.
	(w3m-search): Support post-data.

2004-04-04  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-header-arguments): Set unibyte at work buffer.

	* w3m-form.el (w3m-form-make-form-data): Set unibyte at work buffer;
	Encode form data.

2004-03-22  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-type): Check if w3m-compile-options contains "m17n".

2004-03-19  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-add-referer-regexps): Fix typo.
	(w3m-add-referer-predicate-function): New user option.
	(w3m-add-referer-predicate-by-referer-regexps): New function.
	(w3m-add-referer-predicate-by-hosts): Ditto.
	(w3m-request-arguments): Call w3m-add-referer-predicate-function.
	(w3m-header-arguments): Ditto.

	* octet.el (mime-view-octet): Avoid redundant invocation of
	`mime-entity-content'.

2004-03-14  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-symbol.el (w3m-mule-unicode-symbol): Fixed 32th character.
	Thanks to Taichi KAWABATA for his report.

2004-03-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-weather.el (w3m-weather-get-seikatu-sisu): Relax regular
	expressions to extract indices, to follow the change of the site
	design.

2004-03-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-force-window-update): New function.
	(w3m-tab-drag-mouse-function, w3m-tab-click-mouse-function,
	w3m-tab-line, w3m-e21-switch-to-buffer, w3m-select-buffer-hook): Use
	`w3m-force-window-update' instead of `w3m-e21-wobble-window-size'.
	(w3m-e21-wobble-window-size): Abolish.

	* w3m-favicon.el (w3m-favicon-retrieve): Use `w3m-force-window-update'.

	* w3m-proc.el: Autoload `w3m-force-window-update' when compiling.
	(w3m-process-stop): Use `w3m-force-window-update'.

	* w3m.el (w3m-select-buffer-show-this-line): Use
	`w3m-force-window-update'.


2004-02-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (emacs-w3m-version): Release 1.3.85.

2004-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-drag-mouse-function): Call
	`w3m-e21-wobble-window-size'.
	(w3m-tab-click-mouse-function): New function.
	(w3m-tab-make-keymap): Use it.

2004-02-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-mee-new): Use `w3m-form-normalize-action' for
	action.

2004-02-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-select-buffer-show-this-line): Call
	`w3m-e21-wobble-window-size' when Emacs 21 or 22 is running.

	* w3m-e21.el (w3m-tab-line-format): Make it buffer-local variable.
	(w3m-tab-timer): Ditto.
	(w3m-e21-wobble-window-size): New function.
	(w3m-tab-line): Make `w3m-tab-timer' hold boolean value; let a timer
	function run certainly in a buffer in which a timer started; use
	`w3m-e21-wobble-window-size'.
	(w3m-e21-switch-to-buffer): New command.
	(w3m-e21-subst-switch-to-buffer-keys): New function.
	(w3m-mode-setup-functions): Add `w3m-e21-subst-switch-to-buffer-keys'.
	(w3m-select-buffer-hook): Add `w3m-e21-wobble-window-size'.
	(w3m-spinner-image-index): Make it buffer-local variable.

2004-02-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-make-form-data): Align form by the number of
	`hseq'.

2004-02-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-sites): Add
	`w3m-antenna-check-another-page' to its customize spec.
	(w3m-antenna-check-another-page): New function.
	(w3m-about-antenna): Relaxed the condition to check changed sites.
	(w3m-antenna-add): Add a new site at the end of `w3m-antenna-sites'
	instead of adding it at the top.

2004-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-antenna.el (w3m-antenna-function): New widget.
	(w3m-antenna-sites): Use it.

2004-02-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-expand-path-name): Protect expand-file-name from
	cygwin-mount.el's behavior on Windows.

	* w3m-antenna.el (w3m-about-antenna): Check arrived-time if no
	last-modified.

2004-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-antenna.el (w3m-antenna-sites): Fix mis-implemented customizing
	widgets in Emacs 20.7 through 21.3 and XEmacs.
	(w3m-antenna-add): Support Emacs 20.

	* w3m-util.el (widget-default-get): Remove advice.

2004-02-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (widget-default-get): Advise the function to fix a bug in
	Emacs 21.1 through 21.3.

2004-02-17  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-resume): Fix for checkbox.

2004-02-11  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: Support @docbook, @ifdocbook, @ifnotdocbook, and
	@registeredsymbol.

2004-02-10  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-active-region-or-url-at-point): Move the point backward
	from the end of the active region instead of moving it forward, in
	order to avoid enlarging the region.

2004-02-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-active-region-or-url-at-point): Find a url-like string in
	the region instead of extracting the whole substring when the region is
	active.  Don't use `w3m-url-at-point' for that since it doesn't work
	for all url string.
	(w3m-quit): Delete frames seemingly fast.

2004-02-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-favicon.el (w3m-favicon-retrieve): Because some broken servers
	provide empty contents as their favicons, check the length of the
	retrieved content, before calling `w3m-favicon-convert'.

2004-02-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Changes to validate cached contents.
	(w3m-follow-cache-control-header): Abolished.
	(w3m-prefer-cache): New option.
	(w3m-cache-available-p): Check whether a cached header includes cache
	control headers.
	(w3m-w3m-dump-extra): Always cache both a header and a content.
	(w3m-w3m-retrieve-1): Check whether a cache is available, before using
	it.
	(w3m-view-this-url): When visiting history pages, prefer cached
	contents without checking their validity.
	(w3m-view-previous-page, w3m-view-source, w3m-view-header): Prefer
	cached contents without checking their validity.

2004-02-05  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-show-error-information): Decode cache contents if
	necessary.

2004-02-05  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-edit-url): Define as a command.

2004-02-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-examine-modules): Exclude w3m-e22.el except for
	Emacs 22.

2004-01-31  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-edit-function-alist): New option.
	(w3m-edit-url): Refer the above alist to find a suitable function for
	editing a specified page.
	(w3m-edit-function, w3m-edit-current-url): Its docstring is modified to
	follow the above change.
	(w3m-edit-this-url): Its docstring is modified likewise, and it is
	simplified.
	(w3m-goto-url): Ignore cached form data when reloading.

	* w3m.el (w3m-safe-view-this-url): Call `w3m-goto-url' when a function
	set to `w3m-goto-article-function' returns nil.

2004-01-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Changes to follow anchors that point Shimbun articles.
	(w3m-goto-article-function): New variable.
	(w3m-safe-view-this-url): Refer the above.

2004-01-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-follow-cache-control-header): New option.
	(w3m-w3m-dump-extra): If `w3m-follow-cache-control-header' is nil, do
	not follow the chache control headers.

2004-01-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (tarball): Because Emacs-22 has not been released, remove
	w3m-e22.el from the creating tarball.

2004-01-27  Taichi KAWABATA  <batta@beige.ocn.ne.jp>

	* w3m-e22.el: New file.  This file is simply the copy of w3m-e21.el
	except that the ccl section has been removed.

	* w3m.el: Require w3m-e22 when Emacs 22 is running.

2004-01-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-after-cursor-move-hook): Add :group keyword.
	(w3m-auto-show): Check `truncate-lines' before scrolling.
	(w3m-check-current-position): Do not check `truncate-lines'.

	* mime-w3m.el: Changes to display URI of the current anchor.
	(mime-w3m-after-cursor-move-hook): New option.
	(mime-w3m-add-local-hook): New advice.
	(mime-w3m-check-current-position): New funcion.

2004-01-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-start-and-wait): Abolished.
	(w3m-process-with-wait-handler): Reimplemented.

	* w3m.el (w3m-input-url): Accept other symbols than `popup'.
	(w3m-copy-buffer): Fix the bug that drops an asynchronous handler
	returned by `w3m-goto-url'.

2004-01-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Register a url to the history even if it is
	failed to retrieve.  Suggested by Fujishima-san.

2004-01-23  Hiroshi Fujishima  <pooh@nature.tsukuba.ac.jp>

	* w3m.el (w3m-input-url): Fix a bug which causes an error when there's
	neither a frame nor a window for the emacs-w3m session and `url' is the
	symbol `popup' (it is because there's a url-like text around the cursor
	but deleted by a user in the minibuffer).

2004-01-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-input-url): Add "http://" to its return value, when its
	return value contains no scheme part.

2004-01-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-dump-extra): Check cache control headers before
	caching headers and contents.  This change is suggested by Mr. Amagai
	in [emacs-w3m:06255].
	(w3m-message): Make it verbose, even if a buffer related to emacs-w3m
	is not displayed.  w3m-print-this-url() has been broken in buffers
	displaying text/html messages, because w3m-message() was too silent.

2004-01-11  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-safe-view-this-url): Bind `w3m-pop-up-windows' to nil
	locally, in order to keep MUA's window configuration.

	* w3m-proc.el (w3m-process-do-with-temp-buffer): Save the current
	buffer while executing an asynchronous body.

	* w3m-util.el (w3m-insert-string): Define its `edebug-form-spec'.

2004-01-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-util.el (w3m-keep-region-active): Renamed from
	`w3m-activate-zmacs-regions'.
	(w3m-deactivate-region): Declared as a macro.

	* w3m-search.el (w3m-search-read-query): Call `w3m-deactivate-region'
	instead of `w3m-deactivate-mark'; Call `region-beginning' and
	`region-end' instead of `point' and `mark'.

	* w3m.el (w3m-next-anchor, w3m-previous-anchor, w3m-next-form,
	w3m-previous-form, w3m-next-image, w3m-previous-image,
	w3m-scroll-up-or-next-url, w3m-scroll-down-or-previous-url,
	w3m-beginning-of-line, w3m-end-of-line): Call `w3m-keep-region-active'
	instead of `w3m-activate-zmacs-regions'.
	(w3m-active-region-or-url-at-point): Call `region-beginning' and
	`region-end' instead of `point' and `mark'.

2004-01-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-proc.el (w3m-process-wait-discard-input): New variable.
	(w3m-process-wait-process): If `w3m-process-wait-discard-input' is
	non-nil, call `discard-input'.

2004-01-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-deactivate-mark): New function alias.

	* w3m.el (w3m-active-region-or-url-at-point): Use it.
	(w3m-open-all-links-in-new-session): Use it.

	* w3m-search.el (w3m-search-read-query): Use it.

2004-01-04  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-active-region-or-url-at-point): New function.
	(w3m-input-url, w3m-view-this-url, w3m-goto-url): Call
	`w3m-active-region-or-url-at-point' instead of `w3m-url-at-point'.

2004-01-04  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-util.el (w3m-region-active-p): New macro.

	* w3m.el (w3m-open-all-links-in-new-session): Deactivate the mark when
	it is active.
	(w3m-view-this-url-new-session): Use `w3m-region-active-p'.

	* w3m-search.el (w3m-search-read-query): Use `w3m-region-active-p'.

	* w3m-namazu.el (w3m-namazu): Use `w3m-search-read-query' to read a
	query from the minibuffer.

	* w3m-search.el (w3m-search-read-query): New function.
	(w3m-search): Use the above function.

2004-01-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-search.el (w3m-search): Use the region as an initial string if
	Transient Mark mode.
	(w3m-search-word-at-point): Follow the above change in its docstring.

	* w3m-e21.el (w3m-tab-line): Check the length of the current title,
	before checking the breadth of its first character.

2003-12-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-accept-languages): Split the option of w3m with a comma
	surrounded by some spaces.
	(w3m-dump-head-source-command-arguments): Use a comma instead of a
	white space to concatenate elements of `w3m-accept-languages'.
	Cf. Section 14.4 of RFC2047.

2003-12-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Add an advice to byte-optimize-form-code-walker to avoid
	the warning ``...called for effect'' for the pop form when running
	Emacs 21.3.

2003-12-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-create-text-page): Use the last directory as a title of
	text/plain page when its uri is terminated by a slash.


2003-12-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (emacs-w3m-version): Release 1.3.80.

2003-12-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-wait-process): Return exit status; Use
	`accept-process-output' instead of `sit-for' in order to flush pending
	output.
	(w3m-process-with-wait-handler): Follow the above change.

2003-12-21  Masatake YAMATO  <jet@gyve.org>

	* w3m.el (w3m-mode): Small doc fix.
	(w3m-relationship-estimate-rules): Relax the regular expression to
	detect result pages of Google.

2003-12-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-safe-toggle-inline-image): New function.
	(w3m-toggle-inline-images): Revoke the recent changes.
	(w3m-safe-toggle-inline-images): New function.
	(w3m-safe-view-this-url): Doc fix.
	(w3m-minor-mode-command-alist): Use `w3m-safe-toggle-inline-image' and
	`w3m-safe-toggle-inline-images'.

	* w3m-util.el (w3m-find-w3m-buffer): Abolish.
	(w3m-with-w3m-buffer): Abolish.

	* mew-w3m.el (mew-w3m-view-inline-image): Revert.

	* attic/vm-w3m.el (vm-w3m-safe-toggle-inline-images): New function.

2003-12-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toggle-inline-images): Ignore `w3m-safe-url-regexp' when
	the prefix argument is given.

	* w3m-util.el (w3m-find-w3m-buffer): Bind `w3m-safe-url-regexp' to the
	value specified peculiarly by each MUA.
	(w3m-with-w3m-buffer): Ditto.

	* mew-w3m.el (mew-w3m-view-inline-image): Don't bind
	`w3m-safe-url-regexp' there.

2003-12-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-view-inline-image): Fix last change.

2003-12-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-view-inline-image): Use
	`w3m-toggle-inline-images'.
	(mew-mime-text/html-w3m): Put the `w3m-images' text property in the
	message buffer.

	* w3m-util.el (w3m-find-w3m-buffer): Fix for Mew.

2003-12-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toggle-inline-images): Wrap it with
	`w3m-with-w3m-buffer'.

	* w3m-util.el (w3m-find-w3m-buffer): New function.
	(w3m-with-w3m-buffer): New macro.

2003-12-13  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-string): Renamed from
	`string-with-default'.
	(w3m-antenna-string-create): Renamed from
	`string-with-default-value-create'.
	(w3m-antenna-sites): Change its customize spec.

	* w3m-xmas.el (w3m-window-hscroll, w3m-current-column,
	w3m-set-window-hscroll): Import definitions from w3m.el.
	(w3m-run-at-time): Renamed from `w3m-xmas-run-at-time'.

	* w3m.el (w3m-window-hscroll, w3m-current-column,
	w3m-set-window-hscroll): Export definitions for XEmacs to w3m-xmas.el.

2003-12-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_SET_VANILLA_FLAG): New function specifying the
	`VANILLA_FLAG' variavle.  XEmacs 21.5 needs to be given `-vanilla'
	rather than `-q -no-site-file'.
	(AC_EMACS_LISP): Use `VANILLA_FLAG'.
	(AC_PATH_EMACS): Call `AC_SET_VANILLA_FLAG'.
	(AC_ADD_LOAD_PATH): Use `VANILLA_FLAG'.
	(AC_CHECK_ELISP): Ditto.

	* configure.in: Check for `EGREP' before calling `AC_PATH_EMACS'.

	* Makefile.in (VANILLA_FLAG): New variable.
	(FLAGS): Use it.
	(very-slow): Use it.

	* doc/Makefile.in (VANILLA_FLAG): New variable.
	(FLAGS): Use it.

	* w3m-xmas.el (w3m-xmas-run-at-time): Use a simple function definition
	if there is not a bug in `start-itimer'.

2003-12-11  KAMO Tomoyuki <kamo@ITmanage.co.jp>

	* octet.el (octet-suffix-type-alist): Add suffix of bzip-ed files.
	(octet-type-filter-alist): Add an entry of bzip2.
	(octet-guess-type-from-name): Relax the regular expression to detect
	suffix, in order to handle bzip-ed files.

2003-12-11  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Experimentally implement the estimation layer of
	relationships between pages.
	(w3m-relationship-estimate-rules): New option.
	(w3m-relationship-estimate, w3m-relationship-simple-estimate,
	w3m-relationship-magicpoint-estimate,
	w3m-relationship-search-patterns): New functions.
	(w3m-use-filter): Cancel the last change; its default value is changed
	to nil.

	* w3m-filter.el (w3m-filter-rules): Remove rules to find relationships.
	(w3m-filter-find-relationships): Abolished.

	* w3m-util.el (w3m-html-string-regexp): Import from w3m.el.

2003-12-10  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-use-filter): Change its default value to t.

	* w3m-filter.el: Reconstructed completely.
	(w3m-filter-rules): Change its spec and its default value.
	(w3m-filter): Reimplemented.
	(w3m-filter-delete-regions, w3m-filter-find-relationships): New
	functions.
	(w3m-filter-db, w3m-filter-db-size, w3m-filter-server-regexp,
	w3m-filter-setup, w3m-filter-delete-region, w3m-filter-lwn.net,
	w3m-filter-google.com, w3m-filter-www.zdnet.co.jp): Removed.

2003-12-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-xmas-run-at-time): Rewrite w/o using fsf-compat.

	* w3m.el (w3m-run-at-time): New function alias.
	(w3m-refresh-at-time): Use it.

2003-12-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-xmas-run-at-time): New function.

	* w3m.el (w3m-refresh-at-time): Use it.

2003-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url-new-session): Abolish the optional arg.
	(w3m-mouse-view-this-url-new-session): Ditto.

2003-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-buffer-setup): Use `defun' instead of `defsubst'.

2003-12-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-current-anchor-face): Replace backquote with quote.
	(w3m-select-buffer-current-buffer): Ditto.
	(w3m-header-line-insert): Ditto.
	(w3m-about-retrieve): Use `defun' instead of `defsubst'.
	(w3m-cid-retrieve): Ditto.
	(w3m-current-column): Make it a function, not a macro.

2003-11-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-minor-mode): Run hooks only when this minor mode is
	enabled.
	* w3m-bookmark.el (w3m-bookmark-mode): Ditto.
	* w3m-antenna.el (w3m-antenna-mode): Ditto.

	* w3m-antenna.el (w3m-antenna-alist): Simplified.

2003-11-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el: Define a new minor mode `w3m-antenna-mode'.
	(w3m-antenna-mode-map, w3m-antenna-mode): New variables.
	(w3m-antenna-mode, w3m-antenna-mode-setter, w3m-antenna-edit): New
	functions.

	* w3m-bookmark.el (w3m-bookmark-mode): Change its interactive spec, and
	improve its document.

	* w3m-favicon.el (w3m-favicon-retrieve): Abolish the 4th argument
	`handler' and wrap the asynchronous processing forms with
	`w3m-process-with-null-handler', in order to clarify this function's
	purpose.

	* w3m.el (w3m-message): Use `walk-windows' instead of `window-list',
	because the latter is not available at Meadow and Mule2.
	(w3m-w3m-retrieve): Check the status code.
	(w3m-show-error-information): Also use retrieved error pages.
	(w3m-minor-mode): Change its interactive spec.

2003-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-convert): Make sure data of the ico type
	contains the correct magic numbers.

2003-11-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-util.el (w3m-last-visited-buffer): Abolished.
	(w3m-popup-buffer): Do not reset the above variable.

	* w3m.el (w3m-close-window): Do not set the above variable.
	(w3m): Do not refer the above variable.

2003-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-retrieve-and-render): Use `w3m-message' instead of
	`message'; don't let it be controlled by `w3m-verbose'.
	(w3m-alive-p): Don't sort the return value of `list-buffers' so that it
	returns the last visited emacs-w3m buffer as much as possible; don't
	inline the `w3m-list-buffers' function.

2003-11-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-verbose): Change its default value to nil.
	(w3m-message): When `w3m-verbose' is nil, display messages without
	logging.
	(w3m-make-help-echo, w3m-toggle-inline-image, w3m-zoom-in-image,
	w3m-zoom-out-image, w3m-view-this-url, w3m-submit-form, w3m-view-image,
	w3m-save-image, w3m-view-url-with-external-browser,
	w3m-download-this-url, w3m-print-this-url, w3m-edit-current-url,
	w3m-edit-this-url, w3m-quit, w3m-goto-ftp-url, w3m-select-buffer,
	w3m-select-buffer-show-this-line,
	w3m-select-buffer-show-this-line-and-switch): Call `w3m-message'
	instead of `w3m-display-message'.

	* w3m-util.el (w3m-display-message): Removed.
	(w3m-display-message-enable-logging): Abolished.

2003-11-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-message): Silent when the cursor is in minibuffer.

	* w3m-util.el (w3m-display-message): Ditto.

2003-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-html-string-regexp): Fix my fault; enclose it with
	`eval-and-compile' which is needed for compiling since it is used in a
	macro.

2003-11-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-wait-process): Invert the return value of
	sit-for() that waits an asynchronous process.
	(w3m-process-kill-process): Relax the condition that checks whether a
	given process has already finished or not.

2003-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search): Use `w3m-goto-url' instead of `w3m'.
	* w3m-weather.el (w3m-weather): Ditto.

	* w3m.el (w3m-obey-w3m-pop-up-frames): Abolish.
	(w3m-goto-url-new-session): Find an existing emacs-w3m buffer and then
	make a copy of it; use `w3m-goto-url' instead of `w3m' if there is no
	emacs-w3m buffer.
	(w3m-browse-url): Revert last change; rename the optional arg to
	`new-session'; call `w3m-goto-url-new-session' or `w3m-goto-url'.
	(w3m-select-buffer): Use `w3m-goto-url' instead of `w3m'.
	(w3m-safe-view-this-url): Ditto.

2003-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-antenna.el (w3m-antenna): Don't pass the interactive flag to
	`w3m-goto-url'.
	* w3m-bookmark.el (w3m-bookmark-view): Ditto.
	* w3m-cookie.el (w3m-cookie): Ditto.
	* w3m-dtree.el (w3m-dtree): Ditto.
	* w3m-namazu.el (w3m-namazu): Ditto.
	* w3m-perldoc.el (w3m-perldoc): Ditto.

	* w3m.el (w3m-copy-buffer): Don't pop up a window or a frame if
	`w3m-goto-url' is called.
	(w3m-goto-url): Abolish the 8th arg `interactive-p'; pop up a window or
	a frame anyway.
	(w3m-goto-url-new-session): Abolish the `interactive-p' argument; don't
	pass it to `w3m-goto-url'.
	(w3m-gohome): Ditto.
	(w3m): Don't pop up a window or a frame there.
	(w3m-browse-url): Make it work as `browse-url-w3'.

2003-11-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-wait-process): Don't specify 3 args to
	`sit-for' for XEmacs.

2003-11-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-sites): Change its default value.  Allow
	a list that consists of a function and its options, as the third
	element of each site.
	(w3m-antenna-html-skeleton): Remove the link to the antenna editor.
	(w3m-antenna-setup): Removed.
	(w3m-antenna-shutdown): Removed.
	(w3m-antenna-alist): New function.
	(w3m-antenna-site-update): Ditto.
	(w3m-antenna-check-hns): Ditto.
	(w3m-antenna-check-anchor): Ditto.
	(w3m-antenna-check-page): Ditto.
	(w3m-antenna-check-site): Use the above three functions.
	(w3m-antenna-check-all-sites): Follow the above change.  Use
	w3m-antenna-alist() and w3m-save-list() instead of w3m-antenna-setup()
	and w3m-antenna-shutdown().
	(w3m-antenna-check-site-after): Removed.
	(w3m-antenna-make-summary): Use a key attribute instead of an url
	attribute, when the latter is not set.
	(w3m-antenna-make-summary-like-natsumican): Ditto.
	(w3m-about-antenna): Call w3m-antenna-alist() instead of
	w3m-load-list().
	(w3m-about-antenna-edit): Removed.
	(w3m-antenna-edit-reset-post-data): Ditto.

2003-11-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-antenna.el (w3m-antenna): Pass the interactive flag to
	`w3m-goto-url'.
	* w3m-bookmark.el (w3m-bookmark-view): Ditto.
	* w3m-cookie.el (w3m-cookie): Ditto.
	* w3m-dtree.el (w3m-dtree): Ditto.
	* w3m-namazu.el (w3m-namazu): Ditto.
	* w3m-perldoc.el (w3m-perldoc): Ditto.
	* w3m.el (w3m-gohome): Ditto.
	(w3m-browse-url): Ditto.

2003-11-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-rendering-half-dump): Move point to the end of the region
	in order to avoid a bug of `call-process-region' in XEmacs 21.5.7+ (see
	the comment).
	(w3m-decode-encoded-contents): Ditto.
	(w3m-x-moe-decode-buffer): Ditto.

	* w3m-perldoc.el (w3m-about-perldoc): Ditto.

	* w3m-xmas.el (w3m-initialize-graphic-icons): Ditto.

	* w3m-favicon.el (w3m-favicon-retrieve): Say "no favicon" if it is not
	available.

	* w3m-proc.el (w3m-process-with-environment): Rely on the
	`temp-directory' function and modify TEMP and TMPDIR env vars for
	XEmacs.

2003-11-20  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-normalize-action): New inline function.
	(w3m-form-parse-and-fontify): Use it.
	(w3m-form-new): Simply set action.
	(w3m-form-submit): Don't treat !CURRENT_URL! here.

2003-11-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_ADD_LOAD_PATH): Refine the help message for the
	--with-attic option.

2003-11-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-buffer-setup): Make sure that `truncate-lines' is t.
	(w3m-view-source): Don't set `truncate-lines' to nil when quitting
	viewing a source.
	(w3m-view-header): Set `truncate-lines' to nil when viewing a header.

2003-11-18  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-put-by-name): New function.
	(w3m-form-resume): Use w3m-form-get-by-name and w3m-form-put-by-name
	instead of w3m-form-get and w3m-form-put for radio buttons.
	(w3m-form-parse-and-fontify): Ditto.
	(w3m-form-input-radio): Ditto.

2003-11-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-check-current-position): Don't allow horizontal scrolling
	when `truncate-lines' is nil.
	(w3m-view-source): Set `truncate-lines' to nil.

	* w3m-favicon.el (w3m-favicon-setup): Retrieve favicon even when
	viewing the header or the page source.

2003-11-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (very-slow): Fix echo messages.

	* w3m.el (w3m-follow-redirection): Fix customization type.

	* w3m-e21.el: Bind `w3m-current-title' when compiling.

	* /: Bind `w3m-work-buffer-list' when compiling in: w3m-e21.el,
	w3m-favicon.el, w3m-image.el, w3m-proc.el and w3m-xmas.el.

	* /: Require `cl' when compiling in: w3m-cookie.el, w3m-form.el and
	w3m-tabmenu.el.

	* /: Remove unused non-global variables in: octet.el, w3m-cookie.el,
	w3m-tabmenu.el and w3m-weather.el.

2003-11-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Make `w3m-local-find-file-function' don't
	handle directories.

2003-11-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el: Bind `w3m-current-process', `w3m-pop-up-frames',
	`w3m-pop-up-windows', `w3m-popup-frame-parameters',
	`w3m-select-buffer-name' and `w3m-use-tab', and fbind
	`select-frame-set-input-focus' when compiling.
	(w3m-popup-frame-parameters): Move from w3m.el.
	(w3m-popup-frame-p): Ditto.
	(w3m-use-tab-p): Ditto.
	(w3m-popup-window-p): Ditto.
	(w3m-initial-frames): Ditto.
	(w3m-last-visited-buffer): Ditto.
	(w3m-popup-buffer): Ditto; also move the program to make
	`select-frame-set-input-focus' unbound from w3m.el.
	(w3m-add-w3m-initial-frames): Ditto; also move the program to add it to
	`create-frame-hook', `after-make-frame-functions' or
	`after-make-frame-hook' from w3m.el.
	(w3m-delete-frames-and-windows): Ditto.
	(w3m-display-progress-message): Mark a progress message with the
	`w3m-progress-message' text property.

	* w3m.el: Don't fbind `select-frame-set-input-focus'.
	(w3m-local-find-file-function): Use `w3m-popup-frame-p'.
	(w3m-initial-frames): Move to w3m-util.el.
	(w3m-popup-frame-parameters): Ditto.
	(w3m-popup-frame-p): Ditto.
	(w3m-use-tab-p): Ditto.
	(w3m-popup-window-p): Ditto.
	(w3m-last-visited-buffer): Ditto.
	(w3m-popup-buffer): Ditto; also move the program to make
	`select-frame-set-input-focus' unbound to w3m-util.el.
	(w3m-add-w3m-initial-frames): Ditto; also move the program to add it to
	`create-frame-hook', `after-make-frame-functions' or
	`after-make-frame-hook' to w3m-util.el.
	(w3m-delete-frames-and-windows): Ditto.
	(w3m-delete-buffer-if-empty): New function.
	(w3m-view-this-url-1): Use it.
	(w3m-goto-url-new-session): Use it.
	(w3m): Use it.

	* w3m-e21.el (w3m-euc-japan-encoder): Compute the ccl program in each
	time to load w3m-e21.elc to keep the compatibility of the module with
	Emacs 21.3 and the later versions.
	(w3m-iso-latin-1-encoder): Ditto.

2003-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-horizontal-scroll-division): Mega doc fix; eliminate
	illegal values.
	(w3m-horizontal-on-screen): Rearrange.

2003-11-14  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-last-visited-buffer): New variable.
	(w3m-popup-buffer): Clear `w3m-last-visited-buffer'.
	(w3m-close-window): Set the last emacs-w3m buffer as
	`w3m-last-visited-buffer'.
	(w3m): Preferably use the last emacs-w3m buffer kept in
	`w3m-last-visited-buffer'.

2003-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-horizontal-recenter): Do nothing besides resetting the
	window's hscroll if `truncate-lines' is nil.
	(w3m-beginning-of-line): Replace `w3m-set-window-hscroll' with
	`set-window-hscroll'.
	(w3m-end-of-line): Make it work identically as `end-of-line' if
	`truncate-lines' is nil.
	(w3m-display-width): Move downward (see the comment).

2003-11-14  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-parse-header): Because a broken server returns a
	relative URL in the location field, convert a URL to absolute.

	* w3m-proc.el (w3m-process-wait-process): New function.
	(w3m-process-start-and-wait): Call the above function.

	* w3m-weather.el (w3m-weather-run-filter-functions): New function to
	call filter functions asynchronously.
	(w3m-about-weather): Call the above.
	(w3m-weather-get-seikatu-sisu): Asynchronized.
	(w3m-weather-insert-seikatu-sisu): Ditto.

2003-11-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-initial-frames): Rename from `w3m-initial-frame'; keep a
	list of the frame-IDs.
	(w3m-popup-window-p): Return nil if there is the selection window.
	(w3m-popup-buffer): Copy a copy of `w3m-initial-frames' from a visible
	emacs-w3m buffer to a popped-up emacs-w3m buffer; don't set
	`w3m-initial-frames' for newly created frames there.
	(w3m-add-w3m-initial-frames): New function; add it to
	`create-frame-hook', `after-make-frame-functions' or
	`after-make-frame-hook'.
	(w3m-copy-buffer): Copy a copy of `w3m-initial-frames'.
	(w3m-delete-buffer): Pop up another emacs-w3m buffer instead of
	deleting a frame; remove a deleted frame from `w3m-initial-frames'.
	(w3m-delete-frames-and-windows): Also allow a window or a frame as the
	optional argument; emulate XEmacs version's `one-window-p'.
	(w3m): Set the value for `w3m-initial-frames' even if it is invoked in
	the batch mode.
	(w3m-select-buffer): Delete other emacs-w3m frames and windows.
	(w3m-select-buffer-copy-buffer): Revert the 2003-11-11 change.
	(w3m-select-buffer-delete-buffer): Simplify.

	(w3m-display-width): New function for showing pages as if there is no
	selection window.
	(w3m-halfdump-command-common-arguments): Use it.
	(w3m-make-separator): Use it.
	(w3m-about-db-history): Use it.
	(w3m-header-line-insert): Work as if there is no selection window.

	* w3mhack.el (w3mhack-generate-colon-keywords-file): Preset
	`:strike-through' and `:strikethru' which aren't supported by the old
	cus-face.el.

2003-11-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-popup-buffer): Reuse an existing window or frame if it
	exists; set the value for `w3m-initial-frame' properly; raise, select
	and focus the new frame.
	(TopLevel): Make `select-frame-set-input-focus' unbound if it is a
	dummy.
	(w3m-view-this-url-1): Show a progress message.
	(w3m-copy-buffer): Simplify the code to call `w3m-popup-buffer'.
	(w3m-alive-p): Add an optional arg `visible' (see docs); use inlining
	`w3m-list-buffers'.
	(w3m): Simplify the code using `w3m-popup-buffer'; specify the optional
	arg to `w3m-alive-p'; protect against the case of no url.
	(w3m-select-buffer-copy-buffer): Bind `w3m-pop-up-windows' to nil.

	* w3m-util.el (w3m-list-buffers): Make it into a normal function; don't
	call itself recursively.

2003-11-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-function-max-args): Move to mew-shimbun.el.

	* w3m.el (w3m-popup-buffer): New function (it still needs to improved
	in order for the `w3m' function to use).
	(w3m-view-this-url-1): Specify the value of
	`w3m-view-this-url-new-session-in-background' to the 3rd arg of
	`w3m-copy-buffer'; don't pop up a window or a frame there.
	(w3m-copy-buffer): Change the meaning of the 3rd arg (see docs); don't
	pop up a window or a frame if it is non-nil, otherwise call
	`w3m-popup-buffer'.
	(w3m-goto-url): Change the name of the 8th arg to `interactive-p';
	don't pop up a window or a frame unless this function is called
	interactively, otherwise call `w3m-popup-buffer'.
	(w3m-goto-url-new-session): Specify nil to the 3rd arg of
	`w3m-copy-buffer'.
	(w3m-select-buffer-saved-window-config): Abolish.
	(w3m-select-buffer): Revert the 2003-11-05 change; delete other windows
	except for the current emacs-w3m window or create a new emacs-w3m
	buffer when it is called initially.
	(w3m-select-buffer-current-buffer): Use `line-beginning-position'.
	(w3m-select-buffer-copy-buffer): Revert the 2003-11-05 change;
	simplify.
	(w3m-select-buffer-delete-buffer): Call `w3m-quit' if there is the sole
	emacs-w3m buffer.
	(w3m-select-buffer-delete-other-buffers): Revert the 2003-11-07 change.
	(w3m-select-buffer-quit): Revert the 2003-11-05 change; bind
	`pop-up-frames'.

2003-11-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-stop): Change `w3m-current-process' in the
	buffer specified in the argument, instead of changing it in the current
	buffer.

2003-11-08  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-canonicalize-url): New function.
	(w3m-w3m-attributes-1): New function.
	(w3m-w3m-attributes): Call the above functions to follow redirection.
	(w3m-w3m-retrieve): Call `w3m-w3m-canonicalize-url' before retrieving.

	* w3m-proc.el (w3m-process-start-process): Check the value of
	`w3m-current-url' before calling `w3m-url-authinfo'.
	(w3m-process-start-and-wait): Make sure synchronization with
	sub-process.
	(w3m-process-do-with-temp-buffer): Call `w3m-kill-buffer' instead of
	calling `kill-buffer' directly.

	* w3m-antenna.el (w3m-antenna-mapcar): Simplified and follow the change
	of `w3m-process-do-with-temp-buffer'.
	(w3m-antenna-mapcar-after): Ditto.

2003-11-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-other-buffers): Use
	`w3m-delete-frames-and-windows'.
	(w3m-delete-frames-and-windows): Take an optional argument for the
	exception; assume a buffer may be at two or more windows.
	(w3m-close-window): Assume a buffer may be at two or more windows.
	(w3m-select-buffer-delete-other-buffers): Save-window-excursion.

2003-11-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-popup-frame-parameters): Rename from
	`w3m-pop-up-frame-parameters' to make it easy to complete the
	`w3m-pop-up-frames' variable name.
	(w3m-popup-frame-parameters): Rename from
	`w3m-pop-up-frame-parameters'.
	(w3m-popup-frame-p): Make it a generic macro.
	(w3m-use-tab-p): New macro.
	(w3m-popup-window-p): Use `w3m-use-tab-p'.
	(w3m-view-this-url-1): Use `w3m-use-tab-p' and `w3m-popup-frame-p'.
	(w3m-copy-buffer): Ditto.
	(w3m-delete-buffer): Use `w3m-use-tab-p'.
	(w3m-goto-url): Use `w3m-use-tab-p' and `w3m-popup-frame-p'.
	(w3m): Modify to use new `w3m-popup-frame-p'.
	(w3m-header-line-insert): Use `w3m-use-tab-p'.

2003-11-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-current-redirect): Abolished.
	(w3m-clear-local-variables, w3m-copy-local-variables): Follow the above
	change.

	* w3m-proc.el (w3m-process-do-with-temp-buffer): Keep the current
	buffer after given FORM and BODY are evaluated.

2003-11-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-follow-redirection): Fix its docstring.
	(w3m-w3m-retrieve): When the above option is equal to nil, it is
	treated as 0.
	(w3m-retrieve-and-render): Check content type and charsets with
	redirected real URI instead of user-specified URI.

	* w3m-antenna.el (w3m-antenna-hns-last-modified): Do not accept
	`no-cache' argument.
	(w3m-antenna-check-site): Ditto.
	(w3m-antenna-mapcar, w3m-antenna-mapcar-after): New functions.
	(w3m-antenna-check-all-sites): Use the above functions.

2003-11-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-buffer): New implementation.
	(w3m-delete-frame-maybe): Abolish.
	(w3m-delete-frames-and-windows): New function.
	(w3m-quit): Use it.
	(w3m-close-window): New implementation.
	(w3m-select-buffer-show-this-line): Specify the 1st arg to
	`one-window-p'.
	(w3m-select-buffer-quit): Ditto.
	(w3m-select-buffer-close-window): Ditto.

2003-11-06  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-strike-through): Support <strike> element.
	(w3m-fontify): Change the turn `w3m-fontify-strike-through' and
	`w3m-fontify-underline'.

2003-11-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* attic/vm-w3m.el: New file.

2003-11-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Fbind `select-frame-set-input-focus' when compiling.
	(w3m-popup-window-p): Rename from `w3m-pop-up-window-p'; use
	'emacs-major-version' instead of `MULE' to examine the version.
	(w3m-view-this-url-1): Use `pop-to-buffer' instead of
	`switch-to-buffer' in order to be able to popup a window or a frame.
	(w3m-copy-buffer): Ditto; set the `w3m-initial-frame' variable only
	when `w3m-pop-up-frames' is non-nil.
	(w3m-delete-buffer): Select the most suitable buffer.
	(w3m-goto-url): Use `pop-to-buffer' instead of `switch-to-buffer' in
	order to be able to popup a window or a frame.
	(w3m): Ditto; rearrange the source code.
	(w3m-select-buffer-saved-window-config): New variable.
	(w3m-select-buffer): Save the window configuration.
	(w3m-select-buffer-copy-buffer): Bind `pop-up-frames'.
	(w3m-select-buffer-quit): Restore the window configuration; protect
	agains the absence of an emacs-w3m buffer.

	* w3m-xmas.el: Bind `w3m-use-tab' when compiling.
	(w3m-xmas-show-current-title-in-buffer-tab): Examine the value for the
	`gutter-buffers-tab-enabled' variable directly.
	(w3m-xmas-setup-tab-in-gutter): New function; add it to
	`w3m-mode-setup-functions' and `w3m-select-buffer-mode-hook'.
	(w3m-xmas-update-tab-in-gutter): Do update only when `w3m-use-tab' and
	`gutter-buffers-tab-enabled' are non-nil; always add it to
	`w3m-display-functions'.

	* octet.el: Don't make sure the `emacs-major-version' variable is
	bound.
	* w3m-bitmap: Ditto.
	* w3m-bug.el: Ditto.
	* w3m-proc.el: Ditto.
	* w3m-ucs.el: Ditto.
	* w3m-util.el: Ditto.
	* w3m.el: Ditto.
	* w3mhack.el: Ditto.

2003-11-05  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-delete-buffer, w3m-delete-other-buffers)
	(w3m-select-buffer-delete-buffer): Call `w3m-process-stop'.

	* w3m-proc.el (w3m-process-kill-stray-processes): New function.
	(w3m-process-start-queued-processes): Call
	`w3m-process-kill-stray-processes'.
	(w3m-process-filter): When parent-buffer was killed, call
	`w3m-process-kill-stray-processes'

2003-11-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-pop-up-windows): Default to t.
	(w3m-pop-up-window-p): New macro examining the value for the
	`w3m-use-tab' variable and the present situation.
	(w3m-copy-buffer): Use it.

2003-11-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-meta-content-type-charset-regexp)
	(w3m-meta-charset-content-type-regexp)
	(w3m-meta-refresh-content-regexp)
	(w3m-meta-content-refresh-regexp): Allow `\n' as whitespaces.

2003-10-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-backward): Return the current history if the
	number zero is given as an argument.

2003-10-29  OHASHI Akira  <bg66@koka-in.org>

	* w3m.el (w3m-process-connection-type): Set t when system is darwin
	version 7.0.0 or later.

2003-10-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify-strike-through (var)): Make it into the variable
	which is not a user option.
	(w3m-fontify-strike-through (fn)): Check dynamically whether the window
	system is used.
	(w3m-url-at-point): Unify iso646 chars to ascii on XEmacs-mule.

	* mew-w3m.el: Silence the compile warning for `mew-coding-system-p' for
	people having the Mew XEmacs package installed.

2003-10-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-obey-w3m-pop-up-frames): New variable.
	(w3m-copy-buffer): Inherit the value of `w3m-initial-frame' into the
	new buffer if a new frame is not created for the new buffer.
	(w3m-delete-frame-maybe): Simplify it in the different way.

	* w3m-search.el (w3m-search): Specify the 3rd arg of `w3m'.

2003-10-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Revive `w3m-initial-frame' throughout.
	(w3m-delete-frame-maybe): Revert 2003-10-20 change.

2003-10-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-strike-through-face): Use the :strikethru attribute in
	XEmacs.
	(w3m-fontify-strike-through): Enable it also for XEmacs.

2003-10-21  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-retrieve): Insert no data when either retrieval or
	decoding is failed.
	(w3m-w3m-parse-header): Do not return a base URI of retrieved page.

2003-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Fix some comments and docstrings (to be continued).
	(w3m-copy-local-variables, w3m-open-all-links-in-new-session,
	w3m-horizontal-scroll): Remove unused non-global variables.

2003-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Abolish `w3m-initial-frame' throughout.
	(w3m-delete-frame-maybe): Simplify.

2003-10-19  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-base-url): Removed.
	(w3m-attributes, w3m-local-attributes, w3m-w3m-attributes): Do not
	return a base URI of retrieved page.

2003-10-14  Jose A. Ortega Ruiz  <jao@gnu.org>

	* w3m.el (w3m-decode-entities-string): Move `save-match-data' to the
	exterior of `with-temp-buffer'.

2003-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-half-space, w3m-tab-separator): Use `:width'
	instead of `:relative-width' to specify the space width.
	(w3m-tab-line): Tidy it up.

	* w3m-favicon.el (w3m-favicon-set-image): Use `:width' instead of
	`:relative-width' to specify the space width.

2003-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-unselected-face,
	w3m-tab-unselected-retrieving-face, w3m-tab-selected-face,
	w3m-tab-selected-face): Exchange the default TTY colors between
	selected faces and unselected faces.
	(w3m-tab-drag-mouse-function): Compare buffer objects instead of buffer
	names.
	(w3m-tab-make-keymap): Use buffer objects instead of buffer names.
	(w3m-tab-line): Make all tab widths the same even if there are wide
	characters; never use graphic icons in TTY; close the left margin
	unless there's an icon; add a keymap to favicon; don't put mouse-face
	on icons.
	(w3m-initialize-graphic-icons): Don't make graphic icons for TTY; don't
	put mouse-face on icons.

	* w3m-favicon.el: Bind `w3m-modeline-favicon' when compiling.
	(w3m-favicon-set-image): Add a half space after favicon.

	* w3m-util.el (w3m-current-title): New function.
	(w3m-buffer-title): Use it.

	* w3m.el: Silence the byte-compiler for `w3m-info-like-map',
	`w3m-lynx-like-map', `w3m-minor-mode-map', `w3m-mode-map', and
	`w3m-setup-menu'.

2003-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el: Silence the compile warning for `w3m-message'.

	* w3m.el (w3m-url-to-file-name): Enable it to interpret
	file://localhost/ urls.

2003-10-07  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-parse-and-fontify): Fix for textarea on w3mmee.

2003-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (frame-current-scroll-bars): Alias to `ignore' if it is
	not available.
	(window-fringes): Ditto.
	(w3m-tab-width): Protect against setting illegal values.
	(w3m-tab-unselected-face): Don't specify the underline color.
	(w3m-tab-unselected-retrieving-face): Ditto.
	(w3m-tab-selected-face): Ditto.
	(w3m-tab-selected-retrieving-face): Ditto.
	(w3m-tab-background-face): Ditto.
	(w3m-tab-timer): Rename from `w3m-tab-line-timer'.
	(w3m-tab-half-space): New variable.
	(w3m-tab-separator): New variable.
	(w3m-tab-line): Show many tabs as far as possible.

	* w3m-favicon.el (w3m-favicon-retrieve): Clear the minibuffer after
	retrieving favicon.

2003-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	We shouldn't use too simple elements like ".+" in the deep nested
	regexps.  It may cause high cpu or may make Emacs hang.

2003-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-use-favicon): Modify the doc-string.
	(w3m-show-graphic-icons-in-mode-line): New variable.
	(w3m-show-graphic-icons-in-header-line): New variable.
	(w3m-buffer-setup): Modify the value for
	`mode-line-buffer-identification' not to show favicon if
	`w3m-show-graphic-icons-in-mode-line' is nil.

	* w3m-e21.el: Bind `w3m-show-graphic-icons-in-header-line' and
	`w3m-show-graphic-icons-in-mode-line' when compiling.
	(w3m-tab-line): Don't show spinners nor favicons if
	`w3m-show-graphic-icons-in-header-line' is nil; call
	`w3m-make-spinner-image' only once.
	(w3m-initialize-graphic-icons): Don't make graphic icons if
	`w3m-show-graphic-icons-in-mode-line' is nil.

	* w3m-xmas.el: Bind `w3m-show-graphic-icons-in-mode-line' when
	compiling.
	(w3m-initialize-graphic-icons): Don't make graphic icons if
	`w3m-show-graphic-icons-in-mode-line' is nil.

2003-10-05  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-replace): Call `set-buffer-modified-p'.
	(w3m-form-field-parse): Do nothing when fid is nil.
	(w3m-form-input-radio): Likewise.
	(w3m-form-get-by-name): New function.
	(w3m-form-input-map): Use it.

2003-10-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-line): Fix the logic determining whether to
	display favicon.

2003-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-spinner-map-on-header-line): Abolish.
	(w3m-modeline-spinner-map): Rename from `w3m-spinner-map-on-mode-line'.
	(w3m-setup-header-line): Don't initialize
	`w3m-spinner-map-on-header-line'.
	(w3m-tab-spinner-map): New variable.
	(w3m-tab-make-keymap): Initialize it.
	(w3m-tab-line): Use it.

2003-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-modeline-separator): New variable.
	(w3m-modeline-favicon): New variable.
	(w3m-favicon-image): Move from w3m-favicon.el.
	(w3m-buffer-setup): Also call `w3m-initialize-graphic-icons' when Emacs
	21 is running; simplify the value for
	`mode-line-buffer-identification'.

	* w3m-e21.el: Bind `w3m-favicon-image' and
	`w3m-modeline-process-status-on' when compiling.
	(w3m-spinner-map-on-header-line): New variable.
	(w3m-spinner-map-on-mode-line): New variable.
	(w3m-spinner-map-help-echo): New variable.
	(w3m-setup-header-line): Initialize the value for
	`w3m-spinner-map-on-header-line'; remove an excessive `list' from the
	value for `header-line-format'.
	(w3m-tab-map): New variable.
	(w3m-tab-make-keymap): Set the value for `w3m-tab-map' in the current
	buffer.
	(w3m-tab-line): Add a keymap to the spinner; don't call
	`w3m-tab-make-keymap', use `w3m-tab-map' instead.
	(TopLevel): Add-hook `w3m-tab-make-keymap' to
	`w3m-mode-setup-functions'.
	(w3m-space-before-modeline-icon): New variable.
	(w3m-modeline-process-status-on-icon,
	w3m-modeline-image-status-on-icon, w3m-modeline-status-off-icon,
	w3m-modeline-ssl-image-status-on-icon,
	w3m-modeline-ssl-status-off-icon): New variables.
	(w3m-initialize-graphic-icons): New function.
	(w3m-make-spinner-image): Don't initialize the value for
	`w3m-spinner-image-file' here; set the value for
	`w3m-modeline-process-status-on-icon'.

	* w3m-favicon.el: Bind `w3m-favicon-image' when compiling.
	(w3m-favicon-image): Move to w3m.el.
	(w3m-space-before-favicon): Move from w3m-xmas.el.
	(TopLevel): Make `w3m-modeline-favicon' and `w3m-favicon-image'
	buffer-local; modify the value or put the `risky-local-variable'
	property for `w3m-modeline-favicon'.
	(w3m-favicon-set-image): New macro.
	(w3m-favicon-setup): Use it.
	(w3m-favicon-retrieve): Use it.

	* w3m-xmas.el (w3m-xmas-space-before-favicon): Move to w3m-favicon.el
	and rename to `w3m-space-before-favicon'.
	(w3m-space-before-modeline-icon): Rename from
	`w3m-xmas-space-before-modeline-icon'.

2003-10-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-filter): Relax the regular expression to
	detect progress status.

2003-10-02  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-w3m-expand-arguments): Redefine as a function rather than
	a macro.
	(w3m-dump-head-source-command-arguments): Simplify.
	(w3m-halfdump-command-arguments): Ditto.

2003-10-02  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-proc.el (w3m-process-filter): Check return value of
	`w3m-process-handler-parent-buffer' to move current buffer safely.

2003-10-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-modeline-image-status-on, w3m-modeline-process-status-on,
	w3m-modeline-ssl-image-status-on, w3m-modeline-ssl-status-off,
	w3m-modeline-status-off): Use `defvar' instead of `defconst'.
	(w3m-buffer-setup): Call `w3m-initialize-graphic-icons' instead of
	`w3m-make-spinner-image'; simplify the value for
	`mode-line-buffer-identification'.

	* w3m-xmas.el (w3m-xmas-space-before-modeline-icon): Rename from
	`w3m-xmas-space-before-spinner'.
	(w3m-modeline-process-status-on-icon,
	w3m-modeline-image-status-on-icon, w3m-modeline-status-off-icon,
	w3m-modeline-ssl-image-status-on-icon,
	w3m-modeline-ssl-status-off-icon): New variables.
	(w3m-spinner-image): Abolish.
	(w3m-make-spinner-image): Abolish.
	(w3m-initialize-graphic-icons): New function.

	* icons/state-00.xpm:
	* icons/state-01.xpm:
	* icons/state-10.xpm:
	* icons/state-11.xpm: New files.

2003-10-02  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-halfdump-command-arguments): Add "ucs_conv" option when
	using w3m-m17n; check w3m-output-coding-system at run time.

2003-10-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-start-after): Make sure the value for
	`w3m-current-buffer' is non-nil.

2003-10-02  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-process-modeline-format): New option.
	(w3m-buffer-setup): Set `mode-line-process'.

	* w3m-proc.el: Bind `w3m-process-modeline-format' to suppress
	byte-compile warning.
	(w3m-process-modeline-string): New buffer-local variable.
	(w3m-process-start-after): Reset the above variable.
	(w3m-process-filter): Check size of retrieved data and set the above
	variable.
	(w3m-process-modeline-format): New function.

2003-10-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-make-spinner-image): Make sure the gifsicle program
	is available.

2003-09-30  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-use-symbol): Use `w3m-mule-unicode-p'.

	* w3m-symbol.el (w3m-mule-unicode-symbol): Ditto.

2003-09-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-proc.el (w3m-process-stop): Redisplay the header-line.

	* w3m-e21.el (w3m-tab-line-format, w3m-tab-line-timer, w3m-tab-line):
	Revive the timer operation.
	(w3m-tab-line): Wobble the window size to force redisplay of the
	header-line using a timer; include spinner images in the return value
	when external processes are running.
	(w3m-spinner-image-file): New variable.
	(w3m-spinner-image-frames): New variable.
	(w3m-spinner-image-index): New variable.
	(w3m-make-spinner-image): New function.

	* w3m-favicon.el (w3m-favicon-retrieve): Always redraw Emacs frame
	using the timer; wobble the window size instead of redrawing; increase
	the delay time for the timer.

2003-09-30  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-form.el (w3m-form-parse-and-fontify): Fix problem when form_int
	appears after input_alt and action is specified.

2003-09-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-symbol.el (w3m-mule-unicode-symbol): Fix customization type.

2003-09-29  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-symbol.el: Bind `w3m-output-coding-system' when compiling.
	(w3m-mule-unicode-symbol): New variable.
	(w3m-symbol): Add it for candidate.
	(w3m-symbol): Use it.

	* w3m.el (w3m-use-symbol): Check capability for
	`w3m-mule-unicode-symbol'.

2003-09-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-line-format, w3m-tab-line-timer, w3m-tab-line):
	Remove the timer operation temporally.

2003-09-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-xmas.el (w3m-make-spinner-image): Bind `format-alist' to nil.

2003-09-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-tab-line-timer): New variable.
	(w3m-tab-line): Use it to control this function running too frequently;
	simplify the source code.

	* w3m-favicon.el (w3m-favicon-image-of): Abolish.
	(w3m-favicon-retrieve): Use a timer to redraw Emacs frame.

	* w3m-xmas.el (w3m-xmas-space-before-favicon): New user option.
	(w3m-xmas-space-before-spinner): New user option.
	(w3m-make-spinner-image): Make sure the `gif' feature is available.

	* w3m.el (w3m-buffer-setup): Use `w3m-xmas-space-before-spinner' and
	`w3m-xmas-space-before-favicon'.

2003-09-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* icons/spinner.gif: New file (without LZW compression).
	* icons30/spinner.gif: Ditto.

	* Makefile.in (install-icons, install-icons30): Also install gifs.

	* w3m-xmas.el (w3m-make-spinner-image): Use the spinner.gif file.

	* w3m-e21.el (w3m-tab-line-format): New variable (see doc-string).
	(w3m-tab-line): Use it; use a timer to suppress this function running
	too frequently.

2003-09-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-spinner-image): New variable.
	(w3m-make-spinner-image): New function.

	* w3m.el (w3m-buffer-setup): Call `w3m-make-spinner-image', show a
	spinner in the modeline under XEmacs.

2003-09-24  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-put-property): Don't call intern if it is not a
	string.
	(w3m-form-get-property): Ditto.
	(w3m-form-put): Added argument ID.
	(w3m-form-get): Changed argument from NAME to ID.
	(w3m-form-make-form-data): Changed process to get NAME and VALUE.
	(w3m-form-resume): Follow the API change in w3m-form-put and
	w3m-form-get.
	(w3m-fontify-textareas): Ditto.
	(w3m-form-parse-and-fontify): Ditto.
	(w3m-form-input): Ditto.
	(w3m-form-input-password): Ditto.
	(w3m-form-input-checkbox): Ditto.
	(w3m-form-input-radio): Ditto.
	(w3m-form-input-file): Ditto.
	(w3m-form-input-textarea-set): Ditto.
	(w3m-form-textarea-info): Ditto.
	(w3m-form-input-select): Ditto.
	(w3m-form-submit): Ditto.
	(w3m-form-real-reset): Follow the structure change.
	(w3m-form-input-select-id): New buffer local variable.
	(w3m-form-input-select-set): Use it.
	(w3m-form-field-parse): New inline function.
	(w3m-form-parse-and-fontify): Put id for selectinfo.
	(w3m-form-resume): Fixed regexp.
	(w3m-form-input-textarea): Fixed line number.
	(w3m-fontify-textareas): Put w3m-form-id property.
	(w3m-form-parse-and-fontify): Store id to the textareainfo.

2003-09-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-favicon-retrieve): Redisplay Emacs frame; rename
	from `w3m-retrieve-favicon'.
	(w3m-favicon-image): Rename from `w3m-current-favicon-image'.
	(w3m-favicon-setup): Rename from `w3m-setup-favicon'.
	(w3m-favicon-image-of): Rename from `w3m-buffer-favicon'.
	(w3m-favicon-convert): Rename from `w3m-convert-favicon'.
	(w3m-favicon-retrieve): Rename from `w3m-retrieve-favicon'.

	* w3m-e21.el (w3m-tab-line): Rename `w3m-buffer-favicon' with
	`w3m-favicon-image-of'.

	* w3m.el (w3m-clean-hook-options): Rename `w3m-setup-favicon' with
	`w3m-favicon-setup'.
	(w3m-buffer-setup): Rename `w3m-current-favicon-image' with
	`w3m-favicon-image'.

2003-09-23  OHASHI Akira  <bg66@koka-in.org>

	* w3m.el (w3m-process-connection-type): Set nil when system-type is
	darwin.

2003-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el: Bind `w3m-icon-data' when compiling.
	(w3m-current-favicon-data): Abolish.
	(w3m-favicon-converted): Abolish.
	(w3m-favicon-cache-data): Contain image data.
	(w3m-favicon-cache-favicon): Return an image instead of raw data.
	(w3m-setup-favicon): Fix the condition to check whether Emacs can
	display images; set the value of `w3m-current-favicon-image' instead of
	`w3m-current-favicon-data' for the about: pages.
	(w3m-buffer-favicon): Make it simply get the value of
	`w3m-current-favicon-image'.
	(w3m-convert-favicon): Accept raw data and type; simply return an
	image.
	(w3m-retrieve-favicon): Rearrange the arguments to accept url and type
	independently; set the value of `w3m-current-favicon-image' instead of
	`w3m-current-favicon-data'; store an image into
	`w3m-favicon-cache-data'.
	(w3m-favicon-save-cache-file): Save data only if they contained images;
	strip images from the cache for saving.
	(w3m-favicon-load-cache-file): Create images for all the cache.

	* w3m.el (w3m-buffer-setup): Use `w3m-current-favicon-image' instead of
	`w3m-favicon-converted' for `mode-line-buffer-identification' under
	XEmacs in order to check whether the favicon image is available.
	(w3m-examine-command-line-args): Use `member' instead of `memq' under
	XEmacs to check whether `command-line-args' contains the same string as
	the car of `command-line-args-left'.

2003-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el: Autoload w3m for `w3m-expand-url' when compiling.
	(w3m-setup-favicon): Fix the change of 2003-09-12 which was gone to
	far.

	* w3m.el (w3m-open-all-links-in-new-session): Improve the regexp.
	(w3m-examine-command-line-args): Don't let it misunderstand the next
	command as a url string; modify the arguments in `command-line-args'
	instead of removing them.
	(w3m): Use `w3m-examine-command-line-args' even if it is called
	non-interactively.

2003-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-open-all-links-in-new-session): Don't use
	`w3m-select-buffer'.

2003-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-popup-frame-p): Make it accept the `interactive-p'
	argument.
	(w3m-examine-command-line-args): New function.
	(w3m): Use it.

2003-09-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el: Bind some external variables when compiling.

2003-09-19  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-make-form-data): Insert "--" before the
	multipart post boundary.

2003-09-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-underline-face): New face.
	(w3m-strike-through-face): New user variable.
	(w3m-fontify-strike-through): New function.
	(w3m-fontify): Call `w3m-fontify-strike-through'

2003-09-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-favicon.el (w3m-setup-favicon): Convert favicon data to an image
	for the about: pages using `w3m-convert-favicon'.
	(w3m-buffer-favicon): Move the data conversion procedure to
	`w3m-convert-favicon'.
	(w3m-convert-favicon): New function detached from `w3m-buffer-favicon';
	make it work synchronously.
	(w3m-retrieve-favicon): Convert favicon data to an image.

	* w3m-image.el (w3m-imagick-convert-buffer): Erase buffer before
	calling the convert program.

	* w3m.el (w3m-buffer-setup): Modify the value for
	`mode-line-buffer-identification' in order to make it possible to show
	favicon under XEmacs.

2003-09-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-open-all-links-in-new-session): New function.  Suggested
	by Yoichi NAKAYAMA <yoichi@geiin.org>.
	(w3m-view-this-url-new-session): Call
	`w3m-open-all-links-in-new-session' if the region is active.

2003-09-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-key-binding): Don't use `custom-set-default'.
	(w3m-use-favicon): Ditto.
	* w3m-favicon.el (w3m-favicon-size): Ditto.

	* icons/*.xpm: Remove text.

2003-09-17  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-new): Use `application/x-www-form-urlencoded'
	instead of `urlencoded'.
	(w3m-form-parse-and-fontify): Ditto.
	(w3m-form-make-form-data): Use `multipart/form-data' instead of
	`multipart'.
	(w3m-form-mee-new): Likewise.

2003-09-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-e21-toolbar-configurations): Don't modify the values
	for `tool-bar-button-margin' and `tool-bar-button-relief'.

	* w3mhack.el (w3mhack-nonunix-install): Use icons30 for XEmacs.
	(w3mhack-make-package): Use icons30.

	* Makefile.in (SUBDIRS): Add icons30.
	(install-icons30): New rule.
	(install-package, install-package-ja): Use it.

	* icons/*.xpm: Shrink the size of all icons.
	* icons30/: Old icons are here.

2003-09-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-activate-zmacs-regions): New macro.
	* w3m.el (w3m-next-anchor, w3m-previous-anchor, w3m-next-form,
	w3m-previous-form, w3m-next-image, w3m-previous-image,
	w3m-scroll-up-or-next-url, w3m-scroll-down-or-previous-url,
	w3m-beginning-of-line, w3m-end-of-line): Use it.

2003-09-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-backward): Return nil if there is no
	previous element.

	* w3m.el (w3m-view-previous-page): Skip the current page if it seems
	broken; warn if there's no more history.
	(w3m-copy-buffer): Use the current history for the url string if the
	current page seems broken.
	(w3m-goto-url): Use `lexical-let' to pass the history position data to
	the asynchronous w3m process.

2003-09-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el: Move the favicon stuff to w3m-favicon.el.

	* w3m-favicon.el: New file detached from w3m-e21.el.
	(w3m-favicon-type): Adapt it to XEmacs as well.
	(w3m-setup-favicon): Ditto.
	(w3m-buffer-favicon): Ditto.
	(w3m-retrieve-favicon): Replace `float-time' with `w3m-float-time'.
	(w3m-arrived-setup-functions): Don't add-hook it here.
	(w3m-arrived-shutdown-functions): Ditto.

	* w3m-xmas.el: Require `w3m-favicon'.

	* w3m.el (w3m-arrived-setup-functions): Add
	`w3m-favicon-load-cache-file' if w3m-favicon is loaded.
	(w3m-arrived-shutdown-functions): Add `w3m-favicon-save-cache-file' if
	w3m-favicon is loaded.

	* w3m-util.el (w3m-float-time): New function.

	* w3mhack.el (w3mhack-examine-modules): Exclude w3m-favicon.el from the
	files to be byte-compiled.

2003-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url-1): Fix a window configuration only when
	the buffer's major mode has changed from the w3m-mode to another.
	(w3m-goto-url): Don't erase a buffer when retrieving a local file.

2003-08-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-copy-buffer): Copy the history before visiting a page in
	order to show the about://history/ page correctly; adjust the position
	in the history after copying.
	(w3m-goto-url): Use buffer-local properties instead of global
	properties for form data.
	(w3m-reload-this-page): Specify the history element to the
	`w3m-goto-url' function in order to submit the form data.

2003-08-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url-1): Don't kill the emacs-w3m buffer when a
	process is in progress.
	(w3m-goto-url-new-session): Ditto.

2003-08-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-previous-page): Specify a history element of the
	previous page to the `w3m-goto-url' function as the 7th arg.
	(w3m-goto-url): Accept a history element as the 7th argument; specify
	nil as the 7th argument when recursively calling itself; use a given
	history element to examine the form data of the url to be visited.
	(w3m-goto-url-new-session): Specify nil to the `w3m-goto-url' function
	as the 7th argument.
	(w3m): Ditto.

2003-08-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-minimize-in-new-session): New user option.
	(w3m-history-set-current): Redefine as an inline function rather than a
	macro.
	(w3m-history-current-1): Abolish the function.
	(w3m-history-current-2): Abolish the function.
	(w3m-history-element): New function.
	(w3m-history-current): Abolish the funtction.
	(w3m-history-backward): Don't modify the current position pointer in
	the `w3m-history' variable.
	(w3m-history-forward): Simplify using `w3m-history-backward'.
	(w3m-history-copy): Minimize the history when
	`w3m-history-minimize-in-new-session' is non-nil.
	(w3m-history-plist-get): Abolish the `url' argument; complement the
	meaning of the `local' argument.
	(w3m-history-add-properties): Ditto.
	(w3m-history-plist-put): Ditto.
	(w3m-history-remove-properties): Ditto.
	(w3m-history-store-position): Don't specify the optional arguments to
	`w3m-history-add-properties'.
	(w3m-history-restore-position): Abolish the `url' argument; don't
	specify the optional arguments to `w3m-history-plist-get'.
	(w3m-history-minimize): Simplify using `w3m-history-element'.

	* w3m.el (w3m-view-previous-page): Don't specify the optional arguments
	to `w3m-history-plist-get' and `w3m-history-restore-position'.
	(w3m-goto-url): Don't specify the optional arguments to
	`w3m-history-plist-put', `w3m-history-plist-get',
	`w3m-history-remove-properties' and `w3m-history-add-properties'.
	(w3m-reload-this-page): Don't specify the optional arguments to
	`w3m-history-plist-get' and `w3m-history-remove-properties'.

2003-08-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-flat): Reduce the deepness of local
	prpoerties in the list structure.
	(w3m-history-assoc): Simplify; redefine as an inline function.
	(w3m-history-with-element): Abolish the macro.
	(w3m-history-current-2): New function.
	(w3m-history-set-plist): New function.
	(w3m-history-modify-properties): Rewrite.
	(w3m-history-seek-properties): Abolish the function.
	(w3m-history-seek-element): New function.
	(w3m-history-share-properties): Abolish the function.
	(w3m-history-tree): Tiny change.
	(w3m-history-push): Rewrite.
	(w3m-history-copy): Tiny change.
	(w3m-history-plist-get): Synch to the change of `w3m-history-flat'.
	(w3m-history-plist-put): Rewrite.
	(w3m-history-add-properties): Rewrite.
	(w3m-history-remove-properties): Rewrite.
	(w3m-history-rename-url): Abolish the function.
	(w3m-history-store-position): Abolish the optional argument.
	(w3m-history-minimize): New command.

2003-08-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-current-1): Redefine as a function rather
	than a macro.
	(w3m-history-previous-position): Ditto.
	(w3m-history-next-position): Ditto.
	(w3m-history-modify-properties): Ditto.
	(w3m-history-save-position): Abolish the macro.
	(w3m-history-forward-1): Ditto.
	(w3m-history-backward-1): Ditto.
	(w3m-history-with-element): Abolish the `set-current' argument.
	(w3m-history-assoc): Ditto.
	(w3m-history-plist-get): Ditto.
	(w3m-history-plist-put): Ditto.
	(w3m-history-add-properties): Ditto.
	(w3m-history-remove-properties): Ditto.
	(w3m-history-rename-url): Ditto.
	(w3m-history-set-current): New macro.
	(w3m-history-forward): Abolish the `set-current' argument; use
	`w3m-history-set-current'.
	(w3m-history-backward): Ditto.
	(w3m-history-tree): Use `w3m-history-set-current' instead of
	`w3m-history-forward-1'.
	(w3m-history-push): Use `w3m-history-set-current'.
	(w3m-history-store-position): Don't specify the `set-current' argument
	to `w3m-history-add-properties'.
	(w3m-history-restore-position): Don't specify the `set-current'
	argument to `w3m-history-plist-get'.

	* w3m.el (w3m-view-previous-page): Don't specify the `set-current'
	argument to `w3m-history-plist-get'.
	(w3m-goto-url): Don't specify the `set-current' argument to
	`w3m-history-plist-put', `w3m-history-plist-get',
	`w3m-history-remove-properties' and `w3m-history-add-properties'.
	(w3m-reload-this-page): Don't specify the `set-current' argument to
	`w3m-history-plist-get' and `w3m-history-remove-properties'.

2003-08-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url-1): Fix a window configuration if a new
	buffer visiting the specified url is not in the `w3m-mode'; remove a
	newly created buffer if it is useless.
	(w3m-goto-url): Don't use `save-excursion' when performing find-file
	directly.
	(w3m-goto-url-new-session): Remove a newly created buffer if it is
	useless.

2003-08-12  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* Makefile.in (what-where): Add space to avoid error on Solaris.

	* w3m-namazu.el (w3m-about-namazu): Fix last change.

2003-08-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-previous-position): New macro.
	(w3m-history-next-position): New macro.
	(w3m-history-forward-1): Simplified using new macro(s).
	(w3m-history-backward-1): Ditto.
	(w3m-history-regenerate-pointers): Ditto.
	(w3m-history-assoc): Ditto.
	(w3m-history-current-1): Don't use old-fashioned backquotes.
	(w3m-history-save-position): Ditto.
	(w3m-history-modify-properties): Ditto.
	(w3m-history-with-element): Ditto.

2003-08-10  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-namazu.el (w3m-about-namazu): Fixed problem when further links
	contain "&amp;".

2003-08-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-get-header): Removed.
	(w3m-w3m-parse-header, w3m-w3m-dump-head): New function.
	(w3m-w3m-attributes): Call the above functions.
	(w3m-w3m-dump-head-source): Removed.
	(w3m-w3m-dump-extra): New function.
	(w3m-w3m-retrieve, w3m-w3m-retrieve-1): Reimplemented.
	(w3m-about-header): Call `w3m-w3m-dump-head' instead of
	`w3m-w3m-get-header'.

	* w3m-proc.el: Changes to support recursive call of functions creating
	asynchronous processes.
	(w3m-process-waited): Abolished.
	(w3m-process-handler-new): Add result slot.
	(w3m-process-handler-functions): Renamed from
	`w3m-process-handler-function'.
	(w3m-process-handler-result): New macro.
	(w3m-process-with-null-handler): Reimplemented.
	(w3m-process-start-and-wait): New function.
	(w3m-process-with-wait-handler): Reimplemented.
	(w3m-process-do): Reimplemented.
	(w3m-process-do-with-temp-buffer): Reimplemented.
	(w3m-process-sentinel): Accept the 3rd argument.  Follow the above
	changes.

2003-08-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-reuse-history-elements): New user option.
	(w3m-history-forward): Return a cons of a new history element and new
	position pointers of a history.
	(w3m-history-backward): Ditto.
	(w3m-history-regenerate-pointers): New function.
	(w3m-history-push): If `w3m-history-reuse-history-elements' is nil,
	sprout a new history branch even if history elements for the same url
	already exist.
	(w3m-history-add-arrived-db): Abolish the optional argument; bind
	`w3m-history-reuse-history-elements' to t.

	* w3m.el (w3m-view-previous-page): Assume `w3m-history-backward'
	returns cons data; bind `w3m-history-reuse-history-elements' to t; fix
	position pointers of a history after visiting a page.
	(w3m-goto-url): Fix position pointers of a history when a page is
	referred to by the about://history/ page.
	(w3m-about-history): Include position pointers in an html form.
	(w3m-history-highlight-current-url): Make history position data
	invisible.

2003-07-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decode-entities): Don't trust in the `match-data' after
	the `w3m-entity-value' function is performed.

2003-07-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-command, w3m-user-agent, w3m-command-arguments,
	w3m-command-arguments-alist, w3m-no-proxy-domains,
	w3m-command-environment, w3m-fill-column, w3m-mailto-url-function,
	w3m-mailto-url-popup-function-alist, w3m-imitate-widget-button,
	w3m-pixels-per-character, w3m-coding-system,
	w3m-terminal-coding-system, w3m-input-coding-system,
	w3m-output-coding-system, w3m-file-coding-system,
	w3m-file-name-coding-system, w3m-default-coding-system,
	w3m-coding-system-priority-list, w3m-profile-directory, w3m-init-file,
	w3m-default-save-directory, w3m-accept-languages, w3m-icon-directory,
	w3m-home-page, w3m-arrived-file, w3m-keep-arrived-urls,
	w3m-keep-cache-size, w3m-follow-redirection, w3m-resize-image-scale,
	w3m-default-content-type, w3m-content-type-alist,
	w3m-encoding-type-alist, w3m-decoder-alist,
	w3m-charset-coding-system-alist, w3m-correct-charset-alist,
	w3m-horizontal-scroll-columns, w3m-horizontal-shift-columns,
	w3m-edit-function, w3m-url-local-directory-alist,
	w3m-pop-up-frame-parameters, w3m-horizontal-scroll-division,
	w3m-mbconv-command, w3m-local-find-file-regexps,
	w3m-local-find-file-function, w3m-local-directory-view-method,
	w3m-dirlist-cgi-program, w3m-add-referer-regexps, w3m-touch-command,
	w3m-uri-replace-alist, w3m-db-history-display-size,
	w3m-select-buffer-window-ratio): Improve the customizing widgets.

	* w3m-symbol.el (w3m-symbol-custom-type): New variable.
	(w3m-default-symbol, w3m-Chinese-BIG5-symbol, w3m-Chinese-CNS-symbol,
	w3m-Chinese-GB-symbol, w3m-Japanese-symbol, w3m-Korean-symbol): Use it.
	(w3m-symbol): Improve the customizing widgets.

	* w3m-search.el (w3m-search-engine-alist, w3m-search-default-engine):
	Improve the customizing widgets.
	* w3m-perldoc.el (w3m-perldoc-command, w3m-perldoc-pod2html-command,
	w3m-perldoc-pod2html-arguments): Ditto.
	* w3m-filter.el (w3m-filter-rules): Ditto.

2003-07-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-namazu.el (w3m-namazu-command, w3m-namazu-arguments,
	w3m-namazu-page-max, w3m-namazu-default-index-customize-spec,
	w3m-namazu-index-alist, w3m-namazu-output-coding-system,
	w3m-namazu-input-coding-system): Improve the customizing widgets.
	* w3m-image.el (w3m-imagick-convert-program): Ditto.
	* w3m-form.el (w3m-form-input-textarea-buffer-lines,
	w3m-form-input-select-buffer-lines, w3m-form-input-map-buffer-lines):
	Ditto.
	* w3m-filter.el (w3m-filter-rules): Ditto.
	* w3m-e21.el (w3m-favicon-size, w3m-favicon-cache-file,
	w3m-favicon-cache-expire-wait, w3m-favicon-type, w3m-tab-width): Diito.
	* w3m-dtree.el (w3m-dtree-directory-depth, w3m-dtree-indent-strings,
	w3m-dtree-stop-strings): Ditto.
	* w3m-cookie.el (w3m-cookie-accept-domains, w3m-cookie-reject-domains,
	w3m-cookie-accept-bad-cookies, w3m-cookie-file): Ditto.
	* w3m-bookmark.el (w3m-bookmark-file, w3m-bookmark-file-coding-system,
	w3m-bookmark-default-section): Ditto.
	* w3m-bitmap.el (w3m-bitmap-convert-arguments): Ditto.
	* w3m-antenna.el (w3m-antenna-sites, w3m-antenna-make-summary-function,
	w3m-antenna-sort-changed-sites-function,
	w3m-antenna-sort-unchanged-sites-function, w3m-antenna-file): Ditto.
	* mime-w3m.el (mime-w3m-safe-url-regexp): Ditto.

2003-07-27  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-accept-japanese-characters): Checked loosely.

2003-07-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (clean): Do not remove `shimbun-servers.el'.

	* w3mhack.el: Do not generate `shimbun-servers.el'.
	(shimbun-servers-file): Abolished.
	(w3mhack-compile, w3mhack-batch-compile): Do not call
	`w3mhack-check-shimbun-servers-file'.
	(w3mhack-generate-shimbun-servers-file): Removed.
	(w3mhack-check-shimbun-servers-file): Removed.

	* w3m.el (w3m-fontify-anchors): Handle `id' attributes of anchors.
	Thanks to Shinichiro HIDA and TAKAISHI Hayato for their reports.
	(w3m-fontify-bold, w3m-fontify-underline): Stricten regular expressions
	to detect tags.  For more detail, see [emacs-w3m:05600].

2003-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el (mime-w3m-display-inline-images): Improve the customizing
	widget.

2003-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-language, w3m-command-environment,
	w3m-content-type-alist, w3m-encoding-type-alist, w3m-decoder-alist,
	w3m-charset-coding-system-alist, w3m-correct-charset-alist,
	w3m-url-local-directory-alist, w3m-pop-up-frame-parameters): Improve
	the customizing widgets.

2003-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-generate-shimbun-servers-file): Exclude rss.

2003-07-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-form.el (w3m-form-set-method): New inline function, that is a
	`setf' method of `w3m-form-method'.

	* w3mhack.el (w3mhack-examine-modules): Because Mew 2.x and later do
	not support Mule2.3 and Emacs19, ignore mew-shimbun.el when compiling
	on such Emacsen.

2003-07-24  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-output-coding-system): Changed condition to use utf-8
	with w3m-m17n.
	(w3m-halfdump-command-arguments): Ditto.

2003-07-24  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-parse-and-fontify): Fix for the pages in which
	form_int appears after input_alt.

2003-07-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Force texinfmt.elc to load texinfo.elc
	from the correct place.  <cf. [emacs-w3m:05573]>

2003-07-19  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-e21.el (w3m-euc-japan-encoder): Fixed comment.


2003-07-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3.6 from emacs-w3m-1_3 branch.

2003-07-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-e21.el (w3m-ccl-get-ucs-codepoint-with-emacs-unicode): Remove
	`translate-character'.
	(w3m-euc-japan-encoder, w3m-iso-latin-1-encoder): Select appropriate
	encoders when thie file is loaded.

	* w3m-ccl.el (w3m-ccl-write-repeat): Use a literal list of unibyte
	character sets, instead of calling `charset-bytes', in order to avoid
	difference between FSF Emacs and XEmacs.
	(w3m-euc-japan-encoder, w3m-iso-latin-1-encoder): Do not overwrite, if
	they have already been defined.

2003-07-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-examine-modules): Ignore w3m-ccl.el when XEmacs
	doesn't provide the mule feature.

2003-07-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-correct-charset-alist): New user option.
	(w3m-correct-charset): New inline macro.
	(w3m-detect-meta-charset): New function.
	(w3m-decode-buffer): Use `w3m-correct-charset' and
	`w3m-detect-meta-charset'.
	(w3m-create-page): Set `charset' to `w3m-current-content-charset' if it
	is nil.
	(w3m-region): If `charset' is nil, check `content-charset' in `META
	Tag'.

2003-07-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-ccl.el (toplevel): Add autoload for `charset-id' defined at
	w3m-om.el.
	(w3m-ccl-write-repeat): Simplified.
	(w3m-ccl-write-euc-japan-character): Set nil, when
	`read-multibyte-character' is not available.
	(w3m-ccl-write-iso-latin-1-character): Ditto.

	* w3m-om.el: Remove redundant `function'.
	(w3m-om-character-set-alist): New variable.
	(charset-id): New function.

	* w3m.el (w3m-input-coding-system): Change its default value for
	Mule2.3 and Emacsen without Mule.

2003-07-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-examine-modules): Ignore w3m-ccl.el when ccl.el
	is missing.

	* w3m-e21.el (w3m-ccl-get-ucs-codepoint-with-emacs-unicode): Import
	from w3m-ccl.el.

	* w3m-ucs.el (w3m-ccl-get-ucs-codepoint-with-mule-ucs): Import from
	w3m-ccl.el.

	* w3m-ccl.el: Export the above constants.

	* w3m.el (w3m-retrieve-and-render): Check current content charset
	before `w3m-create-page' is called.

2003-07-17  ARISAWA Akihiro <ari@mbf.sphere.ne.jp>
	    TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (toplevel): Do not require `ccl'.
	(w3m-input-coding-system): Change its default value.
	(w3m-internal-characters-alist): Moved to w3m-ccl.el
	(w3m-ccl-write-repeat): Ditto.
	(w3m-euc-japan-decoder): Ditto.
	(w3m-euc-japan-encoder): Ditto.
	(w3m-iso-latin-1-decoder): Ditto.
	(w3m-iso-latin-1-encoder): Ditto.

	* w3m-ccl.el: New file.

	* w3m-ucs.el: Completely rewritten.
	(w3m-euc-japan-mule-ucs, w3m-iso-latin-1-mule-ucs): New coding systems.

	* w3m-e21.el (toplevel): Require `w3m-ccl'.
	(w3m-euc-japan-encoder, w3m-iso-latin-1-encoder): New encoder.

	* w3m-om.el, w3m-e20.el, w3m-xmas.el (toplevel): Require `w3m-ccl'.

2003-07-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-about-db-history): Call `w3m-arrived-time' with string.

2003-07-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-uri-replace-alist): Improve the customizing widget.

2003-07-16  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-copy-buffer): Fix the logical error installed by the last
	change at 2003-07-15.

2003-07-15  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-image-only-page): Abolished.
	(w3m-show-error-information): Return nil.
	(w3m-create-text-page): Return 'text-page.
	(w3m-create-image-page): Return 'image-page.
	(w3m-create-page): Return 'external-view when `w3m-external-view' is
	called.
	(w3m-goto-url): Do not encode a given URL when it points a local page.
	Bind `w3m-current-buffer' locally.  Follow the change of
	`w3m-create-page'.
	(w3m-copy-buffer): Wrap `w3m-goto-url' with
	`w3m-process-with-wait-handler', to avoid unexpected asynchronous
	processes.
	(w3m-region): Bind `w3m-current-buffer' locally.

	* w3m-util.el (w3m-url-local-p): Stricten its regexp.
	(w3m-url-dtree-p): Removed.

2003-07-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-uri-replace-alist): Revert 2003-07-09 change; improve the
	customizing widget.

	* doc/ptexinfmt.el (texinfo-discard-command-and-arg): New function for
	old Emacsen.

2003-07-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-decoder-alist): Simplified.

2003-07-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decoder-alist): Look for the newest inflate command.

2003-07-09  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (w3m-mew-support-cid): Check `mew-version-number'.
	(mew-w3m-cid-retrieve): Support Mew 4.0.53 and later.  Thanks to Kazu
	YAMAMOTO for his patch.

2003-07-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-uri-replace-alist): Add `rpm', `waei', `eiwa', `kokugo'
	and `eiei'.
	(w3m-input-url): Do not encode its return value.
	(w3m-goto-url): Call `w3m-url-transfer-encode-string' to encode a given
	URL.


2003-07-05  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3.5 from emacs-w3m-1_3 branch.

2003-07-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url-1): Simply copy buffer's contents to the
	new session rather than to call `w3m-goto-url'.

2003-07-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-local-file-type): Check whether a regular expression is
	specified, before matching it on a URL.

	* Following changes are to check whether required libraries are
	available.

	* w3mhack.el (toplevel): Do not create `shimbun/shimbun-servers.el' and
	`w3m-kwds.el' only when this file is loaded, to suppress excessive
	messages.
	(w3mhack-check-shimbun-servers-file): New function.
	(w3mhack-check-colon-keywords-file): New function.
	(w3mhack-compile): Call these functions explicitly.
	(w3mhack-batch-compile, w3mhack-locate-library, w3mhack-print-status):
	New functions.

	* configure.in: Check that egrep is available and that regexp-opt.el
	and xml.el are available.

	* aclocal.m4 (AC_EMACS_LISP): Add `-q' option and `-no-site-file'
	option.
	(AC_ADD_LOAD_PATH): Define `--with-attic' option.
	(AC_CHECK_ELISP): New function.

	* Makefile.in (.el.elc): Call `w3mhack-batch-compile' instead of
	`batch-byte-compile'.
	(very-slow): Always call `keywords' target.
	(keywords): Call `w3mhack-check-colon-keywords-file'.

2003-07-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-about-antenna): Fix the expression to decide
	changed sites.

	* w3m.el (w3m-retrieve-and-render): Do not overwrite an arrived time
	with a modified time, even if the modified time is newer than the
	arrived time.  Store a real URL to arrived DB.
	(w3m-about-db-history): Small clean up.

	* attic/xml.el: Import contrib/xml.el of Oort Gnus.  Require cl and
	poe.

2003-07-02  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-bookmark.el (w3m-bookmark-add): Encode special characters
	included in a URL and a title.

	* w3m-antenna.el (w3m-antenna-check-all-sites): Use `w3m-antenna-alist'
	instead of `w3m-antenna-sites'; this change must have no ill effects
	because `w3m-use-setup' merges site informations kept by
	`w3m-antenna-sites' into `w3m-antenna-alist'.
	(w3m-about-antenna): Fix.
	(w3m-antenna-add-current-url): Encode special characters included in
	`w3m-current-title'.

	* w3m.el: Changes of functions handling the arrived database, and clean
	up w3m-retrieve-and-render() and related parts.
	(w3m-content-type-alist): Change spec.
	(w3m-attributes): Strip authentication part from URL before checking
	charsets given by a user.
	(w3m-arrived-add-1): Removed.
	(w3m-arrived-add): Reimplemented.
	(w3m-arrived-modify): Removed.
	(w3m-arrived-time): Define its `setf' method.
	(w3m-arrived-get, w3m-arrived-put): New inline functions.
	(w3m-arrived-title): Define as a macro using `w3m-arrived-get'.
	(w3m-arrived-last-modified): Ditto
	(w3m-arrived-content-charset): Ditto
	(w3m-arrived-content-type): Ditto.
	(w3m-arrived-shutdown): Modify a predicate used for comparing arrived
	elements, to ensure that every URL precedes its variants with
	fragments.
	(w3m-encode-specials-string): New function.
	(w3m-safe-decode-buffer): New function.
	(w3m-rendering-extract-title): Simplified.
	(w3m-rendering-half-dump): Define as a normal function.
	(w3m-rendering-buffer): Do not call `w3m-filter'.
	(w3m-retrieve-and-render): Reimplemented.
	(w3m-show-error-information): Change its argument spec.
	(w3m-content-prepare-functions): Abolished.
	(w3m-prepare-content): Reimplemented.
	(w3m-prepare-text-content, w3m-prepare-image-content): Removed.
	(w3m-create-text-page, w3m-create-image-page): New functions; the
	successors of the aboves.
	(w3m-create-page): New function.
	(w3m-goto-url): Follow above changes and clean up.
	(w3m-redisplay-and-reset): Call `setf' methods instead of using
	`w3m-arrived-modify'.
	(w3m-redisplay-with-charset): Ditto.
	(w3m-redisplay-with-content-type): Ditto.
	(w3m-about-header): Strip authentication part from URL before
	extracting titles.
	(w3m-about-history): Encode special characters included in a title.
	(w3m-about-db-history): Encode special characters in the title.  Ignore
	URLs that include fragments.

2003-07-01  TAKAHASHI Kaoru  <kaoru@kaisei.org>

	* doc/ptexinfmt.el: @verb, @tie, @/ support.
	(ptexinfmt-broken-facility): Abolish NO-NOTICE argument.  Use
	`ptexinfmt-disable-broken-notice-flag' instead.

2003-07-01  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-mime-text/html-w3m): Add CHARSET argument of
	`w3m-region' when no w3m-m17n.

2003-07-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* mime-w3m.el (mime-w3m-preview-text/html): Call `w3m-region' with
	`charset' option.

2003-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Use `w3m-url-strip-fragment' instead of
	`w3m-base-url' for local files.

2003-07-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-arrived-load-list): Check that `w3m-arrived-file' exists
	before deleting it.
	(w3m-check-refresh-attribute): Condition relaxed.
	(w3m-region): Disable checking refresh attribute.

2003-06-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Some miscellaneous changes and large changes to make a filter
	module cooperate with w3mmee and w3m-m17n.
	(w3m-language): Stricten its customize spec.
	(w3m-attributes): Call `w3m-url-strip-fragment' instead of using a
	literal regular expression.
	(w3m-arrived-load-list): New function.
	(w3m-arrived-setup, w3m-arrived-shutdown): Use the above.
	(w3m-url-decode-string): Call `vector' instead of `string' to avoid
	making unexpected multibyte characters.
	(w3m-decode-buffer): Do not call `w3m-decode-get-refresh'.
	(w3m-decode-get-refresh): Removed.
	(w3m-check-refresh-attribute): New function, the successor of the
	above.
	(w3m-rendering-half-dump): Encode a content for w3mmee and w3m-m17n
	with `w3m-current-coding-system' instead of giving it as a binary data.
	Because `w3m-current-coding-system' keeps a coding system used to
	decode the current buffer, all characters should be recovered by this
	encoding.
	(w3m-rendering-buffer-1): Removed.
	(w3m-rendering-buffer): New function, the successor of the above.
	(w3m-rendering-unibyte-buffer): Removed.
	(w3m-rendering-multibyte-buffer): Removed.
	(w3m-prepare-text-content): Always call `w3m-decode-buffer'. Call
	`w3m-rendering-buffer' instead of `w3m-rendering-unibyte-buffer'.
	(w3m-goto-url): Fix regular expressions.
	(w3m-region): Accept the 4th optional argument, `charset'.  Set
	`w3m-current-coding-system' to the coding system based on the given
	charset.  Call `w3m-rendering-buffer' with the charset.

2003-06-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Include other files first.

2003-06-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-shimbun-modules-using-rss): Don't use
	`with-temp-buffer'.

2003-06-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-shimbun-modules-using-rss): New function.
	(w3mhack-examine-modules): Call the above instead of a literal list.

2003-06-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/Makefile.in (install): Don't run install-info for non- existent
	info files.

	* w3mhack.el (w3mhack-examine-modules): Also examine
	"sb-pukiwiki-rss.el".

2003-06-19  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-namazu.el (w3m-namazu-complete-index): Consider `predicate'
	option.

	* w3m-weather.el (w3m-weather-completion-table): Add `oki' as the
	shortend form of `shimanekenoki'.

2003-06-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-fontify-anchors): Do not encode fragment parts.

2003-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-examine-modules): Ignore the shimbun modules
	which need xml.el if it is not available.

2003-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Improve the last change.


2003-06-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3.4 from emacs-w3m-1_3 branch.

2003-06-18  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-arrived-ignored-regexp): Use "\`" instead of "^".
	(w3m-history-ignored-regexp): Ditto.
	(w3m-url-transfer-encode-string): New inline function.
	(w3m-fontify-anchors): Encode URL with the attribute `charset'.
	(w3m-input-url): Encode URL with `w3m-default-coding-system'.
	(w3m-about-header): Display the current anchor information.

	* w3m-form.el (w3m-form-parse-and-fontify): Encode URL with the
	attribute `charset'.

2003-06-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Encode messages to terminal while
	formatting info pages.

2003-06-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-w3m-attributes): Improve the regexp to extract
	content-types.

2003-06-08  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-parse-and-fontify): Apply
	`w3m-decode-anchor-string' to the form action url.

2003-06-05  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* doc/emacs-w3m.texi, doc/emacs-w3m-ja.texi: Their license is changed
	from GNU Free Documentation License to GNU General Public License.

2003-05-30  Yuuichi Teranishi  <teranisi@gohome.org>

	* octet.el (toplevel): Require poe.
	(octet-filter-call1): Use `make-temp-file' instead of `make-temp-name'.
	(octet-filter-call2): Ditto.
	(octet-filter-call2-extra): Ditto.
	(octet-temp-directory): Changed default value to
	`temporary-file-directory'.

2003-05-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (DOCS): FAQ, FAQ.ja, README.namazu.ja, README.shimbun.ja,
	TIPS and TIPS.ja are merged into Info.

2003-05-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* doc/Makefile.in (dvi): New target to create dvi files; related
	targets and macros are installed.

	* doc/.cvsignore: Ignore dvi files.

	* configure.in: Check whether texi2dvi, ptex and jbibtex exists.

2003-05-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* .cvsignore: Ignore tarballs.

	* Makefile.in (SUBDIRS): New macro.
	(tarball): Refer the above macro, and put texinfo sources into a
	tarball.

	* aclocal.m4 (AC_ADD_LOAD_PATH): Use the variable `EGREP' instead of
	the literal `grep'.

2003-05-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (byte-optimizer for match-string-no-properties): `lenght'
	-> `length'.

2003-05-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Simplify functions that rewrite URIs.
	(toplevel): Autoload `w3m-search-uri-replace' instead of
	`w3m-search-quick-search-handler'.
	(w3m-uri-replace-alist): Changed its default value and its customize
	spec.
	(w3m-pattern-uri-replace): New function.
	(w3m-uri-replace): Reimplemented.

	* w3m-search.el (w3m-search-quick-search-engine-alist): Abolished.
	(w3m-search-quick-search-engines): Removed.
	(w3m-search-quick-search-handler): Removed.
	(w3m-search-uri-replace): New function.

2003-05-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-highlight-current-anchor): Don't infloop even if a w3m
	buffer is narrowed.

2003-05-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-make-package): Make it work under non-Mule
	XEmacs.

2003-05-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-use-safe-url-regexp): New variable.
	(mew-w3m-view-inline-image, mew-mime-text/html-w3m): Use
	`mew-w3m-use-safe-url-regexp' for `w3m-safe-url-regexp'.

2003-05-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (Top): Use w3m-treat-drive-letter for `w3m-expand-path-name'.

2003-05-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* mime-w3m.el (mime-w3m-preview-text/html): Apply the patch posted by
	Yoichi NAKAYAMA <yoichi@geiin.org> in [emacs-w3m:04836], that correct
	the wrong usage of `message'.

2003-05-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-fontify-anchors): Invalidate the widget keymap in XEmacs;
	add a help-echo to the widget button.
	(w3m-make-minor-mode-keymap): Bind [down-mouse-2] to `undefined' to
	invalidate the `widget-button-click' command in FSF Emacs.

2003-04-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-imitate-widget-button): New variable.
	(w3m-imitate-widget-button): New function.
	(w3m-fontify-anchors): Imitate the widget button.
	(w3m-next-anchor): Look for the widget button.
	(w3m-previous-anchor): Ditto.

2003-04-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-retrieve-and-render): Hide a exit status from an error
	message unless `w3m-process-exit-status'.

2003-04-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Improve and bug fix the find-file code.

2003-04-16  Chihiro Kuroda  <chee@iijmio-mail.jp>

	* w3m.el (w3m-download): Download a directory url to index.html
	(by default) instead of signaling an error.

2003-04-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-local-find-file-regexps): New user option.
	(w3m-local-find-file-function): New user option.
	(w3m-goto-url): Use the function specified by the
	`w3m-local-find-file-function' variable for local files when the file
	name matches the `w3m-local-find-file-regexps' variable.

2003-04-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-search.el (w3m-search-engine-alist): Change coding-system to
	`euc-japan' of "waei" and "kokugo". Tnx, Mr. Saito (sai@yedo.com) for
	his report.

2003-03-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-check-all-sites): Call `make-symbol'
	instead of `gensym', in order to make this function free from runtime
	CL functions.

2003-03-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug): Make it possible to send a bug
	report even if emacs-w3m is not running.

2003-03-03  Michael Shields  <shields@msrl.com>

	* w3m-xmas.el (w3m-create-image): Protect against images which are not
	permitted to be loaded according to `w3m-safe-url-regexp'.

2003-02-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-util.el (w3m-get-server-hostname): Rename and move from
	`w3m-process-get-server-root' in `w3m-proc.el'.

	* w3m-proc.el (w3m-process-set-authinfo, w3m-process-read-user)
	(w3m-process-read-passwd, w3m-process-y-or-n-p): Use
	`w3m-get-server-hostname' instead of `w3m-process-get-server-root'.

	* w3m.el (w3m-show-error-information): New customized variable.
	(w3m-w3m-attributes): Message strange `Location:' like lynx.
	(w3m-retrieve-and-render): When error occur, show error message in `w3m
	buffer' to be accompanied by `w3m-show-error-information'.
	(w3m-show-error-information): New function.
	(w3m-reload-this-page, w3m-redisplay-this-page)
	(w3m-redisplay-and-reset, w3m-redisplay-with-charset)
	(w3m-view-source, w3m-view-header): If `w3m-current-url' is nil, dont'
	execute command.
	(w3m): Guard from the bug of `select-frame-set-input-focus' in
	Emacs-21.3.x. If `w3m-current-url' is nil in `w3m buffer'

2003-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-generate-shimbun-servers-file): Exclude fml,
	glimpse, lump, mailarc, mailman, mhonarc and text; indent.
	(w3mhack-generate-colon-keywords-file): indent.

2003-02-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Add www.alltheweb.com
	suggested by Chris Beggy <chrisb@kippona.com>; make the default value
	more suitable to the language environment; don't use the old fashioned
	backquotes.
	(w3m-search-default-engine): Always default to google.
	(w3m-search-prefer-japanese-site): Remove.
	(w3m-search-inhibited-japanese-engines): Remove.
	(w3m-search): Bind `completion-ignore-case' to t.
	(w3m-search-quick-search-handler): Remove
	`w3m-search-prefer-japanese-site' and
	`w3m-search-inhibited-japanese-engines'.

2003-02-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-w3m-attributes): Allow imperfect Status-Line like no
	Reason-Phrase. Guard broken header like no location field.

2003-02-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-util.el (w3m-url-local-p): Use `\`' instead of `^'.

2003-02-21  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-local-dirlist-cgi): Treat a `local cookie file', again.

2003-02-16  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-type): Support "release candidate" of w3m.

2003-02-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-insert-image): Use `map-extents' instead of
	`extent-at' repeatedly.
	(w3m-remove-image): Ditto.

2003-02-05  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-submit): Remove `!CURRENT_URL!' from action
	tag.

2003-02-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (TopLevel): Don't gererate the w3m-kwds.el file if there
	is no permission to write.

	* Makefile.in (clean): Remove shimbun/shimbun-servers.el.

2003-02-04  Yoichi NAKAYAMA  <yoichi@eken.phys.nagoya-u.ac.jp>
	Katsumi Yamaoka <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-generate-shimbun-servers-file): New function.
	(TopLevel): Call it.

2003-02-04  Yoichi NAKAYAMA  <yoichi@eken.phys.nagoya-u.ac.jp>

	* w3mhack.el (shimbun-servers-file): New constant.

2003-02-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-mode): Bind `auto-hscroll-mode' for Emacs-21.3.

2003-01-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-image-type): Move forward.
	(w3m-fontify-images): Use `w3m-action' and `w3m-anchor' instead of
	`get-text-property'.
	(w3m-toggle-inline-images-internal): Use `w3m-image' instead of
	`get-text-property'.
	(w3m-toggle-inline-image): Don't specify the arg to `w3m-image'.
	(w3m-resize-inline-image-internal): Use `w3m-image' instead of
	`get-text-property'.
	(w3m-zoom-in-image): Don't specify the arg to `w3m-image'.
	(w3m-zoom-out-image): Ditto.
	(w3m-view-this-url): Don't bother to call `w3m-anchor' if it is
	needless.
	(w3m-print-this-url): Don't pull-in the point into the link if it is
	called non-interactively.
	(w3m-highlight-current-anchor-1): Use `w3m-anchor-sequence' instead of
	`get-text-property'.
	(w3m-next-anchor): Don't put `nil' element into `w3m-goto-anchor-hist';
	use `push' instead of `cons'.
	(w3m-previous-anchor): Ditto.
	(w3m-next-form): Use `w3m-action' instead of `get-text-property'; don't
	put `nil' element into `w3m-goto-anchor-hist'; specify the current
	position to `w3m-action'; use `push' instead of `cons'.
	(w3m-goto-previous-form): indent.
	(w3m-previous-form): Use `w3m-action' instead of `get-text-property';
	don't put `nil' element into `w3m-goto-anchor-hist'; specify the
	current position to `w3m-action'; use `push' instead of `cons'.
	(w3m-next-image): Use `w3m-image' instead of `get-text-property'; don't
	put `nil' element into `w3m-goto-anchor-hist'; specify the current
	position to `w3m-image'; use `push' instead of `cons'.
	(w3m-previous-image): Ditto.

	* w3m-form.el (w3m-form-resume): Use `w3m-action' instead of
	`get-text-property'; specify the current position to `w3m-action'.
	(w3m-fontify-textareas): Use `w3m-anchor-sequence' instead of
	`get-text-property'.
	(w3m-form-replace): Use `w3m-action' instead of `get-text-property'.
	(w3m-form-textarea-info): Use `get-text-property' instead of
	`w3m-get-text-property-around'.
	(w3m-form-reset): Use `w3m-action' instead of `get-text-property'.

	* w3m-util.el (w3m-get-text-property-around): Always search for the
	text prop around there and pull-in the point into the position where
	the prop exists.
	(w3m-action, w3m-anchor, w3m-image, w3m-submit): Use
	`get-text-property' if the argument is omitted.
	(w3m-image-scale): Abolished.
	(w3m-anchor-sequence): Simplified.

	* mime-w3m.el (mime-w3m-mode-map): Bind it when compiling.

2003-01-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (top): Move the last addition (modifying the value for
	`shell-file-name') just after loading `cl'.

2003-01-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3mhack.el (top): Set `cmdproxy.exe' to `shell-file-name' when Win32
	environment.

2003-01-28  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-local-dirlist-cgi): Treat a `local cookie file'.

2003-01-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-ucs.el (w3m-ucs-to-char): Guard error for Mule-UCS 0.85.

2003-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-byte-optimize-letX): Add `pathname-coding-system'
	to be removed from `let' bindings.

2003-01-26  MIYOSHI Masanori  <miyoshi@boreas.dti.ne.jp>

	* w3m-e21.el (w3m-favicon-type): Add BMP at the head of the list.
	(w3m-favicon-type): Undo the last change and make the priority of BMP
	the lowest.

2003-01-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Withdraw the change of 2003-01-09.

2003-01-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-examine-modules, w3mhack-load-path): Check the
	existence of Gnus for shimbun/nnshimbun.el.

2003-01-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-function-max-args): Don't use the arglist
	destructively.

	* mime-w3m.el (kill-new): Don't refer to the whole arglist of the
	original function.

2003-01-21  Masatake YAMATO  <jet@gyve.org>

	* w3m.el (w3m-scroll-down-or-previous-url): Added doc string.

2003-01-19  TSUCHIYA Masatoshi  <tsuchiya@pine.kuee.kyoto-u.ac.jp>

	* w3m.el (toplevel): Strict checking that buggy `w3m-time-parse-string'
	is used.

2003-01-14  Katsumi Yamaoka  <yamaoka@jpl.org>
	Suggested by KURIHARA Kenichi <kenichi_kurihara@nifty.com>.

	* w3m.el (w3m-async-exec): Always default to `t'.
	(w3m-process-connection-type): Default to `nil' under MacOS X.

2003-01-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Insert one excessive newline after a
	@foo{bar} thing to prevent clinging of a line and a line
	(old texinfmt bug?) if it should be considered only one thing in a
	line.

2003-01-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-ext-url-show): Use `mew-buffer-message' instead
	of `mew-window-configure'.

2003-01-06  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-ext-url-show): New funcition.
	(mew-w3m-ext-url-fetch): Ditto.
	(top): Modify comment. Avoid byte-compile warning for
	`mew-window-configure'.

2002-12-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-about-db-history): Display the information of page.

2002-12-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-local-dirlist-cgi): Treat a local cookie.

2002-12-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-e21.el (w3m-favicon-type): Change default value and type of
	custom.
	(w3m-favicon-type-alist): New internal variable.
	(w3m-setup-favicon): Don't check 'xpm.
	(w3m-buffer-favicon): Decide image type of Emacs use
	`w3m-favicon-type-alist'.

2002-12-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-type): Suppert `stable version notation' of w3m-m17n.

2002-12-12  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-use-favicon): Moved from w3m-e21.el.

	* w3m-image.el (w3m-favicon-usable-p): Moved from w3m-e21.el.

	* w3m-e21.el : Bind `w3m-use-favicon' when compiling.
	(w3m-favicon-usable-p): Moved to w3m-image.el.
	(w3m-use-favicon): Moved to w3m.el.

2002-12-07  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-text-chop): Added nil check.

2002-12-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-what-where): Don't say [-ja] especially.

2002-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/ptexinfmt.el: Modify it not to use APEL functions.

	* w3mhack.el (w3mhack-makeinfo): Remove last temporal mod.

2002-12-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Temporally fix to help users who don't
	have APEL that use texinfmt if loading doc/ptexinfmt.el is failed.

2002-12-02  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* doc/Makefile.in: Remove GNU make things.

2002-12-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (w3mhack-makeinfo): Don't format Japanes info if the mule
	feature is not provided.

	* aclocal.m4 (AC_PATH_LISPDIR, AC_PATH_ICONDIR): Undo last change.

	* doc/Makefile.in (INSTALL_INFO): New variable.
	(install): Use it.

2002-11-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (srcdir): New variable.
	(FLAGS): Specify an absolute path to w3mhack.el.
	(all-en): New rule.
	(all-ja): Made it make only Japanese info.
	(info-en): New rule.
	(install-en): New rule.
	(install-ja): Made it install only Japanese info.
	(install-lisp): Use `$(srcdir)/' instead of `./'.
	(install-icons): Ditto.
	(install-info-en): New rule.
	(Makefile): Use `$(srcdir)/' instead of `./'.
	(config.status): Ditto.
	(very-slow): Specify an absolute path to attic/addpath.el.

	* doc/.cvsignore: Add version.texi.

	* doc/ChangeLog: Removed.

	* doc/Makefile.in (srcdir, subdir, top_srcdir): New variables.
	(FLAGS): Specify an absolute path to w3mhack.el.
	(EMACSINFO): Use `$(top_srcdir)' instead of `..'.
	(INFO_DEPS): Include both emacs-w3m.info and emacs-w3m-ja.info.
	(INFO_DEPS_EN): New variable.
	(en): New rule.
	(version.texi): New rule.
	(emacs-w3m.info): Made it depend on version.texi.
	(emacs-w3m-ja.info): Ditto.
	(install): Use `$(top_srcdir)/' instead of `../'.
	(install-en): New rule.

	* doc/version.texi: Removed from the CVS repository.

2002-11-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* doc/Makefile.in (clean): Fix target.

2002-11-29  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3mhack.el (w3mhack-nonunix-install): Create parent directories.

2002-11-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/texinfo.tex: Replaced with the latest version.

2002-11-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-header-line-map): Prevent tool-bar from being doubled
	under Emacs 21.

2002-11-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (infodir): Add a variable.
	(default): Use `all'.
	(all, all-ja): New rules.
	(lisp): Renamed from `default'.
	(what-where): Pass `infodir' to `w3mhack-what-where'.
	(info, info-ja): New rules.
	(install): Use `install-lisp' and `install-info'.
	(install-ja): New rule.
	(install-lisp): Renamed from `install'.
	(install-info, install-info-ja): New rules.
	(install-package): Use `install-lisp' instead of `install'; install
	info files as well.
	(install-package-ja): New rule.
	(clean): Remove info files as well.
	(distclean): Remove doc.Makefile as well.

	* aclocal.m4 (AC_PATH_LISPDIR, AC_PATH_ICONDIR): Modify a message for
	`install-package'.

	* configure.in: Check for the makeinfo command; create doc/Makefile.

	* w3mhack.el (w3mhack-make-package): Add info file names into a
	MANIFEST file.
	(w3mhack-what-where): Show where info files will go.
	(w3mhack-makeinfo): New function.

2002-11-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/Makefile.in, .cvsignore: New file.

	* doc/emacs-w3m.texi, emacs-w3m-ja.texi: Correct copyright holder.

	* doc/emacs-w3m.texi: Renamed from emacs-w3m-en.texi.

	* doc/txi.tex: Renamed from txi-en.tex.

2002-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Specify coding-system for
	the waei and kokugo entries.  Suggested by Hideyuki SHIRAI.

2002-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* doc/emacs-w3m-en.texi, emacs-w3m-en.texi: Convert to GFDL.

2002-11-27  Yoichi NAKAYAMA  <yoichi@eken.phys.nagoya-u.ac.jp>

	* doc/emacs-w3m-en.texi: New files.
	* doc/emacs-w3m-ja.texi:
	* doc/ptexinfmt.el:
	* doc/texinfo.tex:
	* doc/txi-en.tex:
	* doc/txi-ja.tex:
	* doc/version.texi:

2002-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-tabmenu.el (w3m-tab-menubar-update): Do nothing when there's no
	menubar.

2002-11-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-view-this-url-1): Keep position when new-session and
	`w3m-view-this-url-new-session-in-background' is non-nil.

2002-11-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-mime-text/html-w3m): Use `match-string-no-properties'
	if it exist.

2002-11-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-goto-url): Use an optional argument and the function
	`interactive' to examine whether it is called interactively instead of
	the function `interactive-p'.  Suggested by TSUCHIYA Masatoshi.
	(w3m-goto-url-new-session): Ditto.
	(w3m): Ditto.
	(w3m-select-buffer-show-this-line): Ditto.

2002-11-14  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-w3m-attributes): Bind `case-fold-search' to t.

2002-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search-engine-alist): Add some dictionaries.
	(w3m-search-default-engine): Default to google.
	(w3m-search-quick-search-engine-alist): Add iij-archie; add
	customization type.
	(w3m-search-prefer-japanese-site): New user option.
	(w3m-search-inhibited-japanese-engines): New user option.
	(w3m-search-quick-search-engines): New function.
	(w3m-search-quick-search-handler): Maybe use a Japanese site; use
	`w3m-search-quick-search-engines' to merge `w-s-engine-alist' and
	`w-s-quick-search-engine-alist'.

	* w3m.el (w3m): Allow quicksearch urls if interactive.

2002-11-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3.el (w3m-view-this-url-1): Copy `w3m-current-url' into a copied
	buffer.
	(w3m-goto-url): Allow the 7th argument `qsearch'; use it to recursive
	call the function itself if the quicksearch feature is permitted.
	(w3m-goto-url-new-session): Specify the 7th arg of `w3m-goto-url' if it
	is called interactively.

2002-11-08  Romain FRANCOISE  <romain@orebokech.com>

	* w3m-search.el (w3m-search-engine-alist): Add "google groups".
	(w3m-search-quick-search-engine-alist): New user option.
	(w3m-search-quick-search-handler): New function.

	* w3m.el: Autoload `w3m-search-quick-search-handler'.
	(w3m-goto-url): Use `w3m-search-quick-search-handler' to parse
	quicksearch url schemes.

2002-11-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-bookmark.el (w3m-bookmark-safe-string): Abolish its 2nd `coding'
	argument.  Instead of it, use the coding system to be used for encoding
	the buffer contents on saving.
	(w3m-bookmark-write-file): Follow the above change.

2002-11-06  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-fontify-textareas): Replace textarea string only
	when form data contains non-nil data.

2002-11-05  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (toplevel): Added autoload setting for
	`w3m-fontify-textareas'.
	(w3m-fontify): Don't remove tag strings in the textareas; Call
	`w3m-fontify-textareas'.

	* w3m-form.el (w3m-form-treat-textarea-size): New option.
	(w3m-form-resume): Do nothing if forms is nil.
	(w3m-fontify-textareas): New function.
	(w3m-form-parse-and-fontify): Decode entities for form value; Record
	textarea rows as text property.
	(w3m-form-parse-and-fontify): Treat CRLF as a newline character.
	(w3m-form-search-textarea): New function.
	(w3m-form-textarea-replace): Rewrite.
	(w3m-form-textarea-info): Ditto.

2002-11-05  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-bookmark.el (w3m-bookmark-file-coding-system): Fix its docstring.
	(w3m-bookmark-verify-modtime): Keep buffer modified status.
	(w3m-bookmark-safe-string): New function.
	(w3m-bookmark-write-file): Call it to make given strings be safe.

2002-11-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-bookmark.el: Use non-visiting working buffer; Auto-detection of
	bookmark file coding system.
	(w3m-bookmark-file-coding-system): Fix its docstring.
	(w3m-bookmark-buffer-file-name): New internal variable.
	(w3m-bookmark-mode): Add documents for commands.
	(w3m-bookmark-mode-setter): Set `default-directory'.
	(w3m-bookmark-buffer): Use non-visiting working buffer.
	(w3m-bookmark-sections): Follow the above change.
	(w3m-bookmark-kill-entries): Likewise.
	(w3m-bookmark-file-modtime, w3m-bookmark-verify-modtime)
	(w3m-bookmark-save-buffer): New functions.
	(w3m-bookmark-write-file): Use it; Stricten check.
	(w3m-bookmark-add-current-url-group): Call `w3m-bookmark-add' without
	2nd argument.
	(w3m-about-bookmark): Give unique id to sections.
	(w3m-bookmark-current-number): Follow the above change.
	(w3m-bookmark-kill-entry): If the bookmark file is reverted, reload it.
	(w3m-bookmark-undo): Ditto.
	(w3m-bookmark-edit): New function.

2002-11-02  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-bookmark.el (w3m-about-bookmark): Fix.
	(w3m-bookmark-current-number): Return nil on no entry line.
	(w3m-bookmark-kill-entry): On no entry line, do not call
	`w3m-bookmark-kill-entries'.
	(w3m-bookmark-kill-entries): Fix.

2002-11-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-namazu.el (w3m-namazu): Change prompt.
	(w3m-namazu): Change prompt; Small fix.

	* w3m-bookmark.el: Experimental bookmark editer.
	(w3m-bookmark-read-file): Removed.
	(w3m-bookmark-buffer): New function.
	(w3m-bookmark-sections): Use it.
	(w3m-bookmark-write-file): Use it; Call `basic-save-buffer'.
	(w3m-bookmark-view): View about://bookmark/ instead of
	w3m-bookmark-file directly.
	(w3m-about-bookmark, w3m-bookmark-current-number)
	(w3m-bookmark-kill-entry, w3m-bookmark-kill-entries)
	(w3m-bookmark-undo): New functions.
	(w3m-bookmark-mode, w3m-bookmark-mode-map): New variables.
	(w3m-bookmark-mode-hook): New hook.
	(w3m-bookmark-mode): New minor mode.
	(w3m-bookmark-mode-setter): New function.
	(toplevel): Register it to `w3m-display-functions'.

2002-10-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-generate-colon-keywords-file): Protect against
	unexpected data structure.

2002-10-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-attributes): Remove workaround for servers which do
	not support HEAD operations.


2002-10-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3.3 from emacs-w3m-1_3 branch.

2002-10-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (find-charset): Alias to ignore if no-Mule.

2002-10-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-entity-alist): Use `w3m-mule-unicode-p' instead of
	`w3m-use-mule-ucs'.

	* w3m-xmas.el (w3m-mule-unicode-p): New function.

	* w3m-fsf.el (w3m-mule-unicode-p): New function.

	* w3m-om.el (w3m-mule-unicode-p): Set aliase to `ignore'.

	* w3m-e19.el (w3m-mule-unicode-p): Set aliase to `ignore'.

2002-10-25  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m.el (w3m-entity-alist): Support all entities using Mule-UCS.

2002-10-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* mew-w3m.el: Cancel the last change.  Use `w3m-minor-mode'.

	* mime-w3m.el (mime-w3m-display-inline-images): Fix its docstring.
	(mime-w3m-safe-url-regexp): Fill its docstring.
	(mime-w3m-setup-hook): New hook.
	(mime-w3m-setup): Do not initialize `mime-w3m-mode-map'; Run the above
	hook.
	(mime-w3m-mode-map): It is not defined for XEmacs and Emacs21.
	(mime-w3m-local-map-property): New function.
	(mime-w3m-preview-text/html): Call it.

	* w3m.el (w3m-key-binding): Cancel the last change.
	(w3m-region): Change the interactive form; Do not process <base> tag by
	itself.
	(w3m-minor-mode-command-alist): Cancel the last change.
	(w3m-minor-mode-map, w3m-minor-mode-hook, w3m-minor-mode): Revival.

2002-10-23  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-toggle-inline-images-internal)
	(w3m-toggle-inline-image, w3m-view-this-url, w3m-view-this-url)
	(w3m-submit-form, w3m-external-view, w3m-view-image)
	(w3m-save-image, w3m-view-url-with-external-browser)
	(w3m-download-this-url, w3m-edit-this-url, w3m-goto-url)
	(w3m-goto-url-with-timer, w3m-safe-view-this-url)
	(w3m-safe-view-this-url): Check validity of the URL.
	(w3m-print-current-url, w3m-edit-current-url): Check `w3m-current-url'.

	* w3m-util.el (w3m-url-fallback-base): Move from `w3m.el'.
	(w3m-url-invalid-regexp): New constant.
	(w3m-url-valid): New inline function.

	* mew-w3m.el (mew-mime-text/html-w3m): Remove any properties from
	`xref'.

2002-10-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-om.el (coding-system-list): Use `defalias' and `lambda' instead
	of `defun'; allow an optional dummy argument; don't ignore `*noconv*'.
	(read-passwd): Use `defalias' and `lambda' instead of `defun'.
	(compose-mail): Ditto.

2002-10-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-key-binding): Remove the code to reset
	`w3m-minor-mode-map'.
	(w3m-minor-mode-command-alist): Update its docstring.
	(w3m-minor-mode-map, w3m-minor-mode-hook, w3m-minor-mode): Abolished.
	(w3m-minor-mode): Removed.

	* mime-w3m.el (mime-w3m-setup): Call `w3m-make-minor-mode-keymap'
	without using `w3m-minor-mode-map'.

	* mew-w3m.el (mew-use-w3m-minor-mode): Update its docstring.
	(mew-w3m-minor-mode-map): New variable.
	(toplevel): Revival the code to add a minor mode.
	(mew-w3m-minor-mode-setter): Cancel the last change.

2002-10-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-key-binding): Revival the code to reset
	`mime-w3m-mode-map'.

	* mime-w3m.el (mime-w3m-mode-map): Revival.
	(mime-w3m-setup): Initialize `mime-w3m-mode-map' based on
	`w3m-minor-mode-map'; Modify it to set its parent map to
	`mime-view-mode-default-map'.
	(mime-w3m-preview-text/html) [XEmacs,Emacs21]: Unify `local-map' as
	text property.

	* w3m.el (w3m-make-minor-mode-keymap): Call `make-spase-keymap' instead
	of `make-keymap'.

2002-10-22  Shun-ichi GOTO  <gotoh@taiyo.co.jp>

	* w3m.el (w3m-entity-regexp): As simple regexp. Existance of final
	semi-collon is to be detected.
	(w3m-entity-value): 2nd argument STRICT is added. If not STRICT, find
	entity from db by maxmum length matching, and returns it with appending
	unused chars. Returns nil if not match.  And also use defun instead of
	defsubst.
	(w3m-decode-entities): Use new `w3m-entity-value' with 2nd arg.

2002-10-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-minor-mode): Define without `define-minor-mode'.
	(w3m-minor-mode): Ditto.
	(w3m-minor-mode-hook): Ditto.
	(w3m-entity-regexp): Set 3000 to `max-specpdl-size' locally to avoid
	max-specpdl-size error.

	* w3m-e19.el: Cancel the last change to define `define-minor-mode'.
	* w3m-fsf.el: Ditto.
	* w3m-om.el: Ditto.

	* attic/easy-mmode.el: Removed.

2002-10-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e19.el: Require `easy-mmode'; make the alias `define-minor-mode'
	to `easy-mmode-define-minor-mode'.
	* w3m-fsf.el: Ditto.
	* w3m-om.el: Ditto.

	* attic/easy-mmode.el: New file imported from Emacs 20.7.

2002-10-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-lynx-like-map, w3m-info-like-map): Add [tab] for
	`w3m-next-anchor'.
	(w3m-safe-view-this-url, w3m-mouse-safe-view-this-url): New command.
	(w3m-minor-mode-command-alist): New constant.
	(w3m-make-minor-mode-keymap): New function.
	(w3m-minor-mode-map): New keymap.
	(w3m-minor-mode): New function.

	* mime-w3m.el (mime-w3m-mode-map): Abolished.
	(mime-w3m-mode-command-alist): Abolished.
	(mime-w3m-mode-dont-bind-keys): Abolished.
	(mime-w3m-mode-ignored-keys): Abolished.
	(mime-w3m-setup): Do not initialize `mime-w3m-mode-map'.
	(mime-w3m-preview-text/html): Use `w3m-minor-mode-map' instead of
	`mime-w3m-mode-map'.
	(mime-w3m-view-this-url, mime-w3m-mouse-view-this-url): Removed.

	* mew-w3m.el (mew-w3m-minor-mode): Abolished.
	(mew-w3m-minor-mode-setter): Call `w3m-minor-mode'.

2002-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e19.el: Cancel last change for providing the base64 codec.

2002-10-21  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-goto-url): Use 'group:' scheme instead of
	'about://group/...'; Use url encoding for the member of URL group
	instead of base64 encoding.

	* w3m-bookmark.el (w3m-bookmark-add-current-url-group): Follow the
	change above.

2002-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e19.el: Require `poe' and `path-util'; attempt to define the
	functions `base64-decode-string' and `base64-encode-string'.

	* w3m-util.el (w3m-display-progress-message): New function.
	* w3m.el (w3m-goto-url-new-session): Use it.
	(w3m): Use it.

2002-10-21  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-goto-url): Process 'about://group/...'.

	* w3m-bookmark.el (w3m-bookmark-add-current-url-group): New function.

2002-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-buffer): Run `w3m-delete-buffer-hook' only when a
	buffer is killed.
	(w3m-pack-buffer-numbers): Arrange buffers sequentially from 1 instead
	of 0.
	(w3m-select-buffer-next-line): Update gutter tabs for XEmacs.
	(w3m-select-buffer-delete-buffer): Run `w3m-delete-buffer-hook'.

	* w3m-util.el (w3m-buffer-number): Assume the buffer number has begun
	from 1 instead of 0.
	(w3m-buffer-set-number): Ditto.
	(w3m-buffer-name-lessp): Ditto.

2002-10-19  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* w3m.el (w3m-entity-alist): Support Greek.

2002-10-20  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-goto-url): Display a help message to stop asynchronous
	process.

2002-10-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-input-textarea-keymap): Don't bind C-g.
	(w3m-form-input-select-keymap): Ditto.
	(w3m-form-input-map-keymap): Ditto.

	* w3m.el (w3m-select-buffer-mode): Add some key descriptions to the
	doc-string.

2002-10-17  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* icons/db-history-up.xpm: Add missing comma.

2002-07-19  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-symbol.el: New file.

	* w3m.el: Autoload "w3m-symbol" for `w3m-replace-symbol'.
	(w3m-use-symbol): New variable.
	(w3m-fontify): Call `w3m-replace-symbol'.

	* w3mhack.el (w3mhack-examine-modules): Don't byte-compile
	w3m-symbol.el if no-MULE.

2002-10-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-e21.el (w3m-buffer-favicon): Bind local null handler with
	`w3m-process-with-null-handler' instead of `lexical-let'.

2002-10-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-proc.el (w3m-process-push, w3m-process-start): Fix last change.

2002-10-16  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-rendering-half-dump): To decide whether
	`w3m-treat-image-size' is ignored, use `w3m-display-inline-images-p'
	instead of `w3m-display-graphic-p'.  Thanks to Mito for his report.
	(w3m-about): Add `witdh' and `height' property to <img> tag.

2002-10-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-emacs-w3m-icon): Use helvetica-bold to widen image.

2002-10-15  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-lynx-like-map): Don't define key bindings for
	`w3m-zoom-out-image' and `w3m-zoom-in-image' when emacs-w3m in running
	in non-graphical display.
	(w3m-info-like-map): Ditto.

2002-10-15  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>
	    Mito <mito@mxa.nes.nec.co.jp>

	* w3m.el (w3m-rendering-half-dump): Ignore `w3m-treat-image-size' when
	emacs-w3m is running in non-graphical display.

2002-10-13  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-local-dirlist-cgi): Follow the change of
	`w3m-process-start'.
	(w3m-w3m-get-header): Ditto.
	(w3m-w3m-dump-head-source): Ditto.

	* w3m-image.el (w3m-imagick-convert-async-exec): Abolished.
	(w3m-imagick-start): Removed.
	(w3m-imagick-start-convert-buffer): Call `w3m-process-start' instead of
	the above function.

	* w3m-proc.el (w3m-process-push): Accept `command' argument.
	(w3m-process-start): Ditto.

2002-10-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-dump-head-source): Do not display the help message
	when `w3m-process-with-wait-handler' is evaluated.
	(w3m-make-separator): New function.
	(w3m-about-header): Use the above function.

	* w3m-proc.el (w3m-process-waited): New variable.
	(w3m-process-error-handler): New function.
	(w3m-process-with-wait-handler): Wrap the critical part with
	`condition-case' to clean running processes up when `quit' signal is
	occured.

2002-10-10  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-dump-head-source): Display the message which
	describes how to stop asynchronous process.
	(w3m-lynx-like-map): Changed the key binded to `w3m-process-stop' from
	`C-c C-g' to `C-c C-k'.
	(w3m-info-like-map): Ditto.

2002-10-08  MIYOSHI Masanori  <miyoshi@boreas.dti.ne.jp>

	* README.shimbun.ja: Add notice that f1express requires Mule-UCS.

	* README.shimbun.ja: Ditto.

2002-10-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-toggle-inline-images-internal): Simplify the code.
	(w3m-resize-inline-image-internal): Remove an existing bitmap image
	first.

	* w3m-bitmap.el (w3m-bitmap-image-insert): Replace
	`insert-before-markers' with `insert' (return to the state before
	2002-04-15).

2002-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-create-resized-image): Return nil when resizing is
	failed; set buffer multibyte before converting xbm to bitmap.

	* w3m-xmas.el (w3m-create-resized-image): Return nil when resizing is
	failed.

	* w3m-image.el (w3m-resize-image-by-rate): Undo last change.

2002-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-create-resized-image): New function.

	* w3m-e19.el (w3m-create-resized-image): Alias to `ignore'.
	* w3m-e20.el (w3m-create-resized-image): Alias to `ignore' if the
	BITMAP-MULE is not available.
	* w3m-om.el (w3m-create-resized-image): Ditto.

	* w3m-image (w3m-resize-image-by-rate): Limit the minimum scale.

	* w3m.el (w3m-resize-inline-image-internal): Remove an existing image
	only for XEmacs.

2002-10-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-create-resized-image): New function.

	* w3m.el (w3m-resize-inline-image-internal): Remove an existing image
	before resizing.

2002-10-01  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-e21.el (w3m-favicon-type): New user variable.
	(w3m-setup-favicon): Check `w3m-favicon-type'.
	(w3m-buffer-favicon): Convert image to `w3m-favicon-type' instead of
	'xpm.

2002-10-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-filter.el (w3m-filter-server-regexp): Fix the value; translate
	the comment into English.

2002-10-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-lynx-like-map): Bind key M-] to `w3m-zoom-in-image'; bind
	key M-[ to `w3m-zoom-out-image'.
	(w3m-info-like-map): Ditto.
	(w3m-mode): Document those new keys.

2002-09-30  KURODA Chihiro  <chee@iijmio-mail.jp>

	* w3m.el (w3m-resize-image-scale): New user option.
	(w3m-toggle-inline-image): Call `w3m-zoom-in-image' without resizing.
	(w3m-resize-inline-image-internal): New inline function.
	(w3m-zoom-in-image): New command.
	(w3m-zoom-out-image): New command.

	* w3m-util.el (w3m-image-scale): New macro.

	* w3m-image.el (w3m-resize-image-by-rate): New function.

	* w3m-e21.el (w3m-create-resized-image): New function.

2002-09-21  Kahlil HODGSON  <dorge@tpg.com.au>

	* w3m.el (ffap-url-regexp): Make sure it is non-nil.

2002-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>
	Follow the change in Gnus.

	* mime-w3m.el (mime-w3m-mode-ignored-keys): New variable.
	(mime-w3m-setup): Use it.

2002-09-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-lynx-like-map): Unbind the key "N" to the command
	`w3m-namazu' in order to avoid binding collision to
	`w3m-view-next-page'.  Thanks to Satoshi TAOKA for his report.
	(w3m-mode): Fix its docstring for `w3m-antenna-add-current-url'.
	Thanks to Satoshi TAOKA and Yoichi NAKAYAMA for the advice.

2002-09-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Ignore byte-compile warnings for the dummy autoloads,
	mis-judging of cl run-time functions and the obsoleteness of
	`make-local-hook' under Emacs CVS.

2002-09-25  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3mhack.el (w3mhack-examine-modules): Do not compile `mew-shimbun.el'
	with old Mew.

	* mew-w3m.el (top): Avoid byte-compile error and warning for old
	Mew. Do not push 'mew-w3m-cid-retrieve' for old Mew.

2002-09-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-arrived-setup): Use 0 instead of nil as the initial value
	for the new obarray.

	* w3m-filter.el (w3m-filter-setup): Use 0 instead of nil as the initial
	value for the new obarray.

2002-09-22  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-mode): Fix typo in its docstring.

2002-09-20  Kahlil HODGSON  <dorge@tpg.com.au>

	* w3m.el (w3m-fontify-bold): Permit class attributes, newlines or
	whitespaces in the tag.
	(w3m-fontify-underline): Ditto.

2002-09-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-treat-drive-letter): New constant.
	(w3m-url-to-file-name): Check `w3m-treat-drive-letter'.

	* w3m-dtree.el (w3m-dtree-directory-name): Check
	`w3m-treat-drive-letter'.

2002-09-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-filter.el (w3m-filter-rules): Add 'assahi shimbun' rule.
	(w3m-filter-asahi-shimbun): New function.

2002-09-05  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-antenna.el (w3m-antenna-setup): Check new entries registered in
	`w3m-antenna-sites'.
	(w3m-antenna-shutdown): Return the value of `w3m-antenna-alist'.
	(w3m-antenna-check-all-sites): Simplified.
	(w3m-about-antenna): Do not call `w3m-antenna-setup'.


2002-09-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3.2 from emacs-w3m-1_3 branch.

	* w3m.el (w3m-init-file): Changed its default value.

	* Makefile.in (PACKAGE): Use `emacs-w3m' instead of `w3m_el'.

	* w3m-antenna.el (w3m-antenna-make-summary-function): Use
	`function-item' instead of `const'.
	(w3m-antenna-sort-changed-sites-function): Ditto.
	(w3m-antenna-sort-unchanged-sites-function): Ditto.
	(w3m-antenna-hns-last-modified): Asynchronized.
	(w3m-antenna-last-modified): Removed.
	(w3m-antenna-check-site): New function
	(w3m-antenna-check-site-after): New function.
	(w3m-antenna-check-sites): Removed.
	(w3m-antenna-check-all-sites): New function.
	(w3m-about-antenna): Asynchronized.
	(w3m-about-antenna-edit): Reset post-data after its content is
	displayed.
	(w3m-antenna-edit-reset-post-data): New function.

2002-09-02  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-init-file): Changed its default value.
	(toplevel): When Emacs is running without interactive terminal, do not
	load the startup file and do not evaluate `w3m-load-hook'.  Load a byte
	compiled startup file safely.

2002-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mailto-url-popup-function-alist): New user option.
	(w3m-view-this-url-1): Don't save a window configuration for mailto
	urls here.
	(w3m-goto-mailto-url): Save a window configuration while composing a
	mail message; popup a mail window if the major-mode of a mail buffer
	matches to `w3m-mailto-url-popup-function-alist'.

2002-09-01  Andrew M. Scott  <ascott@sedona.ch.intel.com>

	* w3m-weather.el (w3m-weather-default-area): Fix typo in its docstring.

2002-08-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el: Provide the feature `w3m' before loading an init file or
	evaluating `w3m-load-hook'.  Suggested by Seiichi NAMBA
	<sn@asahi-net.email.ne.jp>.

2002-08-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-init-file, w3m-load-hook): New option.
	(toplevel): Load `w3m-init-file' and run `w3m-load-hook'.

2002-08-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el: Require `custom' for Emacs 19 because of the function
	`custom-initialize-set'.

2002-08-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el: Clean up hook options.
	(toplevel): Define the dummy function of `w3m-update-tab-line'.
	(w3m-mode-hook, w3m-fontify-after-hook, w3m-select-buffer-hook): Clean
	up its default value to nil.
	(w3m-display-hook, w3m-delete-buffer-hook): Minimize its default value
	and use `w3m-custom-hook-initialize' as the initialize function.
	(w3m-arrived-setup-hook, w3m-arrived-shutdown-hook): Abolished.
	(w3m-arrived-setup-functions, w3m-arrived-shutdown-functions,
	w3m-mode-setup-functions, w3m-display-functions): New interanal
	variables.
	(w3m-arrived-setup): Refer `w3m-arrived-setup-functions' instead of
	`w3m-arrived-setup-hook'.
	(w3m-arrived-shutdown): Refer `w3m-arrived-shutdown-functions' instead
	of `w3m-arrived-shutdown-hook'.
	(w3m-fontify): Call `w3m-header-line-insert' by itself.
	(w3m-next-buffer, w3m-delete-buffer, w3m-delete-other-buffers): Call
	`w3m-select-buffer-update' by itself.
	(w3m-clean-hook-options): New function.
	(w3m-mode): Call `w3m-clean-hook-options', and run functions registered
	to `w3m-mode-setup-functions'.
	(w3m-goto-url): Call `w3m-select-buffer-update' by itself, and Run
	functions registered to `w3m-display-functions'.
	(w3m-select-buffer-update): Call `w3m-update-tab-line'.

	* w3m-util.el (w3m-custom-hook-initialize): New function.

	* w3m-xmas.el: Cancel the last change and refer `w3m-display-functions'
	instead of `w3m-display-hook'.

	* w3m-e21.el (toplevel): Add `w3m-setup-favicon' to
	`w3m-display-functions', `w3m-favicon-load-cache-file' to
	`w3m-arrived-setup-functions', `w3m-favicon-save-cache-file' to
	`w3m-arrived-shutdown-functions', and add `w3m-setup-header-line' and
	`w3m-setup-widget-faces' to `w3m-mode-setup-functions'

	* w3mhack.el (w3mhack-load-path) [Mule]: Add the path of bitmap.el to
	`load-path'.

	* w3m.el (w3m-select-buffer-hook): Renamed from
	`w3m-change-buffer-hook'.
	(w3m-next-buffer): Accept a numerical argument.
	(w3m-previous-buffer): Accept a numerical argument, and call
	`w3m-next-buffer'.
	(w3m-delete-buffer): Call `w3m-next-buffer' instead of
	`w3m-previous-buffer'.

	* w3m.el (w3m-delete-buffer-hook): Change its default value.
	(w3m-change-buffer-hook): New option.
	(w3m-delete-other-buffers-hook, w3m-previous-buffer-hook,
	w3m-next-buffer-hook): Abolished.
	(w3m-next-buffer): Run `w3m-change-buffer-hook' instead of
	`w3m-next-buffer-hook'.
	(w3m-previous-buffer): Run `w3m-change-buffer-hook' instead of
	`w3m-previous-buffer-hook'.
	(w3m-delete-buffer): Not call `w3m-select-buffer-update', which is
	added to `w3m-delete-buffer-hook'.
	(w3m-delete-other-buffers): Likewise.  Run `w3m-delete-buffer-hook'
	instead of `w3m-delete-other-buffers-hook'.

2002-08-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (toplevel): Remove expressions to register hook functions to
	`w3m-delete-buffer-hook', `w3m-delete-other-buffers-hook',
	`w3m-display-hook', and `w3m-fontify-after-hook'.
	(w3m-mode-hook, w3m-fontify-after-hookk, w3m-display-hook,
	w3m-arrived-setup-hook, w3m-arrived-shutdown-hook,
	w3m-delete-buffer-hook, w3m-delete-other-buffers-hook,
	w3m-previous-buffer-hook, w3m-next-buffer-hook): Changed their default
	values to avoid inconsistency of their customize.
	(w3m-toolbar): Fix its help messages.
	(w3m-arrived-file, w3m-keep-arrived-urls, w3m-db-history-display-size):
	Fix their docstrings.
	(w3m-history): Moved to avoid a byte compile warning.

	* w3m-xmas.el (toplevel): Remove an expression to register
	`w3m-xmas-update-tab-in-gutter' to `w3m-display-hook'.
	(w3m-xmas-show-current-title-in-buffer-tab): Remove expressions to
	handle `w3m-display-hook' from the form to change its value.

	* w3m-e21.el (toplevel): Remove expressions to register hook functions
	to `w3m-display-hook', `w3m-arrived-setup-hook',
	`w3m-arrived-shutdown-hook', `w3m-mode-hook', `w3m-fontify-after-hook',
	`w3m-next-buffer-hook', `w3m-previous-buffer-hook',
	`w3m-delete-buffer-hook' and `w3m-delete-other-buffers-hook'.

2002-08-28  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-delete-buffer-hook): New hook.
	(w3m-other-delete-buffers-hook): Ditto.
	(w3m-previous-buffer-hook): Ditto.
	(w3m-next-buffer-hook): Ditto.
	(w3m-view-this-url-new-session-in-background): Fixed docstring.
	(w3m-next-buffer): Run `w3m-next-buffer-hook'.
	(w3m-previous-buffer): Run `w3m-previous-buffer-hook'.
	(w3m-delete-buffer): Run `w3m-delete-buffer-hook'.
	(w3m-delete-other-buffers): Run `w3m-delete-other-buffers-hook'.
	(w3m-pack-buffer-numbers): New function.
	(w3m-delete-buffer-hook): Add `w3m-pack-buffer-numbers'.
	(w3m-delete-other-buffer-hook): Add `w3m-pack-buffer-numbers'.

	* w3m-util.el (w3m-buffer-number): New inline function.
	(w3m-buffer-set-number): Ditto.

	* w3m-e21.el (w3m-update-tab-line): New function.
	(w3m-mode-hook): Add `w3m-update-tab-line'.
	(w3m-fontify-after-hook): Ditto.
	(w3m-previous-buffer-hook): Ditto.
	(w3m-next-buffer-hook): Ditto.
	(w3m-delete-buffer-hook): Ditto.
	(w3m-delete-other-buffers-hook): Ditto.
	(w3m-tab-width): Changed default value to 16.
	(w3m-tab-line): Calculate tab width dynamically.

2002-08-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-output-coding-system, w3m-halfdump-command-arguments):
	Use 'utf-8 when `w3m-m17n' with Mule-UCS environment.
	(w3m-charset-coding-system-alist): Add Windows Code Point.
	(w3m-current-content-charset): New buffer-local variable.
	(w3m-clear-local-variables, w3m-copy-local-variables): Handle it.
	(w3m-decode-buffer): Set `w3m-current-content-charset'.
	(w3m-rendering-half-dump): Use `w3m-current-content-charset' when
	`w3m-m17n' or `w3mmee'.

2002-08-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-lynx-like-map): Change the key `C-c w' to `C-c M-w' for
	the command `w3m-delete-other-buffers'.
	(w3m-info-like-map): Ditto.

2002-08-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (emacs-w3m-version): Reset for development series toward
	emacs-w3m-1.4.

2002-08-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-history): Call `w3m-db-history' instead of goto
	`about://db-history/'.

2002-08-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-delete-other-buffers): New user command.
	(w3m-lynx-like-map): Bind the key `C-c w' to the command
	`w3m-delete-other-buffers'.
	(w3m-info-like-map): Ditto.
	(w3m-select-buffer-mode-map): Bind the key to the command
	`w3m-select-buffer-delete-other-buffers'.
	(w3m-select-buffer-delete-other-buffers): New user command.

2002-08-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-check-header-tags): Ignore case of tags.
	(w3m-about-db-history): Accept range specification in URL.
	(w3m-db-history-display-size): New option.
	(w3m-db-history): Refer it.

	* w3m-antenna.el (w3m-antenna-html-skeleton): Add link to
	about://antenna-edit/.
	(w3m-about-antenna-edit): New function.  This is an experimental
	imprement of the editor for Antenna sites.

2002-08-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (char-after): Byte-optimize it for old Emacsen.
	(char-before): Ditto.

2002-08-23  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-view-this-url-new-session-in-background): New user
	option.
	(w3m-view-this-url-1): Use it; enclose `w3m-goto-url' with
	`save-window-excursion'.

	* w3m-form.el (w3m-form-resume): Confirm `value' for text form is a
	string.

2002-08-22  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (ffap-url-regexp): Fix last change.

2002-08-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (ffap-url-regexp): Modify the value to make it match to nntp
	urls.

2002-08-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (very-slow): New rule.

	* attic/addpath.el: New file.

2002-08-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el: Require `cl' when compiling to provide the function
	`gensym'.  It is needed to byte-compile this file alone because of the
	w3m-proc macros.
	* w3m-image.el: Ditto.
	* w3m-bitmap.el: Don't bother to load cl-macs.

2002-08-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-display-message-enable-logging): New variable.
	(w3m-display-message): Use it.

2002-08-08  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-w3m-retrieve-1): Do not make error but return nil, even
	if decoding is failed.

2002-08-08  Nishimoto Masaki  <nishimoto@gaju.org>

	* w3m-proc.el (w3m-process-with-environment): Copy
	`process-environment' before `getenv' is called, in order to avoid
	putting side effects to environment variables.

2002-07-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e21.el (w3m-ucs-to-char): Return char for tilde by default.


2002-07-17  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3.1 from emacs-w3m-1_3 branch.

2002-07-16  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* mime-w3m.el (toplevel): Bind `mime-preview-condition' to avoid
	byte-compile warnings.
	(mime-w3m-insinuate): Install code to overwrite
	`mime-preview-condition' which is already initialized before this
	functions is called.

2002-07-11  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-image-viewer): New option.
	(w3m-content-type-alist): Refer it.

2002-07-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-decoder-alist): Don't examine the existence of w3m
	command when compiling.
	(w3m-dirlist-cgi-program): Ditto.

2002-07-09  Hironori FUJII  <fujii@chi.its.hiroshima-cu.ac.jp>

	* w3m.el (w3m-highlight-current-anchor): Don't infloop at the beginning
	of a buffer.

2002-07-09  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-perldoc.el (w3m-about-perldoc): Install workaround to specify the
	place in which pod2html generates its cache files.  Adjust links
	pointing other perldocs.

2002-07-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-mode): Make `list-buffers-directory' to buffer local
	variable.
	(w3m-goto-url): Set title of the URL to `list-buffers-directory'.

	* w3m-tabmenu.el (w3m-switch-buffer): Bind `completion-ignore-case' to
	`t'.

2002-07-08  OKAZAKI Tetsurou  <okazaki@be.to>

	* configure.in: Use `AC_PATH_EMACS' instead of `AC_CHECK_EMACS'.

	* aclocal.m4 (AC_PATH_EMACS): New macro.
	(AC_CHECK_EMACS): Removed.


2002-07-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.3 from emacs-w3m-1_3 branch.

2002-07-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (byte-optimize-form-code-walker): Advise to make it
	optimize throughout the and/or forms.
	(max-specpdl-size): Increase the value by 5 times for Mule 2.

2002-07-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-accept-japanese-characters): Don't call the external
	command when compiling.
	(examining the value for `w3m-command'): Ditto.

2002-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-lynx-like-map): Use the key `(control space)' instead of
	`C- ' for the command `w3m-history-store-position' under XEmacs.

2002-06-29  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3mhack.el (w3mhack-nonunix-lispdir): New option.
	(w3mhack-nonunix-icondir): Ditto.
	(w3mhack-nonunix-dryrun): Ditto.
	(w3mhack-nonunix-install): New function.

2002-06-28  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (DOCS): Add `TIPS'.

2002-06-26  Ando Tsutomu  <ando-tom@ff.iij4u.or.jp>

	* w3m-weather.el (w3m-weather-completion-table): Fix typo.

2002-06-27  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-info-like-map): Remove redundant code.

2002-06-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Put `w3m-name-anchor' property to
	point-max().
	(w3m-fontify): Remove `w3m-name-anchor' handling.
	(w3m-search-name-anchor): Move in the screen.

2002-06-26  Tadashi Watanabe  <watanabe@sigmaitec.co.jp>

	* w3m.el (w3m-info-like-map): Don't use FSF Emacs style key format for
	XEmacs.

2002-06-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (toplevel): Stricten the pattern to detect w3m version.
	(w3m-info-like-map): Changed key bindings of `w3m-shift-left' and
	`w3m-shift-right'.

2002-06-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-use-ange-ftp): Chenged its default value to nil.

2002-06-21  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-w3m-retrieve-1): Specify -no-cookie option only when the
	w3m command is configured to accept it.

2002-06-20  Yuuichi Teranishi  <teranisi@gohome.org>

	* octet.el (octet-type-filter-alist): Fixed parenthesis.
	(octet-filter-call1, octet-filter-call2, octet-filter-call2-extra):
	Enclose call-process with as-binary-process.

2002-05-31  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* octet.el (octet-find-file): Bind `buffer-read-only', only while
	calling `octet-buffer'.


2002-06-20  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.2.8 from emacs-w3m-1_2 branch.

2002-06-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el: Require `w3m-e19' for Emacs 19 to be able to compile this
	module alone.

2002-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-search.el (w3m-search): Don't extract a default word from the
	header line.

2002-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-header-line-insert): Use the property `keymap' instead of
	`local-map' for the recent Emacsen; add a help echo; fix a typo.

	* w3m-xmas.el (w3m-setup-header-line): Remove.

2002-06-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-e19.el: Remove many emulating functions on the condition that
	APEL should be used; require `cl' only when compiling; require
	`pcustom' instead of `custom'.
	(compose-mail): New function.
	(read-passwd): Autoload "ange-ftp".

	* w3m-proc.el (read-passwd): Autoload "w3m-e19" for Emacs 19.

	* w3m-util.el (cancel-timer): Autoload "timer" for not only Mule 2 but
	also Emacs 19.

	* w3m.el: Require `w3m-e19' for Emacs 19.

	* w3mhack.el (w3mhack-emacs-major-version): New constant.
	(TopLevel): Silence the byte-compiler for not only Mule 2 but also
	Emacs 19.
	(w3mhack-mdelete): New function.
	(w3mhack-examine-modules): Use it to make the code simple.
	(w3mhack-generate-colon-keywords-file): Be sure to go to the beginning
	of each file before looking for colon keywords (I noticed that
	`insert-file-contents' doesn't always position point to the top).

	* README.ja: Update for the use of Emacs 19.

2002-05-30  Kevin Rodgers  <kevin.rodgers@ihs.com>

	NOTE: The following changes have been posted to the emacs-w3m
	mailing list, they were not installed in the CVS repository at the
	time.  The original article has been archived in:

	http://emacs-w3m.namazu.org/ml/msg03472.html

	* w3m-e19.el: New file.

	* w3m.el: Require `w3m-e19' for Emacs 19.
	(w3m-key-binding): Replace the widget `other' with `const'.

	* w3mhack.el (w3mhack-examine-modules): Include w3m-e19.el in the
	listing for Emacs 19.

	* README: Update for the use of Emacs 19.

2002-06-13  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-prepare-content): When cdr of
	`w3m-content-prepare-functions' element is not function, call
	`w3m-prepare-content' recursively.
	(w3m-content-prepare-functions): Add "application/xhtml+xml" entry.

2002-06-12  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-uri-replace-alist): New user option.
	(w3m-uri-replace): New function.
	(w3m-goto-url): Call `w3m-uri-replace'.

2002-06-02  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-e21.el (w3m-ucs-to-char): Don't define it when already defined.

	* w3m-xmas.el (w3m-ucs-to-char): Ditto.


2002-06-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.2.7 from emacs-w3m-1_2 branch.

	* w3m-weather.el: Require CL when this module is byte-compiled.
	(w3m-weather-completion-table): Fix typos, which are noticed by Ando
	Tsutomu <ando-tom@ff.iij4u.or.jp> in [emacs-w3m:03487].

2002-05-31  Mito <mito@mxa.nes.nec.co.jp>

	* w3m-weather.el (w3m-weather-completion-table): Fix "niigata-kaetsu".

2002-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-make-ccl-coding-system): Make it recallable for the
	existing coding-systems (we can now reload w3m.elc under XEmacs 21.5-b6
	and later).

2002-05-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-w3m-retrieve-1): Don't decode the contents when redirect.

2002-05-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (define-ccl-program): Remove advice when non-MULE.  It
	might be specified by pccl.elc if it has been mis-compiled for XEmacs
	with MULE.

	* w3m.el (w3m-delete-frame-maybe): Don't delete the current frame if it
	is the sole frame in the screen.

2002-05-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (unicode-to-char): Shut XEmacs 21.5-b5 and earlier up
	when compiling.

2002-05-28  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-e21.el (w3m-ucs-to-char): New function.

	* w3m-xmas.el (w3m-ucs-to-char): New function for XEmacs-21.5.

2002-05-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (tarball): Chmod 755 configure.

2002-05-16  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-auto-show): Check multiple command like a
	`previous|next-line' or `beginning|end-of-buffer' at the buffer's edge.
	(w3m-window-hscroll): New function to rescue for XEmacs with Mule.
	(w3m-current-column, w3m-set-window-hscroll): Chenge method of the
	calculation point.  the difference points.
	(w3m-horizontal-scroll, w3m-horizontal-on-screen)
	(w3m-horizontal-recenter): Use `w3m-window-hscroll'.
	(w3m-redisplay-this-page): Don't handle store|restore position.
	(w3m-goto-url): If reload or redisplay, restore position of history.

2002-05-15  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-after-cursor-move-hook): Add `w3m-auto-show'.
	(w3m-auto-show, w3m-horizontal-scroll-division): New options.
	(w3m-next-anchor, w3m-previous-anchor, w3m-next-form)
	(w3m-previous-form, w3m-next-image, w3m-previous-image): Call
	`w3m-horizontal-on-screen'.
	(w3m-mode): Bind many variables for automatic scrolling when
	`w3m-auto-show' is non-nil.
	(w3m-scroll-left, w3m-scroll-right, w3m-shift-left)
	(w3m-shift-right): Call `w3m-horizontal-scroll'.
	(w3m-horizontal-scroll-done): New buffer local variable.
	(w3m-current-position): Modify initial value.
	(w3m-auto-show, w3m-horizontal-scroll, w3m-horizontal-on-screen): New
	functions.
	(w3m-horizontal-recenter, w3m-beginning-of-line)
	(w3m-end-of-line): Use `w3m-set-window-hscroll' and
	`w3m-current-column'.
	(w3m-store-current-position): Set markers of beginning of line and end
	of line.
	(w3m-check-current-position): Check car of `w3m-current-position'.
	(w3m-current-column, w3m-set-window-hscroll): New functions to rescue
	for XEmacs with Mule.

2002-05-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-replace): Don't pad the form slot with spaces
	if a string is longer than that width.

2002-05-14  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-arrived-p): Move its definition in order to avoid
	byte-compile warning.

	* Makefile.in (default, what-where): Change order.

2002-05-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el: Modify the error message that XEmacs APEL package
	versions 1.23 and later can barely be used to run emacs-w3m.

2002-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-mode): Suppress compile warning under old Emacsen.

	* Makefile.in (what-where): New rule.

	* w3mhack.el (w3mhack-what-where): New function.
	(locate-library): Make the function silent for Mule first.

2002-05-13  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-horizontal-shift-columns): New user option.
	(w3m-shift-left, w3m-shift-right): New commands.
	(w3m-lynx-like-map, w3m-info-like-map): Add keybind `w3m-shift-left'
	and `w3m-shift-right'.
	(w3m-mode): Modify doc-string for new commands. Bind `auto-show-mode'
	to nil.

2002-05-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-hist.el (w3m-history-add-arrived-db): Force update the page.

2002-05-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug-system-informations): Don't include
	useless infos; eval the value for each time to load it.
	(report-emacs-w3m-bug): Bind `print-length' and `print-level' with nil.

2002-05-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-menubar): Modify the label for report-emacs-w3m-bug.
	(w3m-lynx-like-map): Replace the key `C-c C-b' with `C-c C-v' for
	`w3m-history-restore-position'; replace the key `C-c b' with `C-c C-b'
	for `report-emacs-w3m-bug'.
	(w3m-info-like-map): Ditto.
	(w3m-mode): Add a document for `report-emacs-w3m-bug'.

	* w3mhack.el: Check for the validity on APEL also for XEmacs with MULE.

	* w3m-bug.el (report-emacs-w3m-bug-system-informations): Add
	(featurep 'mule) and (featurep 'file-coding).

2002-05-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-download): Modify string of the prompt.
	(w3m-prepare-content): Add 5th optional argument `retry'. If not
	determine content-type, ask its.

2002-04-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el (report-emacs-w3m-bug): Bind `after-load-alist' to nil
	while loading the file itself; examine system info in the `w3m-mode'
	buffer.

2002-04-27  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-bug.el (report-emacs-w3m-bug-system-informations): Add
	`mule-version' and `Meadow-version'.
	(report-emacs-w3m-bug): Fix when info is a function.

	* w3m.el (w3m-menubar): Add many functions.

2002-04-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bug.el: New file.

	* w3m.el: Autoload "w3m-bug" for `report-emacs-w3m-bug'.
	(w3m-lynx-like-map): Bind `report-emacs-w3m-bug' to C-cb.<
	(w3m-info-like-map): Ditto.

	* w3m-om.el (compose-mail): New function.

	* w3mhack.el: Check for the validity on APEL.

2002-04-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-arrived-modify): New function.
	(w3m-local-attributes): If set Content-type in arrived DB, return it.
	(w3m-redisplay-this-page, w3m-redisplay-and-reset)
	(w3m-redisplay-with-content-type): New commands.
	(w3m-redisplay-with-charset): Use `w3m-arrived-modify'.
	(w3m-lynx-like-map): Bind all new commands and modify bind for
	`w3m-redisplay-with-charset'.
	(w3m-info-like-map): Ditto.
	(w3m-mode): Document them.
	(w3m-goto-url): If reload is 'redisplay, do redisplay only. Modify
	content-type decided method at local URL.
	(w3m-about-header): Display `Modifer Information'.
	(w3m-header-line-insert): Display modifers when type are setting.

2002-04-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-horizontal-recenter): New command.
	(w3m-beginning-of-line): New command.
	(w3m-end-of-line): New command.
	(w3m-lynx-like-map): Bind them.
	(w3m-info-like-map): Bind them.
	(w3m-mode): Document them.

2002-04-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-face-inherit): Default to t.

	* w3m-om.el (w3m-om-use-overstrike-to-make-face-bold): New var.
	(custom-declare-face): Advise it to use `set-face-bold-p' to make faces
	bold by overstriking.

	* w3m-util.el (w3m-default-face-colors): New constant.
	* w3m.el (w3m-bold-face, w3m-underline-face): Use it.

2002-04-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-insert): Don't put the transparent
	face except for Emacs 20.

	* w3m.el (w3m-key-binding): Don't manipulate key bindings if w3m.elc
	has not been loaded (it will fix the problem that the face colors might
	not be specified under Mule 2).

2002-04-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-transparent-face): Remove.
	(w3m-bitmap-image-insert): Use the list form instead of
	`w3m-bitmap-transparent-face' to make the overlay transparent.

2002-04-23  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-bitmap.el (w3m-bitmap-convert-arguments)
	(w3m-bitmap-image-face-inherit): New customize values.
	(w3m-create-image): Append argument `w3m-bitmap-convert-arguments' when
	call `w3m-imagick-start-convert-buffer'.
	(w3m-insert-image): If `w3m-bitmap-image-face-inherit' is non-nil,
	inherit the face of bitmap image from the face of text at point.

2002-04-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (distclean): Remove autom4te*.cache rather than
	autom4te.cache.

	* w3m-bitmap.el (w3m-bitmap-transparent-face): New face.
	(w3m-bitmap-image-insert): Put `w3m-bitmap-transparent-face' to
	overlays; don't use overlays to highlight bitmap images.
	(w3m-insert-image): Add `w3m-bitmap-image-face' to a bitmap image as a
	text property.

2002-04-23  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-toggle-inline-images-internal): Call `w3m-insert-image'
	with the url of image.

	* w3m-xmas.el (w3m-insert-image): Add dummy argument.

	* w3m-e21.el (w3m-insert-image): Add dummy argument.

	* w3m-bitmap.el (w3m-bitmap-cache-image-hook): New hook.
	(w3m-create-image): Run `w3m-bitmap-cache-image-hook' with `url' when
	use the cached image.
	(w3m-insert-image): Add 4th argument `url'. Do nothing which have no
	'w3m-image property or differ its url.

2002-04-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	Make emacs-w3m can be compiled by `make slow' with no warnings.
	* Makefile.in (slow): Don't echo the values for EMACS and FLAGS.
	* octet.el: Require `w3m-util' for `w3m-insert-string'.
	* w3m-bitmap.el: Autoload w3m-om for `move-to-column-force'.
	* w3m-hist.el: Load w3m-kwds.el for old Emacsen.
	* w3m-image.el: Require `pcustom' for old Emacsen; bind some external
	vars when compiling.
	* w3m.el: Enclose the definitions for `w3m-current-title' and
	`w3m-current-url' with `eval-and-compile', and move them forward.
	(w3m-url-at-point): Enclose with `eval-and-compile'.
	(w3m-add-local-hook): Ditto.
	(w3m-about-retrieve): Call `base64-decode-string' indirectly to avoid
	compile warn under old Emacsen.

	* w3m-util.el (w3m-insert-string): Fix doc-string.

2002-04-22  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-region): Call `w3m-process-stop' first.

	* mew-w3m.el (mew-w3m-view-inline-image): Toggle
	`mew-w3m-auto-insert-image'.
	(mew-w3m-cid-retrieve-hook): New customize hook.
	(mew-w3m-cid-retrieve): Run `mew-w3m-cid-retrieve-hook'.

2002-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-insert-string): Prevent doubling expansion on the
	arg.

2002-04-20  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* mime-w3m.el (mime-w3m-cid-retrieve): Use `w3m-insert-string' instead
	of `insert' to prevent multibyte/unibyte problems.
	* octet.el (mime-preview-octet, mime-view-octet): Ditto.

	* w3m-util.el (w3m-insert-string): Moved from shimbun/shimbun.el.

2002-04-20  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-w3m-attributes): Set type to downcase.

2002-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-about-header): Don't use `make-string' to make a
	separator text under Mule.

2002-04-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-cid-retrieve): Support w3m-bitmap.el when
	retrieve `cid image' (Mew cache has multibyte strings, but work buffer
	is unibyte).

2002-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3mhack.el (TopLevel): Not to get the byte-code for `current-column'
	inlined under old Emacsen.

	* w3m-bitmap.el (w3m-bitmap-emacs-broken-p): Use
	`ad-Orig-current-column' rather than `current-column' if it has already
	been defined.
	(TopLevel): Not to get the byte-code for `current-column' inlined under
	the broken Emacsen in case when compiling manually.

2002-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (TopLevel) Require `cl' and possibly load cl-macs.  The
	following changes are for old Emacsen.
	(w3m-bitmap-emacs-broken-p): New constant.
	(TopLevel): Warn if Emacs has a bug on managing column numbers.
	(w3m-bitmap-move-to-column): Allow the 3rd arg `strictly'; don't modify
	the buffer contents unless the 3rd arg has been set.
	(w3m-bitmap-defadvice-if-broken): New macro; use it to advise the
	functions `current-column', `move-to-column', `move-to-column-force',
	`next-line' and `previous-line' to work under the broken Emacsen.
	(w3m-bitmap-byte-indexed-characters-p): Remove.
	(TopLevel): Don't alias `w3m-bitmap-current-column' to
	`current-column'; don't alias `w3m-bitmap-move-to-column-force' to
	`move-to-column-force'.
	(w3m-bitmap-substitute-key-definitions): Remove.
	(w3m-bitmap-image-insert): Replace `w3m-bitmap-current-column' with
	`current-column'; replace `w3m-bitmap-move-to-column-force' with
	`move-to-column-force'.
	(w3m-bitmap-image-delete-internal): Ditto.

	* w3m-om.el (move-to-column-force): New function using
	`move-to-column-strictly'.

2002-04-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-next-line): Handle `temporary-goal-column'.

2002-04-18  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-halfdump-command-arguments): Fix last change.

2002-04-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-byte-indexed-characters-p): New macro.  The
	following changes are for old Emacsen.
	(w3m-bitmap-move-to-column): New function.
	(w3m-bitmap-move-to-column-force): Use it.
	(w3m-bitmap-next-line): New command.
	(w3m-bitmap-previous-line): New command.
	(w3m-bitmap-substitute-key-definitions): New function; add it to
	`w3m-mode-hook' as the one-shot function.

2002-04-17  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-halfdump-command-arguments): Add `-I e' option to w3m
	under Japanese environment.

2002-04-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mime-w3m.el (mime-w3m-cid-retrieve): Use `mime-decode-string',
	`mime-entity-body' and `mime-entity-encoding' instead of
	`mime-insert-entity-content' to make it work even if the entity buffer
	is multibyte.

2002-04-16  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-check-header-tags): Renamed from w3m-check-link-tags.
	(w3m-check-header-tags): Parse base tag too.
	(w3m-rendering-buffer-1): Use it.
	(w3m-prepare-text-content): Don't use w3m-base-url.

2002-04-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-insert): Replace `insert' with
	`insert-before-markers'.
	(w3m-bitmap-image-delete-internal): Delete trailing newlines.
	(w3m-insert-image): Don't check for the existence of an image.

	* w3m.el (w3m-history-current-url-face): Provide `font' temporally to
	avoid loading it and `cl'.

2002-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-get-overlay): Don't clear the
	`evaorate' property here.
	(w3m-bitmap-image-insert-internal): Rename to
	`w3m-bitmap-image-insert'; change the meaning of the 2nd arg `image'
	(see docs); allow the optional arg `ovr'; don't scan for an overlay
	here; handle `w3m-bitmap-image-count'; use overlays to highlight bitmap
	images.
	(w3m-bitmap-image-insert): Remove old one.
	(w3m-bitmap-image-delete-internal): Allow the 2nd arg `ovr'; don't scan
	for an overlay here; clear the `evaorate' property here.
	(w3m-bitmap-image-delete): Allow the 2nd arg `ovr'; don't scan for an
	overlay here; don't delete an overlay.
	(w3m-bitmap-image-delete-string): Remove.
	(w3m-insert-image): Scan for an overlay here; don't use text props to
	highlight bitmap images.
	(w3m-remove-image): Scan for an overlay here.

2002-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-cleanup): Remove.
	(w3m-bitmap-image-get-overlay): Clear the `evaorate' property in an
	overlay temporally.
	(w3m-bitmap-image-insert-internal): Put the `evaorate' property in an
	overlay; return an overlay.
	(w3m-bitmap-image-insert): Use the return value of
	`w3m-bitmap-image-insert-internal' instead of to call
	`w3m-bitmap-image-get-overlay'.
	(w3m-bitmap-image-insert-string): Remove.
	(w3m-insert-image): Use `w3m-modify-plist' to cleanup plist; don't move
	the point.
	(w3m-remove-image): Replace `w3m-bitmap-image-insert-string' with
	`w3m-bitmap-image-insert-internal'.

	* w3m-util.el (w3m-modify-plist): New function.

2002-04-12  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-proc.el (w3m-process-kill-surely): New internal variable.
	(w3m-process-kill-process): When `w3m-process-kill-surely' is non-nil,
	wait for the completion to kill process surely.

2002-04-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-get-overlay): Speed up a bit.
	(w3m-bitmap-image-insert-internal): Replace `current-column' with
	`w3m-bitmap-current-column'; call `w3m-add-text-properties' only when
	props are specified; use `overlay-end' dynamically (fix a bug I've
	made); replace `move-to-column-force' with
	`w3m-bitmap-move-to-column-force'.
	(w3m-bitmap-image-delete-internal): Make the 2nd arg optional; replace
	`current-column' with `w3m-bitmap-current-column'; replace
	`move-to-column-force' with `w3m-bitmap-move-to-column-force'; guess
	the end position of an overlay by itself when the 2nd arg is omitted.
	(w3m-bitmap-image-delete): Remove the 2nd arg.
	(w3m-bitmap-image-delete-string): Alias to
	`w3m-bitmap-image-delete-internal' instead of defining as a function.
	(w3m-insert-image): Don't use the length of a bitmap image.
	(w3m-remove-image): Ditto.

	* w3m-om.el (move-to-column-force): Remove.

2002-04-10  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-image.el (w3m-imagick-convert-async-exec): Change default value
	for Meadow.

2002-04-10  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-e21.el (w3m-favicon-converted): New buffer-local variable.
	(w3m-setup-favicon): Set w3m-favicon-converted as nil.
	(w3m-buffer-favicon): If w3m-favicon-converted is non-nil, don't start
	conversion.  Set w3m-favicon-converted as t before conversion.

2002-04-10  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-about-retrieve): Change behavior according to whether the
	return value of `base64-decode-string' is multibyte or not.

	* w3m-image.el (w3m-imagick-convert-async-exec): New user option.
	(w3m-imagick-start): Use `call-process' when
	`w3m-imagick-convert-async-exec' is nil.
	(w3m-imagick-convert-buffer): Don't use stdin because `convert' can not
	handle an animation GIF that it input from stdin.

2002-04-10  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-bitmap.el (w3m-create-image): Use w3m-process-do-with-temp-buffer
	instead of w3m-process-do.
	(w3m-create-image): Don't call `set-buffer-multibyte' if old mule.

	* w3m-image.el (w3m-imagick-start-convert-buffer): Removed needless
	`concat'.

	* w3m-bitmap.el (w3m-create-image): Call
	`w3m-imagick-start-convert-buffer' instead of
	`w3m-imagick-convert-data'.

2002-04-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-current-column): New function for old
	Emacsen; alias to `current-column' for the recent Emacsen.
	(w3m-bitmap-move-to-column-force): New function for old Emacsen; alias
	to `move-to-column-force' for the recent Emacsen.

2002-04-10  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-image.el (w3m-imagick-convert-data): Check buffer size.
	(w3m-imagick-start-convert-data): Ditto.
	(w3m-imagick-start-convert-buffer): Don't use output file
	(Because it sometimes causes multiple files).

2002-04-10  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3mhack.el (w3mhack-examine-modules): Reverse the turn of the load
	with `bitmap' and `un-define'.

2002-04-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-face): New face.
	(w3m-bitmap-image-insert-internal): Put text properties.
	(w3m-bitmap-image-insert): Pass text properties argument to
	`w3m-bitmap-image-insert-internal'.
	(w3m-bitmap-image-add-text-properties): Remove.
	(w3m-insert-image): Pass text properties to `w3m-bitmap-image-insert'.

2002-04-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-bitmap.el (w3m-bitmap-image-get-overlay): Use
	`line-beginning-position' and/or `line-end-position'.
	(w3m-bitmap-image-insert-internal): Ditto.
	(w3m-bitmap-image-delete-internal): Ditto.
	(w3m-bitmap-image-add-text-properties): Ditto.

	* w3m-om.el: Require `w3m-bitmap' if BITMAP-MULE is available.
	(move-to-column-force): Define it if void.

2002-04-09  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-bitmap.el: Convert CRLF to LF.
	(w3m-display-graphic-p): Ruturn nil if no window-system.
	(w3m-image-type-available-p): Ruturn nil if not found "convert".

	* w3mhack.el (w3mhack-examine-modules): Don't byte-compile
	w3m-bitmap.el under XEmacs or FSF Emacs-21.

	* w3m.el (w3m-fontify): When delete duplicated empty line, keep
	'w3m-name-anchor property surely.

	* w3m-e20.el (top): Require 'w3m-bitmap if have BITMAP.

2002-04-09  Taiki SUGAWARA  <taiki.s@cityfujisawa.ne.jp>

	* w3mhack.el (w3mhack-examine-modules): Don't byte-compile
	w3m-bitmap.el if bitmap.el is not installed.
	(w3mhack-examine-modules): Add condition to w3m-bitmap.el check.

	* w3m-bitmap.el: New file.

	* w3m-e20.el (w3m-create-image, w3m-insert-image, w3m-remove-image,
	w3m-image-type-available-p, w3m-display-graphic-p,
	w3m-display-inline-images-p): Alias to `ignore'. Bitmap image
	implementation is moved to w3m-bitmap.el.
	(w3m-bitmap-image-cache-alist, w3m-bitmap-image-use-cache,
	w3m-bitmap-image-cleanup, w3m-bitmap-image-buffer,
	w3m-bitmap-image-get-overlay, w3m-bitmap-image-insert-internal,
	w3m-bitmap-image-insert, w3m-bitmap-image-insert-string,
	w3m-bitmap-image-delete-internal, w3m-bitmap-image-delete,
	w3m-bitmap-image-delete-string, w3m-bitmap-image-add-text-properties):
	Move to w3m-bitmap.el.

2002-04-09  Taiki SUGAWARA  <taiki.s@cityfujisawa.ne.jp>

	* w3m-e20.el (w3m-create-image): Return nil if
	w3m-imagick-convert-buffer is failed.
	(w3m-insert-image): Not insert image if image is nil.

2002-04-08  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-coding-system): Change default value to
	'iso-2022-7bit-ss2 when use w3mmee under mule environment.

2002-04-08  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-xmas.el (w3m-create-image): Resize gif images, too.

2002-04-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-make-glyph): Remove unused var.

2002-04-08  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-char-to-int): New alias.
	(w3m-form-mee-attr-unquote): Use it.
	(w3m-form-mee-new): Ditto.

	* w3m-xmas.el (toplevel): Require 'w3m-image.
	(w3m-make-glyph): New inline function.
	(w3m-create-image): Resize images when w3m-resize-images is non-nil.

	* w3m-form.el (w3m-string-to-char-list)[XEmacs]: Use string-to-list
	instead of string-to-char-list.
	(w3m-int-to-char): New alias.
	(w3m-form-mee-select-value): Use it.

2002-04-08  Taiki SUGAWARA  <taiki.s@cityfujisawa.ne.jp>

	* w3m-e20.el (w3m-bitmap-image-insert-internal): Begin the overlay on
	`begion-of-line'.

2002-04-08  Yuuichi Teranishi  <teranisi@gohome.org>

	* octet.el: Update URL for xlhtml.

2002-04-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el: Don't require `pcustom'.

2002-04-08  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-image.el: New file.

	* w3m.el (w3m-halfdump-command-arguments): Specify single-row-image
	dump option instead of image.
	(w3m-goto-mailto-url): Added optional post-data argument and use it.
	(w3m-goto-url): Set post-data of w3m-goto-mailto-url.

	* w3m-util.el (w3m-imagick-convert-program, w3m-imagick-convert-buffer,
	w3m-imagick-convert-data): Moved to w3m-image.el.

	* w3m-e21.el (toplevel): Require 'w3m-image.
	(w3m-resize-images, w3m-imagick-start-convert-data,
	w3m-imagick-start-convert-buffer, w3m-imagick-start, w3m-resize-image):
	Moved to w3m-image.el;
	(w3m-create-image): Follow the change in w3m-resize-image.
	(w3m-favicon-usable-p): Renamed from w3m-imagick-convert-usable-p.
	(w3m-use-favicon): Follow the change above.
	(w3m-favicon-cache-data): Fixed typo.
	(w3m-favicon-cache-retrieved): Ditto.
	(w3m-retrieve-favicon): Ditto.

	* w3m-e20.el (w3m-image): Require 'w3m-image.

2002-04-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (multibyte-string-p): Alias to `stringp' if MULE,
	otherwise `ignore'.

	* w3m-om.el (multibyte-string-p): Alias to `stringp'.

	* w3m-util.el: Require `pcustom' for old Emacsen.

2002-04-05  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-w3m-retrieve): Revert previous change.
	(w3m-w3m-dump-head-source): Add argument orig-url; Cache header and
	body using orig-url.
	(w3m-w3m-retrieve): Don't cache header here; Return error response when
	follow redirection number exceeds w3m-follow-redirection; Pass orig-url
	to w3m-w3m-retrieve-1.
	(w3m-w3m-retrieve-1): Add argument orig-url; Call w3m-dump-head-source
	with orig-url argument.
	(w3m-redirect-with-get): Changed default value to t.

2002-04-05  Taiki SUGAWARA  <taiki.s@cityfujisawa.ne.jp>

	* w3m-e20.el (w3m-bitmap-image-insert): Fix (point) -> pos.

2002-04-04  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-input-map): If menu string is empty, use href
	string instead.

	* w3m.el (w3m-w3m-dump-head-source): Fixed caching logic.
	(w3m-w3m-retrieve): Use cache if available after redirection.

2002-04-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-e20.el (top): Avoid byte-compile warnings when not found
	`bitmap'.
	(w3m-image-type-available-p): Return nil if not have `bitmap'.

2002-04-04  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-fontify-anchors): Set default icon type as ico.

	* w3m-e21.el (w3m-buffer-favicon): Asynchronous implementation.

2002-04-04  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3mhack.el (top): Avoid byte-compile error for `w3m-ucs.el' with
	Emacs20 when it has `un-define' and `bitmap'.
	(w3mhack-load-path): Add the path of `bitmap.el' on Emacs20.

2002-04-04  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-request-arguments): Use -header option if no cookie nor
	no body.
	(w3m-w3m-retrieve-1): Delete temp-file only when it exists.

	* w3m-e21.el (w3m-imagick-start-convert-data): Don't use
	string-as-unibyte (no use).

2002-04-04  Taiki SUGAWARA  <taiki.s@cityfujisawa.ne.jp>

	* w3m.el (w3m-toggle-inline-images-internal): Support w3m-bitmap-image.

	* w3m-e21.el (w3m-imagick-convert-program): Move to w3m-util.el.
	(w3m-imagick-convert-buffer): Ditto.
	(w3m-imagick-convert-data): Ditto.

	* w3m-util.el (w3m-imagick-convert-program): Move from w3m-e21.el.
	(w3m-imagick-convert-buffer): Ditto.
	(w3m-imagick-convert-data): Ditto.

	* w3m-e20.el (w3m-bitmap-image-cache-alist): New variable.
	(w3m-bitmap-image-use-cache): Ditto.
	(w3m-bitmap-image-cleanup): New function.
	(w3m-bitmap-image-buffer): Ditto.
	(w3m-bitmap-image-get-overlay): Ditto.
	(w3m-bitmap-image-insert-internal): Ditto.
	(w3m-bitmap-image-insert): Ditto.
	(w3m-bitmap-image-insert-string): Ditto.
	(w3m-bitmap-image-delete-internal): Ditto.
	(w3m-bitmap-image-delete): Ditto.
	(w3m-bitmap-image-delete-string): Ditto.
	(w3m-bitmap-image-add-text-properties): Ditto.
	(w3m-display-graphic-p): New implementation.
	(w3m-display-inline-images-p): Ditto.
	(w3m-image-type-available-p): Ditto.
	(w3m-create-image): New implementation. It use w3m-bitmap-image-*.
	(w3m-insert-image): Ditto.
	(w3m-remove-image): Ditto.

2002-04-03  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify): Put invisible and intangible properties at the
	duplicated empty lines instead of delete them.

2002-04-03  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-e21.el (w3m-resize-image): Asynchronous implementation.
	(w3m-imagick-start-convert-data): New function.
	(w3m-imagick-start-convert-buffer): Ditto.
	(w3m-imagick-start): Ditto.
	(w3m-create-image): Rewrite to resize images asynchronously.
	(w3m-insert-image): Don't resize.

2002-04-03  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-check-link-tags): Relax the pattern to detect headers.

2002-04-02  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-submit): Confirm when posting from secure page
	to normal page.

	* w3m.el (w3m-redirect-with-get): New user option.
	(w3m-w3m-retrieve): If w3m-redirect-with-get is non-nil, use GET method
	after redirection; Ask user to use POST data after redirection.
	(w3m-w3m-attributes): Set w3m-current-redirect as a cons cell of
	(CODE . LOCATION).
	(w3m-w3m-dump-head-source): Don't cache content if the response code is
	one of 302, 303, 307.
	(w3m-w3m-retrieve): Change POST redirection behavior according to
	response code.
	(w3m-retrieve-and-render): Confirm leaving secure pages.

	* octet.el (mime-preview-octet): Change behavior according to whether
	the return value of mime-entity-content is multibyte or not.
	(mime-view-octet): Ditto.

	* w3m.el (w3m-w3m-retrieve): Don't call w3m-cache-request-header when
	type is nil.

2002-04-01  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-follow-redirection): New user option.
	(w3m-w3m-attributes): Set w3m-current-redirect as nil.
	(w3m-cookie-command-arguments): Abolish.
	(w3m-request-arguments): Use cookie only when w3m-use-cookies is
	non-nil.
	(w3m-header-arguments): New function.
	(w3m-w3m-retrieve): Treat redirection when w3m-follow-redirection is
	non-nil.
	(w3m-w3m-retrieve-1): Renamed from w3m-w3m-retrieve.
	(w3m-prepare-content): Don't care w3m-current-redirect.
	(w3m-goto-url): Ditto.

	* w3m-form.el (w3m-form-new): Added argumnet enctype.
	(w3m-form-enctype): New macro.
	(w3m-form-plist): Changed definition.
	(w3m-form-put-property): Ditto.
	(w3m-form-make-form-data): Removed optional argument urlencode; Encode
	form data acording to w3m-form-enctype.
	(w3m-form-mee-new): Set enctype field.
	(w3m-form-parse-and-fontify): Parse enctype.
	(w3m-form-submit): Don't pass enctype argumnet.

2002-04-01  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-fontify-anchors): Put a property of `w3m-name-anchor' as
	a list.
	(w3m-move-point-for-localcgi): Use `w3m-search-name-anchor'.
	(w3m-search-name-anchor): Use `member' when compare a name with
	`w3m-name-anchor'. Fix continuous name-anchor.

2002-03-29  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-mime-text/html-w3m): Use `match-string' instead of
	`mew-match'.

	* w3m.el (w3m-fontify-anchors): Modify the point for 'w3m-name-anchor
	property when its has an empty body.

2002-03-28  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-dump-head-source-command-arguments)[w3mmee]: Don't add
	Accept-Language header option.
	(w3m-cookie-command-arguments)[w3mmee]: Don't add Cookie header option.
	(w3m-request-arguments): New function to generate -request option.
	(w3m-w3m-retrieve)[w3mmee]: Use w3m-request-arguments to make request
	header and body.

2002-03-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-url-at-point (ffap)): Strip text props under XEmacs.
	(ffap-url-regexp): Modify the value to make it match to https urls for
	Emacs 19, 20 and XEmacs.

2002-03-27  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-e21.el (w3m-tab-drag-mouse-function): Fix problem when dragged
	mouse position is outside of the original frame.

	* w3m.el (w3m-version): New variable.
	(toplevel): Detect w3m version.
	(w3m-user-agent): New user option.
	(w3m-add-user-agent): Ditto.
	(w3m-w3m-retrieve): Add User-Agent: field if w3m-add-user-agent is
	non-nil.

	* w3m-e21.el (w3m-tab-drag-mouse-function): New function.
	(w3m-tab-make-keymap): Add mouse-1, mouse-2, drag-mouse-1 and
	drag-mouse-2.

	* w3m-cookie.el (w3m-cookie-set): Fixed docstring.

2002-03-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-xmas.el (w3m-find-coding-system): Alias to ignore if the function
	`find-coding-system' is not available.
	(w3m-make-ccl-coding-system): Check whether the function
	`make-ccl-coding-system' is available instead of checking the feature
	`mule' to determine what function should be aliased to.
	(coding-system-list): Alias to ignore if it is not available.
	(define-ccl-program): Check whether it is available instead of checking
	the feature `mule' to determine if it is aliased to `ignore'.
	(w3m-detect-coding-with-priority): Quote `w3m-default-coding-system'.

2002-03-24  Nix  <nix@esperi.demon.co.uk>

	* w3m-xmas.el (w3m-detect-coding-with-priority): New macro, handle
	non-MULE XEmacsen.
	(w3m-detect-coding-region): Use it.

2002-03-26  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-cookie.el (w3m-cookie-1-set): Fixed problem when no `Expires',
	ignore is ignored.

2002-03-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-cookie.el (w3m-cookie-url, w3m-cookie-domain, w3m-cookie-secure,
	w3m-cookie-name, w3m-cookie-value, w3m-cookie-path, w3m-cookie-version,
	w3m-cookie-expires, w3m-cookie-ignore): Define as macro.
	(w3m-cookie-set-url, w3m-cookie-set-domain, w3m-cookie-set-secure,
	w3m-cookie-set-name, w3m-cookie-set-value, w3m-cookie-set-path,
	w3m-cookie-set-version, w3m-cookie-set-expires, w3m-cookie-set-ignore):
	Removed.
	(w3m-cookie-create): New implementation.
	(w3m-about-cookie): Call `setf' instead of `w3m-cookie-set-ignore'.

2002-03-26  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-fontify-anchors): Changed anchor name property position.
	(w3m-lynx-like-map): Bind w3m-cookie as `M-k'.
	(w3m-info-like-map): Ditto.

2002-03-26  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-cookie.el (w3m-cookie-save): Use `w3m-time-newer-p' instead of
	`w3m-time-lapse-seconds'.

2002-03-26  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-cookie.el (w3m-cookie): New command.
	(w3m-about-cookie): Do nothing if w3m-use-cookies is nil.

	* w3m.el (toplevel): Added autoload setting for w3m-about-cookie; Added
	autoload setting for w3m-cookie.

	* w3m-cookie.el (w3m-cookie-store): Don't replace if ignored cookie.
	(w3m-cookie-retrieve): Don't use cookie which is ignored.
	(w3m-about-cookie): New function.

	* w3m-e21.el (w3m-setup-favicon): Do nothing when w3m-current-url is
	nil.

	* w3m.el (w3m-goto-url): Force reload if w3m-current-redirect is set.
	(w3m): If w3m-current-url is nil, erase buffer.

	* w3m-util.el (w3m-time-less-p): Abolish.
	(w3m-assoc-ignore-case): Moved from w3m-cookie.el and rewrote not to
	use assoc* (because it's cl function).

	* w3m-cookie.el (w3m-cookie-retrieve): Use w3m-time-newer-p instead of
	w3m-time-less-p.
	(w3m-cookie-1-set): Ditto.
	(w3m-assoc-ignore-case): Moved to w3m-util.el.

2002-03-25  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-cookie.el (w3m-cookie-1-set): Use w3m-time-less-p instead of
	w3m-time-lapse-seconds.
	(w3m-cookie-retrieve): Ditto.

	* w3m-util.el (w3m-time-less-p): New inline function.

	* w3m.el (w3m-current-redirect): New buffer local variable.
	(w3m-clear-local-variables): Add w3m-current-redirect.
	(w3m-copy-local-variables): Treat w3m-current-redirect.
	(w3m-w3m-attributes): Set w3m-current-redirect instead of
	w3m-current-refresh when 30x response.
	(w3m-prepare-content): Use w3m-current-redirect instead of
	w3m-current-refresh.
	(w3m-goto-url): Do nothing but w3m-goto-url after retrieval if
	w3m-current-redirect is set.

2002-03-25  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m-cookie.el (w3m-cookie-file): Changed default value.
	(w3m-cookie-save): Follow the above change.
	(w3m-cookie-load): Ditto.

2002-03-25  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-w3m-attributes): Don't call w3m-cookie-set.
	(w3m-w3m-dump-head-source): Call w3m-cookie-set.
	(w3m-cookie-command-arguments): Set `-no-cookie'; Don't set
	cookie_accept_domains, cookie_reject_domains.

	* w3m-cookie.el (toplevel): Require 'w3m.
	(w3m-cookie-accept-domains): Moved from w3m.el.
	(w3m-cookie-reject-domains): Ditto.
	(w3m-cookie-accept-bad-cookies): New user option.
	(w3m-cookie-file): Ditto.
	(w3m-cookie-set-ignore): Fix.
	(w3m-cookie-retrieve): Remove expired cookies.
	(w3m-cookie-trusted-host-p): Fixed domain match.
	(w3m-cookie-1-set): Treat all cookies.  Accept bad cookies according to
	w3m-cookie-accept-bad-cookies.
	(w3m-cookie-init): New variable.
	(w3m-cookie-clear): New function.
	(w3m-cookie-save): Ditto.
	(w3m-cookie-load): Ditto.
	(w3m-cookie-setup): Ditto.
	(w3m-cookie-shutdown): Rewrite.
	(w3m-cookie-set): Call w3m-cookie-setup; Changed API.
	(w3m-cookie-get): Call w3m-cookie-setup.

	* w3m.el (w3m-goto-url): Don't resume form from history when POST.

2002-03-24  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-cookie.el: New file.

	* w3m-form.el (w3m-form-resume): Use cdr of forms if car is t
	(Just in case).
	(w3m-form-parse-and-fontify)[w3m]: Search form structure according to
	fid.

	* w3m.el (toplevel): Added autoload setting for w3m-cookie.
	(w3m-use-cookies): New user option.
	(w3m-cookie-accept-domains): Ditto.
	(w3m-cookie-reject-domains): Ditto.
	(toplevel): Bind system-time-locale as "C" while calling
	format-time-string.
	(w3m-w3m-attributes): Call w3m-cookie-set; When 30x response is
	received, set w3m-current-refresh as
	(0 . Location).
	(w3m-cookie-command-arguments): New function.
	(w3m-w3m-retrieve): Use it.
	(w3m-retrieve-and-render): Mark w3m-current-forms as `not history' if
	retrieval failed.
	(w3m-prepare-content): If w3m-current-refresh rate is 0, do nothing.
	(w3m-quit): Call `w3m-cookie-shutdown'.

2002-03-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-decode-encoded-contents): Convert encoding to lower case
	before checking alist.

2002-03-24  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* w3m.el (w3m-remove-redundant-spaces): New implementation.
	(w3m-about-retrieve): Call `insert-buffer-substring' instead of
	`insert-buffer'.
	(w3m-rendering-unibyte-buffer): Ditto.
	(w3m-rendering-multibyte-buffer): Ditto.
	(w3m-prepare-text-content): Ditto.

2002-03-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-w3m-attributes): Ignore trailing whitespaces in header
	lines.

2002-03-20  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-view-this-url): Eval action even when anchor is set.

	* w3m-form.el (w3m-form-parse-and-fontify): Clear mapval if it is set.

	* w3m.el (w3m-halfdump-command-arguments)[w3mmee]: Add `image' to the
	-dump argument only if `w3m-treat-image-size' is non-nil.

2002-03-20  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-form.el (w3m-form-parse-and-fontify): If not detect `usemap'
	attribute of `img_alt', use `value' attribute of `input_alt' for the
	select map name; W3M removes `usemap' attribute when
	"display_image=off".

2002-03-19  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-w3m-attributes): Ignore `w3m-document-charset' when
	w3m-m17n.

2002-03-19  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-fontify-images): Parse width and height attributes of
	img_alt.
	(w3m-toggle-inline-images-internal): Set `size' argument of
	w3m-create-image.
	(w3m-highlight-current-anchor): Fixed logic.

	* w3m-xmas.el (w3m-create-image): Added optional argument `size'
	(ignored currently).

	* w3m-e21.el (w3m-imagick-convert-program): Use w3m-which to set
	initial value.
	(w3m-resize-images): New user option.
	(w3m-resize-image): New function.
	(w3m-create-image): Added optional argument `size'; Changed return
	value.
	(w3m-insert-image): Call w3m-resize-image if size is specified.
	(w3m-imagick-convert-buffer): Accept nil for from-type and to-type.

2002-03-18  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-mee-select-value): Fix.
	(w3m-form-parse-and-fontify): If w3m-type is not w3mmee, use last form
	object as current form.

2002-03-18  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (w3m-highlight-current-anchor): New implementation.
	(w3m-highlight-current-anchor-1): New function.

	* w3m-form.el (w3m-form-replace): Fixed problem when string is nil.

2002-03-16  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-string-to-char-list): Fixed.

2002-03-15  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m-form.el (w3m-form-mee-select-value): Use w3m-output-coding-system
	instead of w3m-current-coding-system.
	(w3m-form-parse-and-fontify)[w3mmee]: Ditto.
	(w3m-form-mee-select-value): Fixed select value.
	(w3m-form-resume): Fixed checkbox resuming.
	(w3m-form-parse-and-fontify): Use `form' instead of `(car forms)';
	Search the form which corresponds to input_alt by fid; Use `nconc'
	instead of `push'.

	* w3m-form.el (w3m-form-mee-select-value): New function.
	(w3m-form-parse-and-fontify)[w3mmee]: Set select value.

	* w3m.el (w3m-halfdump-command-arguments)[w3mmee]: Added image.

	* w3m-form.el (w3m-form-parse-and-fontify): Set the value of form only
	if the method is not internal; Add internal form to the
	w3m-current-forms; Treat input type `image' as same as `submit'.
	(w3m-form-mee-attr-unquote): New function.
	(w3m-string-to-char-list): New function/alias.
	(w3m-form-mee-new): New function.
	(w3m-form-parse-and-fontify): Parse w3mmee's form info.
	(w3m-form-input-textarea-keymap): Bind C-g.
	(w3m-form-input-select-keymap): Bind C-g, h,j,k,l.
	(w3m-form-input-map-keymap): Ditto.
	(w3m-form-parse-and-fontify): Set textarea value.

2002-03-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-form.el (w3m-form-resume): Typo.

2002-03-13  Yuuichi Teranishi  <teranisi@gohome.org>

	* w3m.el (toplevel): Removed autoload setting for
	`w3m-form-parse-buffer'.
	(w3m-clear-local-variables): Don't treat w3m-current-forms any more.
	(w3m-copy-local-variables): Ditto.
	(w3m-additional-command-arguments): Fixed problem when no-proxy host
	has port number other than 80.
	(w3m-rendering-buffer-1): Don't call w3m-form-parse-buffer.
	(w3m-goto-url): Setup w3m-current-forms from history structure.

	* w3m-form.el (w3m-form-parse-buffer): Abolish.
	(w3m-form-parse-forms): Ditto.
	(w3m-form-resume): Set value of `w3m-current-forms'.
	(w3m-fontify-forms): Call `w3m-form-parse-and-fontify' instead of
	`w3m-form-fontify'.
	(w3m-form-parse-and-fontify): New function.
	(w3m-form-input-select): Fix problem when candidate label is "".

2002-03-13  Katsumi Yamaoka  <yamaoka@jpl.org>
	Suggested by HAYASHI Chifumi <chifumi@mscom.or.jp>.

	* w3m-form.el (w3m-form-new): Ignore the 2nd arg `action' if it is nil.
	(w3m-form-parse-forms): Don't parse the value of `w3m-current-url' if
	it is nil.


2002-03-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.2.6 from emacs-w3m-1_2 branch.

2002-03-11  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m-ucs.el (w3m-euc-japan-encoder): Treat japanese-jisx0208-1978 as
	japanese-jisx0208.

2002-03-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-view-this-url, w3m-goto-url-new-session,
	w3m-select-buffer-copy-buffer): Remove unused non-global variables.

2002-03-11  Katsumi Yamaoka  <yamaoka@jpl.org>
	Suggested by Yuuichi Teranishi <teranisi@gohome.org> with mod.

	* w3m.el (w3m-no-proxy-domains): New user option renamed from
	`w3m-no-proxy-hosts' and changed the meaning.
	(w3m-additional-command-arguments): Refer to it.

2002-03-10  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (tarball): Fix permissions.

2002-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-command-arguments-alist): Change the meaning that the car
	of each element will be compared with a url instead of a hostname.
	(w3m-no-proxy-hosts): New user option.
	(w3m-additional-command-arguments): Look into it.

2002-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m.el (w3m-command-arguments-alist): New user option.
	(w3m-additional-command-arguments): New function.
	(w3m-w3m-retrieve): Use it.
	(w3m-history-current-url-face, w3m-copy-buffer, w3m-about-header):
	Remove unused non-global variables.

2002-03-08  ARISAWA Akihiro  <ari@mbf.sphere.ne.jp>

	* w3m.el (w3m-w3m-attributes) [w3mmee]: Fetch content-encoding from
	"x-w3m-content-encoding" filed.

2002-03-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* mew-w3m.el (mew-w3m-cid-retrieve): Return lowercase string always
	because `w3m-image-type-alist' has lowercase keys.

2002-03-07  Yoichi NAKAYAMA  <yoichi@eken.phys.nagoya-u.ac.jp>

	* w3m.el (w3m-lynx-like-map): Switch J and K so as to behave like w3m.

2002-03-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* aclocal.m4 (AC_EXAMINE_PACKAGEDIR): Use `(eq 0 foo)' instead of
	`(zerop foo)' because foo might not be a number.
	(AC_PATH_ICONDIR): Ditto.

2002-03-07  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-decoder-alist): Change default commands to `gzip' and
	`bzip2' instead of `gunzip' and `bunzip2' because some broken OS and
	its environment does not work them.

2002-03-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (datadir): New variable.

2002-03-06  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m-proc.el (w3m-process-filter): Modify a regexp for "Password:".

2002-03-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install): Don't chdir to shimbun/ while installing
	shimbun modules.
	(install-icons): Don't chdir to icons/ while installing icons.

2002-03-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* Makefile.in (install): Install all ChangeLog files.
	* w3mhack.el (w3mhack-make-package): List all ChangeLog files in the
	manifest.

2002-03-05  Hideyuki SHIRAI  <shirai@meadowy.org>

	* w3m.el (w3m-local-dirlist-cgi): Set `w3m-current-url' for avoid error
	in `w3m-process-start-process()'.
	(w3m-goto-url): When use w3m-dtree and the URL is local directory,
	change the URL to `about://dtree' securely.

2002-03-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* w3m-util.el (w3m-function-max-args): Alias to `function-max-args'
	under XEmacs, otherwise define it as a function.
	(symbol-for-testing-whether-colon-keyword-is-available-or-not): Use
	`dont-compile' instead of `eval'.


2002-03-02  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Release emacs-w3m-1.2.5 from emacs-w3m-1_2 branch.

2002-03-01  Yuuichi Teranishi  <teranisi@gohome.org>

	* octet.el (octet-find-file): Decode even in the read-only buffer.

2002-02-26  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* Makefile.in (DOCS): Add ChangeLog.1.


Local Variables:
coding: iso-2022-7bit
fill-column: 79
indent-tabs-mode: t
End:
